/*


MochiKit.Base 1.5

See <http://mochikit.com/> for documentation, downloads, license, etc.

(c) 2005 Bob Ippolito.  All rights Reserved.

*/
if("undefined"!=typeof goog&&"function"==typeof goog.provide)var MochiKit={};"undefined"==typeof MochiKit&&(MochiKit={});"undefined"==typeof MochiKit.__export__&&(MochiKit.__export__=!0);MochiKit.NAME="MochiKit";MochiKit.VERSION="1.5";MochiKit.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};MochiKit.toString=function(){return this.__repr__()};MochiKit.Base=MochiKit.Base||{};
MochiKit.Base.module=function(a,b,c,d){var e=a[b]=a[b]||{},f=a.NAME?a.NAME+".":"";e.NAME=f+b;e.VERSION=c;e.__repr__=function(){return"["+this.NAME+" "+this.VERSION+"]"};e.toString=function(){return this.__repr__()};for(b=0;null!=d&&b<d.length;b++)if(!(d[b]in a))throw e.NAME+" depends on "+f+d[b]+"!";return e};MochiKit.Base.module(MochiKit,"Base","1.5",[]);
MochiKit.Base.update=function(a,b,c){if(null===a||void 0===a)a={};for(var d=1;d<arguments.length;d++){var e=arguments[d];if("undefined"!=typeof e&&null!==e)for(var f in e)a[f]=e[f]}return a};
MochiKit.Base.update(MochiKit.Base,{camelize:function(a){a=a.split("-");for(var b=a[0],c=1;c<a.length;c++)b+=a[c].charAt(0).toUpperCase()+a[c].substring(1);return b},counter:function(a,b){0===arguments.length&&(a=1);2>arguments.length&&(b=1);return function(){var c=a;a+=b;return c}},clone:function(a){var b=arguments.callee;if(1==arguments.length)return b.prototype=a,new b},_flattenArray:function(a,b){for(var c=0;c<b.length;c++){var d=b[c];d instanceof Array?arguments.callee(a,d):a.push(d)}return a},
flattenArray:function(a){return MochiKit.Base._flattenArray([],a)},flattenArguments:function(a,b){for(var c=[],d=MochiKit.Base.extend(null,arguments);d.length;){var e=d.shift();if(e&&"object"==typeof e&&"number"==typeof e.length)for(var f=e.length-1;0<=f;f--)d.unshift(e[f]);else c.push(e)}return c},extend:function(a,b,c){c||(c=0);if(b){var d=b.length;if("number"!=typeof d)if("undefined"!=typeof MochiKit.Iter)b=MochiKit.Iter.list(b),d=b.length;else throw new TypeError("Argument not an array-like and MochiKit.Iter not present");
for(a||(a=[]);c<d;c++)a.push(b[c])}return a},updatetree:function(a,b){if(null===a||void 0===a)a={};for(var c=1;c<arguments.length;c++){var d=arguments[c];if("undefined"!=typeof d&&null!==d)for(var e in d){var f=d[e];"object"!=typeof a[e]||"object"!=typeof f||MochiKit.Base.isDateLike(f)||f instanceof Array?a[e]=f:arguments.callee(a[e],f)}}return a},setdefault:function(a,b,c){if(null===a||void 0===a)a={};for(var d=1;d<arguments.length;d++){var e=arguments[d],f;for(f in e)f in a||(a[f]=e[f])}return a},
keys:function(a){var b=[],c;for(c in a)b.push(c);return b},values:function(a){var b=[],c;for(c in a)b.push(a[c]);return b},items:function(a){var b=[],c;for(c in a){var d;try{d=a[c]}catch(e){continue}b.push([c,d])}return b},_newNamedError:function(a,b,c){c.prototype=new MochiKit.Base.NamedError(a.NAME+"."+b);c.prototype.constructor=c;a[b]=c},operator:{NAME:"operator",truth:function(a){return!!a},lognot:function(a){return!a},identity:function(a){return a},not:function(a){return~a},neg:function(a){return-a},
add:function(a,b){return a+b},sub:function(a,b){return a-b},div:function(a,b){return a/b},floordiv:function(a,b){return Math.floor(a/b)},mod:function(a,b){return a%b},mul:function(a,b){return a*b},pow:function(a,b){return Math.pow(a,b)},divmod:function(a,b){return[a/b,a%b]},max:function(a,b){return Math.max(a,b)},min:function(a,b){return Math.min(a,b)},and:function(a,b){return a&b},or:function(a,b){return a|b},xor:function(a,b){return a^b},lshift:function(a,b){return a<<b},rshift:function(a,b){return a>>
b},zrshift:function(a,b){return a>>>b},getitem:function(a,b){return a[b]},eq:function(a,b){return a==b},ne:function(a,b){return a!=b},gt:function(a,b){return a>b},ge:function(a,b){return a>=b},lt:function(a,b){return a<b},le:function(a,b){return a<=b},seq:function(a,b){return a===b},sne:function(a,b){return a!==b},ceq:function(a,b){return 0===MochiKit.Base.compare(a,b)},cne:function(a,b){return 0!==MochiKit.Base.compare(a,b)},cgt:function(a,b){return 1==MochiKit.Base.compare(a,b)},cge:function(a,
b){return-1!=MochiKit.Base.compare(a,b)},clt:function(a,b){return-1==MochiKit.Base.compare(a,b)},cle:function(a,b){return 1!=MochiKit.Base.compare(a,b)},logand:function(a,b){return a&&b},logor:function(a,b){return a||b},contains:function(a,b){return b in a},concat:function(a,b){return MochiKit.Base.concat(a,b)},iconcat:function(a,b){return a.concat(b)},setitem:function(a,b,c){return a[b]=c},delitem:function(a,b){delete a[b]},call:function(a,b){return a.apply(this,MochiKit.Base.extend([],arguments,
1))}},forwardCall:function(a){return function(){return this[a].apply(this,arguments)}},itemgetter:function(a){return function(b){return b[a]}},bool:function(a){return"boolean"===typeof a||a instanceof Boolean?a.valueOf():"string"===typeof a||a instanceof String?0<a.length&&"false"!=a&&"null"!=a&&"undefined"!=a&&"0"!=a:"number"===typeof a||a instanceof Number?!isNaN(a)&&0!=a:null!=a&&"number"===typeof a.length?0!==a.length:null!=a},typeMatcher:function(){for(var a={},b=0;b<arguments.length;b++){var c=
arguments[b];a[c]=c}return function(){for(var b=0;b<arguments.length;b++)if(!(typeof arguments[b]in a))return!1;return!0}},isNull:function(a,b){for(var c=0;c<arguments.length;c++)if(null!==arguments[c])return!1;return!0},isUndefinedOrNull:function(a,b){for(var c=0;c<arguments.length;c++){var d=arguments[c];if("undefined"!=typeof d&&null!==d)return!1}return!0},isEmpty:function(a,b){return!MochiKit.Base.isNotEmpty.apply(this,arguments)},isNotEmpty:function(a,b){for(var c=0;c<arguments.length;c++){var d=
arguments[c];if(!d||!d.length)return!1}return!0},isArrayLike:function(a,b){for(var c=0;c<arguments.length;c++){var d=arguments[c],e=typeof d;if("object"!=e&&("function"!=e||"function"!=typeof d.item)||null===d||"number"!=typeof d.length||3===d.nodeType||4===d.nodeType)return!1}return!0},isDateLike:function(a,b){for(var c=0;c<arguments.length;c++){var d=arguments[c];if("object"!=typeof d||null===d||"function"!=typeof d.getTime)return!1}return!0},xmap:function(a,b,c){if(null===a)return MochiKit.Base.extend(null,
arguments,1);for(var d=[],e=1;e<arguments.length;e++)d.push(a(arguments[e]));return d},map:function(a,b){var c=MochiKit.Base,d=MochiKit.Iter,e=c.isArrayLike;if(2>=arguments.length){if(!e(b))if(d){if(b=d.list(b),null===a)return b}else throw new TypeError("Argument not an array-like and MochiKit.Iter not present");if(null===a)return c.extend(null,b);d=[];for(c=0;c<b.length;c++)d.push(a(b[c]))}else{null===a&&(a=Array);for(var f=null,c=1;c<arguments.length;c++){if(!e(arguments[c])){if(d)return d.list(d.imap.apply(null,
arguments));throw new TypeError("Argument not an array-like and MochiKit.Iter not present");}var g=arguments[c].length;if(null===f||f>g)f=g}d=[];for(c=0;c<f;c++){e=[];for(g=1;g<arguments.length;g++)e.push(arguments[g][c]);d.push(a.apply(this,e))}}return d},xfilter:function(a,b,c){var d=[];null===a&&(a=MochiKit.Base.operator.truth);for(var e=1;e<arguments.length;e++){var f=arguments[e];a(f)&&d.push(f)}return d},filter:function(a,b,c){var d=[],e=MochiKit.Base;if(!e.isArrayLike(b))if(MochiKit.Iter)b=
MochiKit.Iter.list(b);else throw new TypeError("Argument not an array-like and MochiKit.Iter not present");null===a&&(a=e.operator.truth);if("function"==typeof Array.prototype.filter)return Array.prototype.filter.call(b,a,c);if("undefined"==typeof c||null===c)for(e=0;e<b.length;e++){var f=b[e];a(f)&&d.push(f)}else for(e=0;e<b.length;e++)f=b[e],a.call(c,f)&&d.push(f);return d},_wrapDumbFunction:function(a){return function(){switch(arguments.length){case 0:return a();case 1:return a(arguments[0]);case 2:return a(arguments[0],
arguments[1]);case 3:return a(arguments[0],arguments[1],arguments[2])}for(var b=[],c=0;c<arguments.length;c++)b.push("arguments["+c+"]");return eval("(func("+b.join(",")+"))")}},methodcaller:function(a,b){var c=MochiKit.Base.extend(null,arguments,1);return"function"==typeof a?function(b){return a.apply(b,c)}:function(b){return b[a].apply(b,c)}},method:function(a,b){var c=MochiKit.Base;return c.bind.apply(this,c.extend([b,a],arguments,2))},compose:function(a,b,c){var d=[],e=MochiKit.Base;if(0===arguments.length)throw new TypeError("compose() requires at least one argument");
for(var f=0;f<arguments.length;f++){var g=arguments[f];if("function"!=typeof g)throw new TypeError(e.repr(g)+" is not a function");d.push(g)}return function(){for(var a=arguments,b=d.length-1;0<=b;b--)a=[d[b].apply(this,a)];return a[0]}},bind:function(a,b,c){"string"==typeof a&&(a=b[a]);var d=a.im_func,e=a.im_preargs,f=a.im_self,g=MochiKit.Base;"function"==typeof a&&"undefined"==typeof a.apply&&(a=g._wrapDumbFunction(a));"function"!=typeof d&&(d=a);"undefined"!=typeof b&&(f=b);e="undefined"==typeof e?
[]:e.slice();g.extend(e,arguments,2);var h=function(){var a=arguments,b=arguments.callee;0<b.im_preargs.length&&(a=g.concat(b.im_preargs,a));var c=b.im_self;c||(c=this);return b.im_func.apply(c,a)};h.im_self=f;h.im_func=d;h.im_preargs=e;"string"==typeof d.NAME&&(h.NAME="bind("+d.NAME+",...)");return h},bindLate:function(a,b){var c=MochiKit.Base,d=arguments;"string"===typeof a&&(d=c.extend([c.forwardCall(a)],arguments,1));return c.bind.apply(this,d)},bindMethods:function(a){var b=MochiKit.Base.bind,
c;for(c in a){var d=a[c];"function"==typeof d&&(a[c]=b(d,a))}return a},registerComparator:function(a,b,c,d){MochiKit.Base.comparatorRegistry.register(a,b,c,d)},_primitives:{"boolean":!0,string:!0,number:!0},compare:function(a,b){if(a==b)return 0;var c="undefined"==typeof a||null===a,d="undefined"==typeof b||null===b;if(c&&d)return 0;if(c)return-1;if(d)return 1;c=MochiKit.Base;d=c._primitives;if(!(typeof a in d&&typeof b in d))try{return c.comparatorRegistry.match(a,b)}catch(e){if(e!=c.NotFound)throw e;
}if(a<b)return-1;if(a>b)return 1;c=c.repr;throw new TypeError(c(a)+" and "+c(b)+" can not be compared");},compareDateLike:function(a,b){return MochiKit.Base.compare(a.getTime(),b.getTime())},compareArrayLike:function(a,b){var c=MochiKit.Base.compare,d=a.length,e=0;d>b.length?(e=1,d=b.length):d<b.length&&(e=-1);for(var f=0;f<d;f++){var g=c(a[f],b[f]);if(g)return g}return e},registerRepr:function(a,b,c,d){MochiKit.Base.reprRegistry.register(a,b,c,d)},repr:function(a){if("undefined"==typeof a)return"undefined";
if(null===a)return"null";try{return"function"==typeof a.__repr__?a.__repr__():"function"==typeof a.repr&&a.repr!=arguments.callee?a.repr():MochiKit.Base.reprRegistry.match(a)}catch(b){try{if("string"==typeof a.NAME&&(a.toString==Function.prototype.toString||a.toString==Object.prototype.toString))return a.NAME}catch(c){}}var d=a+"";if("function"==typeof a){var d=d.replace(/^\s+/,"").replace(/\s+/g," "),d=d.replace(/,(\S)/,", $1"),e=d.indexOf("{");-1!=e&&(d=d.substr(0,e)+"{...}")}return d},reprArrayLike:function(a){var b=
MochiKit.Base;return"["+b.map(b.repr,a).join(", ")+"]"},reprString:function(a){return('"'+a.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\v]/g,"\\v").replace(/[\r]/g,"\\r")},reprNumber:function(a){return a+""},registerJSON:function(a,b,c,d){MochiKit.Base.jsonRegistry.register(a,b,c,d)},evalJSON:function(a){return eval("("+MochiKit.Base._filterJSON(a)+")")},_filterJSON:function(a){var b=a.match(/^\s*\/\*(.*)\*\/\s*$/);
return b?b[1]:a},serializeJSON:function(a){var b=typeof a;if("number"==b||"boolean"==b)return a+"";if(null===a)return"null";if("string"==b){for(var b="",c=0;c<a.length;c++){var d=a.charAt(c);'"'==d?b+='\\"':"\\"==d?b+="\\\\":"\b"==d?b+="\\b":"\f"==d?b+="\\f":"\n"==d?b+="\\n":"\r"==d?b+="\\r":"\t"==d?b+="\\t":31>=a.charCodeAt(c)?(d=a.charCodeAt(c).toString(16),2>d.length&&(d="0"+d),b+="\\u00"+d.toUpperCase()):b+=d}return'"'+b+'"'}var d=arguments.callee,e;if("function"==typeof a.toJSON&&(e=a.toJSON(),
a!==e)||"function"==typeof a.__json__&&(e=a.__json__(),a!==e)||"function"==typeof a.json&&(e=a.json(),a!==e))return d(e);if("function"!=b&&"number"==typeof a.length){b=[];for(c=0;c<a.length;c++)e=d(a[c]),"string"==typeof e&&b.push(e);return"["+b.join(", ")+"]"}var f=MochiKit.Base;try{if(e=f.jsonRegistry.match(a),a!==e)return d(e)}catch(g){if(g!=f.NotFound)throw g;}if("undefined"==b)throw new TypeError("undefined can not be serialized as JSON");if("function"==b)return null;b=[];for(c in a)if(a.hasOwnProperty(c)){if("number"==
typeof c)f='"'+c+'"';else if("string"==typeof c)f=d(c);else continue;e=d(a[c]);"string"==typeof e&&b.push(f+":"+e)}return"{"+b.join(", ")+"}"},objEqual:function(a,b){return 0===MochiKit.Base.compare(a,b)},arrayEqual:function(a,b){return a.length!=b.length?!1:0===MochiKit.Base.compare(a,b)},concat:function(a,b){for(var c=[],d=MochiKit.Base.extend,e=0;e<arguments.length;e++)d(c,arguments[e]);return c},keyComparator:function(a){var b=MochiKit.Base,c=b.compare;if(1==arguments.length)return function(b,
d){return c(b[a],d[a])};var d=b.extend(null,arguments);return function(a,b){for(var g=0,h=0;0===g&&h<d.length;h++)g=d[h],g=c(a[g],b[g]);return g}},reverseKeyComparator:function(a){var b=MochiKit.Base.keyComparator.apply(this,arguments);return function(a,d){return b(d,a)}},partial:function(a,b){var c=MochiKit.Base;return c.bind.apply(this,c.extend([a,void 0],arguments,1))},listMinMax:function(a,b){if(0===b.length)return null;for(var c=b[0],d=MochiKit.Base.compare,e=1;e<b.length;e++){var f=b[e];d(f,
c)==a&&(c=f)}return c},objMax:function(){return MochiKit.Base.listMinMax(1,arguments)},objMin:function(){return MochiKit.Base.listMinMax(-1,arguments)},findIdentical:function(a,b,c,d){if("undefined"==typeof d||null===d)d=a.length;if("undefined"==typeof c||null===c)c=0;for(;c<d;c++)if(a[c]===b)return c;return-1},mean:function(a,b){for(var c=0,d=MochiKit.Base.extend(null,arguments),e=d.length;d.length;){var f=d.shift();if(f&&"object"==typeof f&&"number"==typeof f.length)for(var e=e+(f.length-1),g=f.length-
1;0<=g;g--)c+=f[g];else c+=f}if(0>=e)throw new TypeError("mean() requires at least one argument");return c/e},median:function(a,b){var c=MochiKit.Base.flattenArguments(arguments);if(0===c.length)throw new TypeError("median() requires at least one argument");c.sort(MochiKit.Base.compare);if(0==c.length%2){var d=c.length/2;return(c[d]+c[d-1])/2}return c[(c.length-1)/2]},findValue:function(a,b,c,d){if("undefined"==typeof d||null===d)d=a.length;if("undefined"==typeof c||null===c)c=0;for(var e=MochiKit.Base.compare;c<
d;c++)if(0===e(a[c],b))return c;return-1},nodeWalk:function(a,b){for(var c=[a],d=MochiKit.Base.extend;c.length;){var e=b(c.shift());e&&d(c,e)}},nameFunctions:function(a){var b=a.NAME,b="undefined"==typeof b?"":b+".",c;for(c in a){var d=a[c];if("function"==typeof d&&"undefined"==typeof d.NAME)try{d.NAME=b+c}catch(e){}}},queryString:function(a,b){if("undefined"!=typeof MochiKit.DOM&&1==arguments.length&&("string"==typeof a||"undefined"!=typeof a.nodeType&&0<a.nodeType)){var c=MochiKit.DOM.formContents(a);
a=c[0];b=c[1]}else if(1==arguments.length){if("number"==typeof a.length&&2==a.length)return arguments.callee(a[0],a[1]);var d=a;a=[];b=[];for(var e in d)if(c=d[e],"function"!=typeof c)if(MochiKit.Base.isArrayLike(c))for(var f=0;f<c.length;f++)a.push(e),b.push(c[f]);else a.push(e),b.push(c)}d=[];e=Math.min(a.length,b.length);for(var g=MochiKit.Base.urlEncode,f=0;f<e;f++)c=b[f],"undefined"!=typeof c&&null!==c&&(MochiKit.Base.isDateLike(c)&&(c=MochiKit.DateTime.toISOTimestamp(c,!0)),d.push(g(a[f])+"="+
g(c)));return d.join("&")},parseQueryString:function(a,b){var c=("?"==a.charAt(0)?a.substring(1):a).replace(/\+/g,"%20").split(/\&amp\;|\&\#38\;|\&#x26;|\&/),d={},e;e="undefined"!=typeof decodeURIComponent?decodeURIComponent:unescape;if(b)for(var f=0;f<c.length;f++){var g=c[f].split("="),h=e(g.shift());if(h){var k=d[h];k instanceof Array||(k=[],d[h]=k);k.push(e(g.join("=")))}}else for(f=0;f<c.length;f++)g=c[f].split("="),(h=g.shift())&&(d[e(h)]=e(g.join("=")));return d}});
MochiKit.Base.AdapterRegistry=function(){this.pairs=[]};MochiKit.Base.AdapterRegistry.prototype={register:function(a,b,c,d){d?this.pairs.unshift([a,b,c]):this.pairs.push([a,b,c])},match:function(){for(var a=0;a<this.pairs.length;a++){var b=this.pairs[a];if(b[1].apply(this,arguments))return b[2].apply(this,arguments)}throw MochiKit.Base.NotFound;},unregister:function(a){for(var b=0;b<this.pairs.length;b++)if(this.pairs[b][0]==a)return this.pairs.splice(b,1),!0;return!1}};
MochiKit.Base.moduleExport=function(a,b){for(var c={toString:!0,NAME:!0,VERSION:!0},d=MochiKit.Base.extend([],arguments,1);null!=(b=d.shift());)for(var e in b){var f=b[e];if(null!=f){var g="_"!==e[0]&&!c[e];if("boolean"==typeof f.__export__?f.__export__:g)"object"==typeof f&&f.NAME&&f.VERSION?d.push(f):a[e]=b[e]}}return a};MochiKit.Base._exportSymbols=function(a,b){!1!==MochiKit.__export__&&!1!==b.__export__&&MochiKit.Base.moduleExport(a,b)};
MochiKit.Base._deprecated=function(a,b,c,d,e){"string"===typeof a&&(0===a.indexOf("MochiKit.")&&(a=a.substring(9)),a=MochiKit[a]);var f=c.split(".")[1],g=c.split(".")[2],h=function(){var e=arguments.callee,h=a.NAME+"."+b+" is deprecated since version "+d+". Use "+c+" instead.";!0!==e.logged&&(e.logged=!0,MochiKit.Logging?MochiKit.Logging.logDebug(h):console&&console.log&&console.log(h));if(!MochiKit[f])throw Error(h);return MochiKit[f][g].apply(this,arguments)};h.__export__=!0===e;a[b]=h};
MochiKit.Base._getBaseFn=function(a){return"function"==typeof a.im_func?MochiKit.Base._getBaseFn(a.im_func):a};
MochiKit.Base.__new__=function(){var a=this;a.noop=function(){};a._deprecated(a,"forward","MochiKit.Base.forwardCall","1.3");a._deprecated(a,"find","MochiKit.Base.findValue","1.3");a.urlEncode="undefined"!=typeof encodeURIComponent?function(a){return encodeURIComponent(a).replace(/\'/g,"%27")}:function(a){return escape(a).replace(/\+/g,"%2B").replace(/\"/g,"%22").replace(/\'/g,"%27")};a.NamedError=function(a){this.name=this.message=a};a.NamedError.prototype=Error();a.NamedError.prototype.constructor=
a.NamedError;a.NamedError.prototype.repr=function(){return this.message&&this.message!=this.name?this.name+"("+a.repr(this.message)+")":this.name+"()"};a.NamedError.prototype.toString=a.forwardCall("repr");a.NotFound=new a.NamedError("MochiKit.Base.NotFound");a.listMax=a.partial(a.listMinMax,1);a.listMin=a.partial(a.listMinMax,-1);a.isCallable=a.typeMatcher("function");a.isUndefined=a.typeMatcher("undefined");a.isValue=a.typeMatcher("boolean","number","string");a.merge=a.partial(a.update,null);a.zip=
a.partial(a.map,null);a.average=a.mean;a.comparatorRegistry=new a.AdapterRegistry;a.registerComparator("dateLike",a.isDateLike,a.compareDateLike);a.registerComparator("arrayLike",a.isArrayLike,a.compareArrayLike);a.reprRegistry=new a.AdapterRegistry;a.registerRepr("arrayLike",a.isArrayLike,a.reprArrayLike);a.registerRepr("string",a.typeMatcher("string"),a.reprString);a.registerRepr("numbers",a.typeMatcher("number","boolean"),a.reprNumber);a.jsonRegistry=new a.AdapterRegistry;a.nameFunctions(this);
a.nameFunctions(this.operator)};MochiKit.Base.__new__();MochiKit.__export__&&(window.compare=MochiKit.Base.compare,window.compose=MochiKit.Base.compose,window.serializeJSON=MochiKit.Base.serializeJSON,window.mean=MochiKit.Base.mean,window.median=MochiKit.Base.median);MochiKit.Base._exportSymbols(this,MochiKit.Base);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Iter={});MochiKit.Base.module(MochiKit,"Iter","1.5",["Base"]);MochiKit.Iter.registerIteratorFactory=function(a,b,c,d){MochiKit.Iter.iteratorRegistry.register(a,b,c,d)};MochiKit.Iter.isIterable=function(a){return null!=a&&("function"==typeof a.next||"function"==typeof a.iter)};
MochiKit.Iter.iter=function(a,b){var c=MochiKit.Iter;if(2==arguments.length)return c.takewhile(function(a){return a!=b},a);if("function"==typeof a.next)return a;if("function"==typeof a.iter)return a.iter();if("function"==typeof a.__iterator__)return a.__iterator__(!1);try{return c.iteratorRegistry.match(a)}catch(d){throw c=MochiKit.Base,d==c.NotFound&&(d=new TypeError(typeof a+": "+c.repr(a)+" is not iterable")),d;}};
MochiKit.Iter.count=function(a,b){a||(a=0);2>arguments.length&&(b=1);var c=MochiKit.Base;return{repr:function(){return"count("+a+")"},toString:c.forwardCall("repr"),next:c.counter(a,b)}};
MochiKit.Iter.cycle=function(a){var b=MochiKit.Iter,c=MochiKit.Base,d=[],e=b.iter(a);return{repr:function(){return"cycle(...)"},toString:c.forwardCall("repr"),next:function(){try{var a=e.next();d.push(a);return a}catch(c){if(c!=b.StopIteration)throw c;if(0===d.length)this.next=function(){throw b.StopIteration;};else{var h=-1;this.next=function(){h=(h+1)%d.length;return d[h]}}return this.next()}}}};
MochiKit.Iter.repeat=function(a,b){var c=MochiKit.Base;return"undefined"==typeof b?{repr:function(){return"repeat("+c.repr(a)+")"},toString:c.forwardCall("repr"),next:function(){return a}}:{repr:function(){return"repeat("+c.repr(a)+", "+b+")"},toString:c.forwardCall("repr"),next:function(){if(0>=b)throw MochiKit.Iter.StopIteration;b-=1;return a}}};MochiKit.Iter.next=function(a,b){if(2==arguments.length)try{return a.next()}catch(c){if(c!=MochiKit.Iter.StopIteration)throw c;return b}return a.next()};
MochiKit.Iter.izip=function(a,b){var c=MochiKit.Base,d=MochiKit.Iter,e=d.next,f=c.map(d.iter,arguments);return{repr:function(){return"izip(...)"},toString:c.forwardCall("repr"),next:function(){return c.map(e,f)}}};MochiKit.Iter.ifilter=function(a,b){var c=MochiKit.Base;b=MochiKit.Iter.iter(b);null===a&&(a=c.operator.truth);return{repr:function(){return"ifilter(...)"},toString:c.forwardCall("repr"),next:function(){for(;;){var c=b.next();if(a(c))return c}}}};
MochiKit.Iter.ifilterfalse=function(a,b){var c=MochiKit.Base;b=MochiKit.Iter.iter(b);null===a&&(a=c.operator.truth);return{repr:function(){return"ifilterfalse(...)"},toString:c.forwardCall("repr"),next:function(){for(;;){var c=b.next();if(!a(c))return c}}}};
MochiKit.Iter.islice=function(a){var b=MochiKit.Iter,c=MochiKit.Base;a=b.iter(a);var d=0,e=0,f=1,g=-1;2==arguments.length?e=arguments[1]:3==arguments.length?(d=arguments[1],e=arguments[2]):(d=arguments[1],e=arguments[2],f=arguments[3]);return{repr:function(){return"islice("+["...",d,e,f].join(", ")+")"},toString:c.forwardCall("repr"),next:function(){if(d>=e)throw b.StopIteration;for(var c;g<d;)c=a.next(),g++;d+=f;return c}}};
MochiKit.Iter.imap=function(a,b,c){var d=MochiKit.Base,e=MochiKit.Iter,f=d.map(e.iter,d.extend(null,arguments,1)),g=d.map,h=e.next;return{repr:function(){return"imap(...)"},toString:d.forwardCall("repr"),next:function(){return a.apply(this,g(h,f))}}};MochiKit.Iter.applymap=function(a,b,c){b=MochiKit.Iter.iter(b);return{repr:function(){return"applymap(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){return a.apply(c,b.next())}}};
MochiKit.Iter.chain=function(a,b){var c=MochiKit.Iter,d=MochiKit.Base;if(1==arguments.length)return c.iter(arguments[0]);var e=d.map(c.iter,arguments);return{repr:function(){return"chain(...)"},toString:d.forwardCall("repr"),next:function(){for(;1<e.length;)try{return e[0].next()}catch(a){if(a!=c.StopIteration)throw a;e.shift()}if(1==e.length){var b=e.shift();this.next=d.bind("next",b);return this.next()}throw c.StopIteration;}}};
MochiKit.Iter.takewhile=function(a,b){var c=MochiKit.Iter;b=c.iter(b);return{repr:function(){return"takewhile(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var d=b.next();a(d)||(this.next=function(){throw c.StopIteration;},this.next());return d}}};
MochiKit.Iter.dropwhile=function(a,b){b=MochiKit.Iter.iter(b);var c=MochiKit.Base,d=c.bind;return{repr:function(){return"dropwhile(...)"},toString:c.forwardCall("repr"),next:function(){for(;;){var c=b.next();if(!a(c))break}this.next=d("next",b);return c}}};
MochiKit.Iter._tee=function(a,b,c){b.pos[a]=-1;var d=MochiKit.Base,e=d.listMin;return{repr:function(){return"tee("+a+", ...)"},toString:d.forwardCall("repr"),next:function(){var d,g=b.pos[a];g==b.max?(d=c.next(),b.deque.push(d),b.max+=1,b.pos[a]+=1):(d=b.deque[g-b.min],b.pos[a]+=1,g==b.min&&e(b.pos)!=b.min&&(b.min+=1,b.deque.shift()));return d}}};
MochiKit.Iter.tee=function(a,b){var c=[],d={pos:[],deque:[],max:-1,min:-1};if(1==arguments.length||"undefined"==typeof b||null===b)b=2;var e=MochiKit.Iter;a=e.iter(a);for(var e=e._tee,f=0;f<b;f++)c.push(e(f,d,a));return c};
MochiKit.Iter.list=function(a){var b;if(a instanceof Array)return a.slice();if("function"==typeof a&&!(a instanceof Function)&&"number"==typeof a.length){b=[];for(var c=0;c<a.length;c++)b.push(a[c]);return b}c=MochiKit.Iter;a=c.iter(a);b=[];var d;try{for(;;)d=a.next(),b.push(d)}catch(e){if(e!=c.StopIteration)throw e;return b}};
MochiKit.Iter.reduce=function(a,b,c){var d=c,e=MochiKit.Iter;b=e.iter(b);if(3>arguments.length)try{d=b.next()}catch(f){throw f==e.StopIteration&&(f=new TypeError("reduce() of empty sequence with no initial value")),f;}try{for(;;)d=a(d,b.next())}catch(g){if(g!=e.StopIteration)throw g;}return d};
MochiKit.Iter.range=function(){var a=0,b=0,c=1;if(1==arguments.length)b=arguments[0];else if(2==arguments.length)a=arguments[0],b=arguments[1];else if(3==arguments.length)a=arguments[0],b=arguments[1],c=arguments[2];else throw new TypeError("range() takes 1, 2, or 3 arguments!");if(0===c)throw new TypeError("range() step must not be 0");return{next:function(){if(0<c&&a>=b||0>c&&a<=b)throw MochiKit.Iter.StopIteration;var d=a;a+=c;return d},repr:function(){return"range("+[a,b,c].join(", ")+")"},toString:MochiKit.Base.forwardCall("repr")}};
MochiKit.Iter.sum=function(a,b){if("undefined"==typeof b||null===b)b=0;var c=b,d=MochiKit.Iter;a=d.iter(a);try{for(;;)c+=a.next()}catch(e){if(e!=d.StopIteration)throw e;}return c};MochiKit.Iter.exhaust=function(a){var b=MochiKit.Iter;a=b.iter(a);try{for(;;)a.next()}catch(c){if(c!=b.StopIteration)throw c;}};
MochiKit.Iter.forEach=function(a,b,c){var d=MochiKit.Base,e=MochiKit.Iter;2<arguments.length&&(b=d.bind(b,c));if(d.isArrayLike(a)&&!e.isIterable(a))try{for(d=0;d<a.length;d++)b(a[d])}catch(f){if(f!=e.StopIteration)throw f;}else e.exhaust(e.imap(b,a));return b};MochiKit.Iter.every=function(a,b){var c=MochiKit.Iter;try{return c.ifilterfalse(b,a).next(),!1}catch(d){if(d!=c.StopIteration)throw d;return!0}};
MochiKit.Iter.sorted=function(a,b){var c=MochiKit.Iter.list(a);1==arguments.length&&(b=MochiKit.Base.compare);c.sort(b);return c};MochiKit.Iter.reversed=function(a){a=MochiKit.Iter.list(a);a.reverse();return a};MochiKit.Iter.some=function(a,b){var c=MochiKit.Iter;try{return c.ifilter(b,a).next(),!0}catch(d){if(d!=c.StopIteration)throw d;return!1}};
MochiKit.Iter.iextend=function(a,b,c){c=c||0;var d=MochiKit.Iter;if(MochiKit.Base.isArrayLike(b)&&!d.isIterable(b))for(;c<b.length;c++)a.push(b[c]);else{b=d.iter(b);try{for(;0<c--;)b.next();for(;;)a.push(b.next())}catch(e){if(e!=d.StopIteration)throw e;}}return a};
MochiKit.Iter.groupby=function(a,b){var c=MochiKit.Base,d=MochiKit.Iter;2>arguments.length&&(b=c.operator.identity);a=d.iter(a);var e=void 0,f=void 0,g,h=!0,k=c.compare;return{repr:function(){return"groupby(...)"},next:function(){for(;0===k(f,e);)if(g=a.next(),f=b(g),h){h=!1;break}e=f;return[f,{next:function(){void 0==g&&(g=a.next(),f=b(g));if(0!==k(f,e))throw d.StopIteration;var c=g;g=void 0;return c}}]}}};
MochiKit.Iter.groupby_as_array=function(a,b){var c=MochiKit.Base,d=MochiKit.Iter;2>arguments.length&&(b=c.operator.identity);a=d.iter(a);for(var e=[],f=!0,g,c=c.compare;;){try{var h=a.next(),k=b(h)}catch(l){if(l==d.StopIteration)break;throw l;}if(f||0!==c(k,g)){var m=[];e.push([k,m])}m.push(h);f=!1;g=k}return e};
MochiKit.Iter.arrayLikeIter=function(a){var b=0;return{repr:function(){return"arrayLikeIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(b>=a.length)throw MochiKit.Iter.StopIteration;return a[b++]}}};MochiKit.Iter.hasIterateNext=function(a){return a&&"function"==typeof a.iterateNext};
MochiKit.Iter.iterateNextIter=function(a){return{repr:function(){return"iterateNextIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var b=a.iterateNext();if(null===b||void 0===b)throw MochiKit.Iter.StopIteration;return b}}};
MochiKit.Iter.__new__=function(){var a=MochiKit.Base;MochiKit.Iter.StopIteration="undefined"!=typeof StopIteration?StopIteration:new a.NamedError("StopIteration");MochiKit.Iter.iteratorRegistry=new a.AdapterRegistry;MochiKit.Iter.registerIteratorFactory("arrayLike",a.isArrayLike,this.arrayLikeIter);MochiKit.Iter.registerIteratorFactory("iterateNext",this.hasIterateNext,this.iterateNextIter);a.nameFunctions(this)};MochiKit.Iter.__new__();MochiKit.__export__&&(window.reduce=MochiKit.Iter.reduce);
MochiKit.Base._exportSymbols(this,MochiKit.Iter);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Logging={});MochiKit.Base.module(MochiKit,"Logging","1.5",["Base"]);MochiKit.Logging.LogMessage=function(a,b,c){this.num=a;this.level=b;this.info=c;this.timestamp=new Date};MochiKit.Logging.LogMessage.prototype={repr:function(){var a=MochiKit.Base;return"LogMessage("+a.map(a.repr,[this.num,this.level,this.info]).join(", ")+")"},toString:MochiKit.Base.forwardCall("repr")};
MochiKit.Base.update(MochiKit.Logging,{logLevelAtLeast:function(a){var b=MochiKit.Logging;"string"==typeof a&&(a=b.LogLevel[a]);return function(c){c=c.level;"string"==typeof c&&(c=b.LogLevel[c]);return c>=a}},isLogMessage:function(a){for(var b=MochiKit.Logging.LogMessage,c=0;c<arguments.length;c++)if(!(arguments[c]instanceof b))return!1;return!0},compareLogMessage:function(a,b){return MochiKit.Base.compare([a.level,a.info],[b.level,b.info])},alertListener:function(a){alert("num: "+a.num+"\nlevel: "+
a.level+"\ninfo: "+a.info.join(" "))}});MochiKit.Logging.Logger=function(a){this.counter=0;if("undefined"==typeof a||null===a)a=-1;this.maxSize=a;this._messages=[];this.listeners={};this.useNativeConsole=!1};
MochiKit.Logging.Logger.prototype={clear:function(){this._messages.splice(0,this._messages.length)},logToConsole:function(a,b){b=a+": "+b;if("undefined"!=typeof window&&window.console&&window.console.log){var c=null;switch(a){case "INFO":c="function"==typeof window.console.info?"info":null;break;case "DEBUG":c="function"==typeof window.console.debug?"debug":null;break;case "WARNING":c="function"==typeof window.console.warn?"warn":null;break;case "ERROR":c="function"==typeof window.console.error?"error":
null;break;case "FATAL":c="function"==typeof window.console.error?"error":null}window.console[c||"log"](b.replace(/%/g,"\uff05"))}else"undefined"!=typeof opera&&opera.postError?opera.postError(b):"undefined"!=typeof Debug&&Debug.writeln?Debug.writeln(b):"undefined"!=typeof debug&&debug.trace&&debug.trace(b)},dispatchListeners:function(a){for(var b in this.listeners){var c=this.listeners[b];if(c.ident==b&&(!c[0]||c[0](a)))c[1](a)}},addListener:function(a,b,c){"string"==typeof b&&(b=MochiKit.Logging.logLevelAtLeast(b));
b=[b,c];b.ident=a;this.listeners[a]=b},removeListener:function(a){delete this.listeners[a]},baseLog:function(a,b,c){"number"==typeof a&&(a=a>=MochiKit.Logging.LogLevel.FATAL?"FATAL":a>=MochiKit.Logging.LogLevel.ERROR?"ERROR":a>=MochiKit.Logging.LogLevel.WARNING?"WARNING":a>=MochiKit.Logging.LogLevel.INFO?"INFO":"DEBUG");var d=new MochiKit.Logging.LogMessage(this.counter,a,MochiKit.Base.extend(null,arguments,1));this._messages.push(d);this.dispatchListeners(d);this.useNativeConsole&&this.logToConsole(d.level,
d.info.join(" "));for(this.counter+=1;0<=this.maxSize&&this._messages.length>this.maxSize;)this._messages.shift()},getMessages:function(a){var b=0;"undefined"!=typeof a&&null!==a&&(b=Math.max(0,this._messages.length-a));return this._messages.slice(b)},getMessageText:function(a){if("undefined"==typeof a||null===a)a=30;a=this.getMessages(a);if(a.length){var b=MochiKit.Base.map(function(a){return"\n  ["+a.num+"] "+a.level+": "+a.info.join(" ")},a);b.unshift("LAST "+a.length+" MESSAGES:");return b.join("")}return""},
debuggingBookmarklet:function(a){"undefined"==typeof MochiKit.LoggingPane?alert(this.getMessageText()):MochiKit.LoggingPane.createLoggingPane(a||!1)}};
MochiKit.Logging.__new__=function(){MochiKit.Logging.LogLevel={ERROR:40,FATAL:50,WARNING:30,INFO:20,DEBUG:10};var a=MochiKit.Base;a.registerComparator("LogMessage",this.isLogMessage,this.compareLogMessage);var b=a.partial,c=this.Logger,d=c.prototype.baseLog;a.update(this.Logger.prototype,{debug:b(d,"DEBUG"),log:b(d,"INFO"),error:b(d,"ERROR"),fatal:b(d,"FATAL"),warning:b(d,"WARNING")});var e=this,b=function(a){return function(){e.logger[a].apply(e.logger,arguments)}};MochiKit.Logging.log=b("log");
MochiKit.Logging.logError=b("error");MochiKit.Logging.logDebug=b("debug");MochiKit.Logging.logFatal=b("fatal");MochiKit.Logging.logWarning=b("warning");this.logger=new c;this.logger.useNativeConsole=!0;a.nameFunctions(this)};MochiKit.Logging.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Logging);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.DateTime={});MochiKit.Base.module(MochiKit,"DateTime","1.5",["Base"]);MochiKit.DateTime.isoDate=function(a){a+="";if("string"!=typeof a||0===a.length)return null;var b=a.split("-");if(0===b.length)return null;a=parseInt(b[0],10);var c=parseInt(b[1],10)-1,b=parseInt(b[2],10),d=new Date(a,c,b);d.setFullYear(a);d.setMonth(c);d.setDate(b);return d};MochiKit.DateTime._isoRegexp=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/;
MochiKit.DateTime.isoTimestamp=function(a){a+="";if("string"!=typeof a||0===a.length)return null;a=a.match(MochiKit.DateTime._isoRegexp);if("undefined"==typeof a||null===a)return null;var b,c,d,e,f,g,h;b=parseInt(a[1],10);if("undefined"==typeof a[2]||""===a[2])return new Date(b);c=parseInt(a[2],10)-1;d=parseInt(a[3],10);if("undefined"==typeof a[4]||""===a[4])return new Date(b,c,d);e=parseInt(a[4],10);f=parseInt(a[5],10);g="undefined"!=typeof a[6]&&""!==a[6]?parseInt(a[6],10):0;h="undefined"!=typeof a[7]&&
""!==a[7]?Math.round(1E3*parseFloat("0."+a[7])):0;if(!("undefined"!=typeof a[8]&&""!==a[8]||"undefined"!=typeof a[9]&&""!==a[9]))return new Date(b,c,d,e,f,g,h);var k;"undefined"!=typeof a[9]&&""!==a[9]?(k=36E5*parseInt(a[10],10),"undefined"!=typeof a[11]&&""!==a[11]&&(k+=6E4*parseInt(a[11],10)),"-"==a[9]&&(k=-k)):k=0;return new Date(Date.UTC(b,c,d,e,f,g,h)-k)};
MochiKit.DateTime.toISOTime=function(a,b){if("undefined"==typeof a||null===a)return null;var c=MochiKit.DateTime._padTwo;b&&(a=new Date(a.getTime()+6E4*a.getTimezoneOffset()));return[b?c(a.getHours()):""+a.getHours(),c(a.getMinutes()),c(a.getSeconds())].join(":")+(b?"Z":"")};
MochiKit.DateTime.toISOTimestamp=function(a,b){if("undefined"==typeof a||null===a)return null;var c=MochiKit.DateTime.toISOTime(a,b),d=b?"T":" ";b&&(a=new Date(a.getTime()+6E4*a.getTimezoneOffset()));return MochiKit.DateTime.toISODate(a)+d+c};MochiKit.DateTime.toISODate=function(a){if("undefined"==typeof a||null===a)return null;var b=MochiKit.DateTime._padTwo,c=MochiKit.DateTime._padFour;return[c(a.getFullYear()),b(a.getMonth()+1),b(a.getDate())].join("-")};
MochiKit.DateTime.americanDate=function(a){a+="";if("string"!=typeof a||0===a.length)return null;a=a.split("/");return new Date(a[2],a[0]-1,a[1])};MochiKit.DateTime._padTwo=function(a){return 9<a?""+a:"0"+a};MochiKit.DateTime._padFour=function(a){switch(a.toString().length){case 1:return"000"+a;case 2:return"00"+a;case 3:return"0"+a;default:return""+a}};
MochiKit.DateTime.toPaddedAmericanDate=function(a){if("undefined"==typeof a||null===a)return null;var b=MochiKit.DateTime._padTwo;return[b(a.getMonth()+1),b(a.getDate()),a.getFullYear()].join("/")};MochiKit.DateTime.toAmericanDate=function(a){return"undefined"==typeof a||null===a?null:[a.getMonth()+1,a.getDate(),a.getFullYear()].join("/")};MochiKit.DateTime.__new__=function(){MochiKit.Base.nameFunctions(this)};MochiKit.DateTime.__new__();MochiKit.Base._exportSymbols(this,MochiKit.DateTime);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Format={});MochiKit.Base.module(MochiKit,"Format","1.5",["Base"]);
MochiKit.Format._numberFormatter=function(a,b,c,d,e,f,g,h,k){return function(l){l=parseFloat(l);if("undefined"==typeof l||null===l||isNaN(l))return a;var m=b,p=c;0>l?l=-l:m=m.replace(/-/,"");var q=MochiKit.Format.formatLocale(d);e&&(l*=100,p=q.percent+p);l=MochiKit.Format.roundToFixed(l,f);var n=l.split(/\./);l=n[0];for(var n=1==n.length?"":n[1],r="";l.length<g;)l="0"+l;if(h)for(;l.length>h;){var s=l.length-h,r=q.separator+l.substring(s,l.length)+r;l=l.substring(0,s)}r=l+r;if(0<f){for(;n.length<k;)n+=
"0";r=r+q.decimal+n}return m+r+p}};
MochiKit.Format.numberFormatter=function(a,b,c){"undefined"==typeof b&&(b="");var d=a.match(/((?:[0#]+,)?[0#]+)(?:\.([0#]+))?(%)?/);if(!d)throw TypeError("Invalid pattern");var e=a.substr(0,d.index),f=a.substr(d.index+d[0].length);-1==e.search(/-/)&&(e+="-");var g=d[1],h="string"==typeof d[2]&&""!=d[2]?d[2]:"",d="string"==typeof d[3]&&""!=d[3],k=g.split(/,/);"undefined"==typeof c&&(c="default");var k=1==k.length?null:k[1].length,g=g.length-g.replace(/0/g,"").length,l=h.length-h.replace(/0/g,"").length,
e=MochiKit.Format._numberFormatter(b,e,f,c,d,h.length,g,k,l),m=MochiKit.Base;if(m){var p=m.concat(arguments);e.repr=function(){return[self.NAME,"(",m.map(m.repr,p).join(", "),")"].join("")}}return e};MochiKit.Format.formatLocale=function(a){if("undefined"==typeof a||null===a)a="default";if("string"==typeof a){var b=MochiKit.Format.LOCALE[a];"string"==typeof b&&(b=arguments.callee(b),MochiKit.Format.LOCALE[a]=b);return b}return a};MochiKit.Format.twoDigitAverage=function(a,b){if(b){var c=a/b;if(!isNaN(c))return MochiKit.Format.twoDigitFloat(c)}return"0"};
MochiKit.Format.twoDigitFloat=function(a){a=MochiKit.Format.roundToFixed(a,2);return 0<a.indexOf(".00")?a.substring(0,a.length-3):"0"==a.charAt(a.length-1)?a.substring(0,a.length-1):a};MochiKit.Format.lstrip=function(a,b){a+="";return"string"!=typeof a?null:b?a.replace(RegExp("^["+b+"]+"),""):a.replace(/^\s+/,"")};MochiKit.Format.rstrip=function(a,b){a+="";return"string"!=typeof a?null:b?a.replace(RegExp("["+b+"]+$"),""):a.replace(/\s+$/,"")};
MochiKit.Format.strip=function(a,b){var c=MochiKit.Format;return c.rstrip(c.lstrip(a,b),b)};MochiKit.Format.truncToFixed=function(a,b){var c=MochiKit.Format._numberToFixed(a,b),d=c.indexOf(".");0<d&&d+b+1<c.length&&(c=c.substring(0,d+b+1),c=MochiKit.Format._shiftNumber(c,0));return c};
MochiKit.Format.roundToFixed=function(a,b){var c=MochiKit.Format._numberToFixed(a,b),d=c.indexOf(".");0<d&&d+b+1<c.length&&(c=MochiKit.Format._shiftNumber(c,b),c=MochiKit.Format._numberToFixed(Math.round(parseFloat(c)),0),c=MochiKit.Format._shiftNumber(c,-b));return c};
MochiKit.Format._numberToFixed=function(a,b){for(var c=a.toString().split(/[eE]/),d=1===c.length?0:parseInt(c[1],10)||0,c=MochiKit.Format._shiftNumber(c[0],d).split(/\./),d=c[0],c=1===c.length?"":c[1];c.length<b;)c+="0";return 0<c.length?d+"."+c:d};
MochiKit.Format._shiftNumber=function(a,b){var c=a.indexOf(".");0>c?c=a.length:a=a.substring(0,c)+a.substring(c+1);for(c+=b;0>=c||1>=c&&"-"===a.charAt(0);)a="-"===a.charAt(0)?"-0"+a.substring(1):"0"+a,c++;for(;c>a.length;)a+="0";for(c<a.length&&(a=a.substring(0,c)+"."+a.substring(c));/^0[^.]/.test(a);)a=a.substring(1);for(;/^-0[^.]/.test(a);)a="-"+a.substring(2);return a};MochiKit.Format.percentFormat=function(a){return MochiKit.Format.twoDigitFloat(100*a)+"%"};
MochiKit.Format.LOCALE={en_US:{separator:",",decimal:".",percent:"%"},de_DE:{separator:".",decimal:",",percent:"%"},pt_BR:{separator:".",decimal:",",percent:"%"},fr_FR:{separator:" ",decimal:",",percent:"%"},"default":"en_US",__export__:!1};MochiKit.Format.__new__=function(){MochiKit.Base.nameFunctions(this);var a=this.NAME+".",b,c;for(b in this.LOCALE)c=this.LOCALE[b],"object"==typeof c&&(c.repr=function(){return this.NAME},c.NAME=a+"LOCALE."+b)};MochiKit.Format.__new__();
MochiKit.Base._exportSymbols(this,MochiKit.Format);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Text={});MochiKit.Base.module(MochiKit,"Text","1.5",["Base","Format"]);MochiKit.Text.startsWith=function(a,b){return null!=b&&null!=a&&0==b.indexOf(a)};MochiKit.Text.endsWith=function(a,b){return null!=b&&null!=a&&b.lastIndexOf(a)==Math.max(b.length-a.length,0)};MochiKit.Text.contains=function(a,b){return null!=b&&null!=a&&0<=b.indexOf(a)};MochiKit.Text.padLeft=function(a,b,c){a=a||"";for(c=c||" ";a.length<b;)a=c+a;return a};
MochiKit.Text.padRight=function(a,b,c){a=a||"";for(c=c||" ";a.length<b;)a+=c;return a};MochiKit.Text.truncate=function(a,b,c){return null==a||a.length<=b||0>b?a:null!=c?(a=a.slice(0,Math.max(0,b-c.length)),"string"==typeof a?a+c:MochiKit.Base.extend(a,c)):a.slice(0,b)};MochiKit.Text.split=function(a,b,c){if(null==a)return a;b=b||"\n";a=a.split(b);if("undefined"==typeof c||c>=a.length-1)return a;a.splice(c,a.length,a.slice(c,a.length).join(b));return a};
MochiKit.Text.rsplit=function(a,b,c){if(null==a)return a;b=b||"\n";a=a.split(b);if("undefined"==typeof c||c>=a.length-1)return a;a.splice(0,a.length-c,a.slice(0,a.length-c).join(b));return a};
MochiKit.Text.formatter=function(a,b){null==b?b=MochiKit.Format.formatLocale():"string"==typeof b&&(b=MochiKit.Format.formatLocale(b));var c=MochiKit.Text._parsePattern(a);return function(){for(var a=MochiKit.Base.extend([],arguments),e=[],f=0;f<c.length;f++)"string"==typeof c[f]?e.push(c[f]):e.push(MochiKit.Text.formatValue(c[f],a,b));return e.join("")}};MochiKit.Text.format=function(a,b){return MochiKit.Text.formatter(a).apply(this,MochiKit.Base.extend([],arguments,1))};
MochiKit.Text.formatValue=function(a,b,c){var d=MochiKit.Text;"string"===typeof a&&(a=d._parseFormatFlags(a,0,a.length));for(var e=0;null!=a.path&&e<a.path.length;e++)null!=b&&(b=b[a.path[e]]);null==c?c=MochiKit.Format.formatLocale():"string"==typeof c&&(c=MochiKit.Format.formatLocale(c));e="";if("number"==a.type){b instanceof Number&&(b=b.valueOf());if("number"!=typeof b||isNaN(b))e="";else if(b===Number.POSITIVE_INFINITY)e="\u221e";else if(b===Number.NEGATIVE_INFINITY)e="-\u221e";else{var f=0>b?
"-":a.sign;b=Math.abs(b);"%"===a.format?e=d._truncToPercent(b,a.precision):"d"===a.format?e=MochiKit.Format.roundToFixed(b,0):10!=a.radix?(e=Math.floor(b).toString(a.radix),"x"===a.format?e=e.toLowerCase():"X"===a.format&&(e=e.toUpperCase())):e=0<=a.precision?MochiKit.Format.roundToFixed(b,a.precision):b.toString();"0"===a.padding&&"%"===a.format?e=d.padLeft(e,a.width-f.length-1,"0"):"0"==a.padding&&(e=d.padLeft(e,a.width-f.length,"0"));e=d._localizeNumber(e,c,a.group);e=f+e}""!==e&&"%"===a.format&&
(e+=c.percent)}else e="r"==a.format?MochiKit.Base.repr(b):null==b?"":b.toString(),e=d.truncate(e,a.precision);return e="<"==a.align?d.padRight(e,a.width):d.padLeft(e,a.width)};
MochiKit.Text._localizeNumber=function(a,b,c){var d=a.split(/\./);a=d[0];for(var e=1==d.length?"":d[1],d=0<e.length?b.decimal:"";c&&3<e.length;)d=d+e.substring(0,3)+b.separator,e=e.substring(3),"0"==a.charAt(0)&&(a=a.substring(1));for(0<e.length&&(d+=e);c&&3<a.length;)e=a.length-3,d=b.separator+a.substring(e)+d,a=a.substring("0"==a.charAt(0)?1:0,e);return a+d};
MochiKit.Text._parsePattern=function(a){for(var b=MochiKit.Text,c=[],d=/{[^{}]*}|{{?|}}?/g,e=d.lastIndex=0,f;null!=(f=d.exec(a));){e<f.index&&c.push(a.substring(e,f.index));var g=f[0],e=f.index+g.length;if(b.startsWith("{",g)&&b.endsWith("}",g))c.push(b._parseFormat(a,f.index+1,e-1));else if(b.startsWith("{{",g)||b.startsWith("}}",g))c.push(g.substring(1));else{if(b.startsWith("{",g))throw c="unescaped { char, should be escaped as {{",new b.FormatPatternError(a,f.index,c);if(b.startsWith("}",g))throw c=
"unescaped } char, should be escaped as }}",new b.FormatPatternError(a,f.index,c);}}e<a.length&&c.push(a.substring(e));return c};
MochiKit.Text._parseFormat=function(a,b,c){var d=MochiKit.Text,e=a.substring(b,c),f=d.split(e,":",1),e=f[0];c=d._parseFormatFlags(a,b+e.length+(1==f.length?0:1),c);c.path=""==e?[]:e.split(".");for(e=0;e<c.path.length;e++){f=c.path[e];f=f.replace(/^\s+/,"").replace(/\s+$/,"");if(""==f&&1==c.path.length)f=0;else{if(""==f)throw new d.FormatPatternError(a,b,"format value path contains blanks");/^\d+$/.test(f)&&(f=parseInt(f,10))}c.path[e]=f}(0>=c.path.length||"number"!=typeof c.path[0])&&c.path.unshift(0);
return c};
MochiKit.Text._parseFormatFlags=function(a,b,c){var d=MochiKit.Base.update,e={type:"string",format:"s",width:0,precision:-1,align:">",sign:"",padding:" ",group:!1};c=a.substring(b,c).replace(/\s+$/,"");var f=/^([<>+ 0,-]+)?(\d+)?(\.\d*)?([srbdoxXf%])?(.*)$/.exec(c);c=f[1];for(var g=f[2],h=f[3],k=f[4],f=f[5],l=0;c&&l<c.length;l++){var m=c.charAt(l);"<"==m||">"==m?e.align=m:"+"==m||"-"==m||" "==m?e.sign="-"==m?"":m:"0"==m?e.padding=m:","==m&&(e.group=!0)}g&&(e.width=parseInt(g,10));h&&1<h.length&&(e.precision=
parseInt(h.substring(1),10));"s"==k||"r"==k?e.format=k:"b"==k?d(e,{type:"number",format:k,radix:2}):"o"==k?d(e,{type:"number",format:k,radix:8}):"x"==k||"X"==k?d(e,{type:"number",format:k,radix:16}):"d"!=k&&"f"!=k&&"%"!=k||d(e,{type:"number",format:k,radix:10});if(f)throw d="unsupported format flag: "+f.charAt(0),new MochiKit.Text.FormatPatternError(a,b,d);return e};
MochiKit.Text._truncToPercent=function(a,b){var c;c=0<=b?MochiKit.Format.roundToFixed(a,b+2):null==a?"0":a.toString();var d=MochiKit.Text.split(c,".",2);c=MochiKit.Text.padRight(d[1],2,"0");d=d[0]+c.substring(0,2);for(c=c.substring(2);/^0[0-9]/.test(d);)d=d.substring(1);return 0>=c.length?d:d+"."+c};MochiKit.Text.FormatPatternError=function(a,b,c){this.pattern=a;this.pos=b;this.message=c};MochiKit.Text.FormatPatternError.prototype=new MochiKit.Base.NamedError("MochiKit.Text.FormatPatternError");
MochiKit.Text.FormatPatternError.constructor=MochiKit.Text.FormatPatternError;MochiKit.__export__&&(window.formatter=MochiKit.Text.formatter,window.format=MochiKit.Text.format,window.formatValue=MochiKit.Text.formatValue);MochiKit.Base.nameFunctions(MochiKit.Text);MochiKit.Base._exportSymbols(this,MochiKit.Text);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Async={});MochiKit.Base.module(MochiKit,"Async","1.5",["Base"]);MochiKit.Async.Deferred=function(a){this.chain=[];this.id=this._nextId();this.fired=-1;this.paused=0;this.results=[null,null];this.canceller=a;this.finalized=this.chained=this.silentlyCancelled=!1};MochiKit.Async.Deferred.prototype.repr=function(){return"Deferred("+this.id+", "+this.state()+")"};MochiKit.Async.Deferred.prototype.toString=MochiKit.Base.forwardCall("repr");
MochiKit.Async.Deferred.prototype._nextId=MochiKit.Base.counter();MochiKit.Async.Deferred.prototype.state=function(){return-1==this.fired?"unfired":0===this.fired?"success":"error"};
MochiKit.Async.Deferred.prototype.cancel=function(a){var b=MochiKit.Async;-1==this.fired?(this.canceller?this.canceller(this):this.silentlyCancelled=!0,-1==this.fired&&("string"===typeof a?a=new b.GenericError(a):a instanceof Error||(a=new b.CancelledError(this)),this.errback(a))):0===this.fired&&this.results[0]instanceof b.Deferred&&this.results[0].cancel(a)};MochiKit.Async.Deferred.prototype._resback=function(a){this.fired=a instanceof Error?1:0;this.results[this.fired]=a;0===this.paused&&this._fire()};
MochiKit.Async.Deferred.prototype._check=function(){if(-1!=this.fired){if(!this.silentlyCancelled)throw new MochiKit.Async.AlreadyCalledError(this);this.silentlyCancelled=!1}};MochiKit.Async.Deferred.prototype.callback=function(a){this._check();if(a instanceof MochiKit.Async.Deferred)throw Error("Deferred instances can only be chained if they are the result of a callback");this._resback(a)};
MochiKit.Async.Deferred.prototype.errback=function(a){this._check();var b=MochiKit.Async;if(a instanceof b.Deferred)throw Error("Deferred instances can only be chained if they are the result of a callback");a instanceof Error||(a=new b.GenericError(a));this._resback(a)};MochiKit.Async.Deferred.prototype.addBoth=function(a,b){1<arguments.length&&(a=MochiKit.Base.partial.apply(null,arguments));return this.addCallbacks(a,a)};
MochiKit.Async.Deferred.prototype.addCallback=function(a,b){1<arguments.length&&(a=MochiKit.Base.partial.apply(null,arguments));return this.addCallbacks(a,null)};MochiKit.Async.Deferred.prototype.addErrback=function(a,b){1<arguments.length&&(a=MochiKit.Base.partial.apply(null,arguments));return this.addCallbacks(null,a)};
MochiKit.Async.Deferred.prototype.addCallbacks=function(a,b){if(this.chained)throw Error("Chained Deferreds can not be re-used");if(this.finalized)throw Error("Finalized Deferreds can not be re-used");this.chain.push([a,b]);0<=this.fired&&this._fire();return this};
MochiKit.Async.Deferred.prototype.setFinalizer=function(a){if(this.chained)throw Error("Chained Deferreds can not be re-used");if(this.finalized)throw Error("Finalized Deferreds can not be re-used");1<arguments.length&&(a=MochiKit.Base.partial.apply(null,arguments));this._finalizer=a;0<=this.fired&&this._fire();return this};
MochiKit.Async.Deferred.prototype._fire=function(){for(var a=this.chain,b=this.fired,c=this.results[b],d=this,e=null;0<a.length&&0===this.paused;){var f=a.shift()[b];if(null!==f)try{var g=f(c);void 0!==g&&(c=g);b=c instanceof Error?1:0;c instanceof MochiKit.Async.Deferred&&(e=function(a){d.paused--;d._resback(a)},this.paused++)}catch(h){b=1,h instanceof Error||(h=new MochiKit.Async.GenericError(h)),c=h}}this.fired=b;this.results[b]=c;0==this.chain.length&&(0===this.paused&&this._finalizer)&&(this.finalized=
!0,this._finalizer(c));e&&this.paused&&(c.addBoth(e),c.chained=!0)};MochiKit.Async.evalJSONRequest=function(a){return MochiKit.Base.evalJSON(a.responseText)};MochiKit.Async.succeed=function(a){var b=new MochiKit.Async.Deferred;b.callback.apply(b,arguments);return b};MochiKit.Async.fail=function(a){var b=new MochiKit.Async.Deferred;b.errback.apply(b,arguments);return b};
MochiKit.Async.getXMLHttpRequest=function(){var a=arguments.callee;if(!a.XMLHttpRequest)for(var b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.4.0")},function(){throw new MochiKit.Async.BrowserComplianceError("Browser does not support XMLHttpRequest");}],c=0;c<b.length;c++){var d=b[c];try{return a.XMLHttpRequest=d,d()}catch(e){}}return a.XMLHttpRequest()};
MochiKit.Async._xhr_onreadystatechange=function(a){var b=MochiKit.Base;if(4==this.readyState){try{this.onreadystatechange=null}catch(c){try{this.onreadystatechange=b.noop}catch(d){}}var e=null;try{(e=this.status)||!this.response&&!b.isNotEmpty(this.responseText)||(e=304)}catch(f){}200==e||201==e||204==e||304==e||1223==e?a.callback(this):(b=new MochiKit.Async.XMLHttpRequestError(this,"Request failed"),a.errback(b))}};
MochiKit.Async._xhr_canceller=function(a){try{a.onreadystatechange=null}catch(b){try{a.onreadystatechange=MochiKit.Base.noop}catch(c){}}a.abort()};MochiKit.Async.sendXMLHttpRequest=function(a,b){if("undefined"==typeof b||null===b)b="";var c=MochiKit.Base,d=MochiKit.Async,e=new d.Deferred(c.partial(d._xhr_canceller,a));try{a.onreadystatechange=c.bind(d._xhr_onreadystatechange,a,e),a.send(b)}catch(f){try{a.onreadystatechange=null}catch(g){}e.errback(f)}return e};
MochiKit.Async.doXHR=function(a,b){var c=MochiKit.Base;b=c.update({method:"GET",sendContent:"",async:!0},b);var d=MochiKit.Async,e=d.getXMLHttpRequest();if(b.queryString){var f=c.queryString(b.queryString);f&&(a+="?"+f)}"username"in b?e.open(b.method,a,b.async,b.username,b.password):e.open(b.method,a,b.async);e.overrideMimeType&&b.mimeType&&e.overrideMimeType(b.mimeType);e.setRequestHeader("X-Requested-With","XMLHttpRequest");if(b.headers)for(f=b.headers,c.isArrayLike(f)||(f=c.items(f)),c=0;c<f.length;c++){var g=
f[c];e.setRequestHeader(g[0],g[1])}"responseType"in b&&"responseType"in e&&(e.responseType=b.responseType);b.withCredentials&&(e.withCredentials="true");return d.sendXMLHttpRequest(e,b.sendContent)};MochiKit.Async._buildURL=function(a,b){if(1<arguments.length){var c=MochiKit.Base;if(c=c.queryString.apply(null,c.extend(null,arguments,1)))return a+"?"+c}return a};MochiKit.Async.doSimpleXMLHttpRequest=function(a){var b=MochiKit.Async;a=b._buildURL.apply(b,arguments);return b.doXHR(a)};
MochiKit.Async.loadJSONDoc=function(a){var b=MochiKit.Async;a=b._buildURL.apply(b,arguments);var c=b.doXHR(a,{mimeType:"text/plain",headers:[["Accept","application/json"]]});return c=c.addCallback(b.evalJSONRequest)};
MochiKit.Async.loadScript=function(a){var b=new MochiKit.Async.Deferred,c=document.createElement("script");c.type="text/javascript";c.onload=function(){c.onload=null;c.onerror=null;c=c.onreadystatechange=null;b.callback()};c.onerror=function(d){c.onload=null;c.onerror=null;c=c.onreadystatechange=null;d="Failed to load script at "+a+": "+d;b.errback(new URIError(d,a))};c.onreadystatechange=function(){if("loaded"==c.readyState||"complete"==c.readyState)c.onload();else MochiKit.Async.callLater(10,c.onerror,
"Script loading timed out")};document.getElementsByTagName("head")[0].appendChild(c);c.src=a;return b};MochiKit.Async.wait=function(a,b){var c=new MochiKit.Async.Deferred,d=MochiKit.Base.bind("callback",c,b),e=setTimeout(d,Math.floor(1E3*a));c.canceller=function(){try{clearTimeout(e)}catch(a){}};return c};MochiKit.Async.callLater=function(a,b,c){var d=MochiKit.Base,e=d.partial.apply(d,d.extend(null,arguments,1));return MochiKit.Async.wait(a).addCallback(function(a){return e()})};
MochiKit.Async.DeferredLock=function(){this.waiting=[];this.locked=!1;this.id=this._nextId()};MochiKit.Async.DeferredLock.prototype.__class__=MochiKit.Async.DeferredLock;MochiKit.Async.DeferredLock.prototype.acquire=function(){var a=new MochiKit.Async.Deferred;this.locked?this.waiting.push(a):(this.locked=!0,a.callback(this));return a};
MochiKit.Async.DeferredLock.prototype.release=function(){if(!this.locked)throw TypeError("Tried to release an unlocked DeferredLock");this.locked=!1;0<this.waiting.length&&(this.locked=!0,this.waiting.shift().callback(this))};MochiKit.Async.DeferredLock.prototype._nextId=MochiKit.Base.counter();MochiKit.Async.DeferredLock.prototype.repr=function(){return"DeferredLock("+this.id+", "+(this.locked?"locked, "+this.waiting.length+" waiting":"unlocked")+")"};
MochiKit.Async.DeferredLock.prototype.toString=MochiKit.Base.forwardCall("repr");MochiKit.Async.DeferredList=function(a,b,c,d,e){MochiKit.Async.Deferred.apply(this,[e]);this.list=a;this.resultList=e=[];this.finishedCount=0;this.fireOnOneCallback=b;this.fireOnOneErrback=c;this.consumeErrors=d;c=MochiKit.Base.bind(this._cbDeferred,this);for(d=0;d<a.length;d++){var f=a[d];e.push(void 0);f.addCallback(c,d,!0);f.addErrback(c,d,!1)}0!==a.length||b||this.callback(this.resultList)};
MochiKit.Async.DeferredList.prototype=new MochiKit.Async.Deferred;MochiKit.Async.DeferredList.prototype.constructor=MochiKit.Async.DeferredList;MochiKit.Async.DeferredList.prototype._cbDeferred=function(a,b,c){this.resultList[a]=[b,c];this.finishedCount+=1;-1==this.fired&&(b&&this.fireOnOneCallback?this.callback([a,c]):!b&&this.fireOnOneErrback?this.errback(c):this.finishedCount==this.list.length&&this.callback(this.resultList));!b&&this.consumeErrors&&(c=null);return c};
MochiKit.Async.gatherResults=function(a,b){var c=MochiKit.Base.flattenArguments(arguments),c=new MochiKit.Async.DeferredList(c,!1,!0,!1);c.addCallback(function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c][1]);return b});return c};MochiKit.Async.maybeDeferred=function(a){var b=MochiKit.Async,c;try{var d=a.apply(null,MochiKit.Base.extend([],arguments,1));c=d instanceof b.Deferred?d:d instanceof Error?b.fail(d):b.succeed(d)}catch(e){c=b.fail(e)}return c};
MochiKit.Async.when=function(a){return"undefined"!=typeof a&&"function"==typeof a.addCallback?a:MochiKit.Async.succeed(a)};MochiKit.Async.timeout=function(a,b){var c=new MochiKit.Async.Deferred,d=setTimeout(function(){c.cancel()},b);a.addBoth(function(){clearTimeout(d)}).addCallbacks(MochiKit.Base.bind(c.callback,c),MochiKit.Base.bind(c.errback,c));return c};
MochiKit.Async.__new__=function(){var a=MochiKit.Base,b=a.partial(a._newNamedError,this);b("AlreadyCalledError",function(a){this.deferred=a});b("CancelledError",function(a){this.deferred=a});b("BrowserComplianceError",function(a){this.message=a});b("GenericError",function(a){this.message=a});b("XMLHttpRequestError",function(a,b){this.req=a;this.message=b;try{this.number=a.status}catch(e){}});a.nameFunctions(this)};MochiKit.Async.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Async);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.DOM={});MochiKit.Base.module(MochiKit,"DOM","1.5",["Base"]);
MochiKit.Base.update(MochiKit.DOM,{currentWindow:function(){return MochiKit.DOM._window},currentDocument:function(){return MochiKit.DOM._document},withWindow:function(a,b){var c=MochiKit.DOM,d=c._document,e=c._window,f;try{c._window=a,c._document=a.document,f=b()}catch(g){throw c._window=e,c._document=d,g;}c._window=e;c._document=d;return f},formContents:function(a){var b=[],c=[],d=MochiKit.Base,e=MochiKit.DOM;a="undefined"==typeof a||null===a?e._document.body:e.getElement(a);d.nodeWalk(a,function(a){var e=
a.name;if(d.isNotEmpty(e)){var h=a.tagName.toUpperCase();if("INPUT"===h&&("radio"==a.type||"checkbox"==a.type)&&!a.checked)return null;if("SELECT"===h){if("select-one"==a.type){if(0<=a.selectedIndex){a=a.options[a.selectedIndex];h=a.value;if(!h){var k=a.outerHTML;k&&!k.match(/^[^>]+\svalue\s*=/i)&&(h=a.text)}b.push(e);c.push(h);return null}b.push(e);c.push("")}else{var l=a.options;if(!l.length)return b.push(e),c.push(""),null;for(var m=0;m<l.length;m++)a=l[m],a.selected&&(h=a.value,h||(k=a.outerHTML)&&
!k.match(/^[^>]+\svalue\s*=/i)&&(h=a.text),b.push(e),c.push(h))}return null}if("FORM"===h||"P"===h||"SPAN"===h||"DIV"===h)return a.childNodes;b.push(e);c.push(a.value||"");return null}return a.childNodes});return[b,c]},withDocument:function(a,b){var c=MochiKit.DOM,d=c._document,e;try{c._document=a,e=b()}catch(f){throw c._document=d,f;}c._document=d;return e},registerDOMConverter:function(a,b,c,d){MochiKit.DOM.domConverters.register(a,b,c,d)},coerceToDOM:function(a,b){var c=MochiKit.Base,d=MochiKit.Iter,
e=MochiKit.DOM;if(d)var f=d.iter,g=d.repeat;for(var h=c.map,k=e.domConverters,l=arguments.callee,m=c.NotFound;;){if("undefined"==typeof a||null===a)return null;"function"!=typeof a||("number"!=typeof a.length||a instanceof Function)||(a=d?d.list(a):c.extend(null,a));if("undefined"!=typeof a.nodeType&&0<a.nodeType)return a;if("number"==typeof a||"boolean"==typeof a)a=a.toString();if("string"==typeof a)return e._document.createTextNode(a);if("function"==typeof a.__dom__)a=a.__dom__(b);else if("function"==
typeof a.dom)a=a.dom(b);else if("function"==typeof a)a=a.apply(b,[b]);else{if(d){var p=null;try{p=f(a)}catch(q){}if(p)return h(l,p,g(b))}else if(c.isArrayLike(a))return h(function(a){return l(a,b)},a);try{a=k.match(a,b);continue}catch(n){if(n!=m)throw n;}return e._document.createTextNode(a.toString())}}},isChildNode:function(a,b){var c=MochiKit.DOM;"string"==typeof a&&(a=c.getElement(a));"string"==typeof b&&(b=c.getElement(b));if("undefined"==typeof a||null===a)return!1;for(;null!=a&&a!==c._document;){if(a===
b)return!0;a=a.parentNode}return!1},setNodeAttribute:function(a,b,c){var d={};d[b]=c;try{return MochiKit.DOM.updateNodeAttributes(a,d)}catch(e){}return null},getNodeAttribute:function(a,b){var c=MochiKit.DOM,d=c.attributeArray.renames[b],e=c.attributeArray.ignoreAttr[b];a=c.getElement(a);try{if(d)return a[d];var f=a.getAttribute(b);if(f!=e)return f}catch(g){}return null},removeNodeAttribute:function(a,b){var c=MochiKit.DOM,d=c.attributeArray.renames[b];a=c.getElement(a);try{return d?a[d]:a.removeAttribute(b)}catch(e){}return null},
updateNodeAttributes:function(a,b){var c=a,d=MochiKit.DOM,e=MochiKit.Base;"string"==typeof a&&(c=d.getElement(a));if(b)if(d.attributeArray.compliant)for(var f in b)d=b[f],"object"==typeof d&&"object"==typeof c[f]?"style"==f&&MochiKit.Style?MochiKit.Style.setStyle(c,d):e.updatetree(c[f],d):"on"==f.substring(0,2)?("string"==typeof d&&(d=new Function(d)),c[f]=d):c.setAttribute(f,d),e.isValue(c[f])&&c[f]!=d&&(c[f]=d);else{var g=d.attributeArray.renames;for(f in b){var d=b[f],h=g[f];"style"==f&&"string"==
typeof d?c.style.cssText=d:"string"==typeof h?c[h]=d:"object"==typeof c[f]&&"object"==typeof d?"style"==f&&MochiKit.Style?MochiKit.Style.setStyle(c,d):e.updatetree(c[f],d):"on"==f.substring(0,2)?("string"==typeof d&&(d=new Function(d)),c[f]=d):c.setAttribute(f,d);e.isValue(c[f])&&c[f]!=d&&(c[f]=d)}}return c},appendChildNodes:function(a,b,c){var d=a,e=MochiKit.DOM;"string"==typeof a&&(d=e.getElement(a));for(var e=[e.coerceToDOM(MochiKit.Base.extend(null,arguments,1),d)],f=MochiKit.Base.concat;e.length;){var g=
e.shift();"undefined"!=typeof g&&null!==g&&("number"==typeof g.nodeType?d.appendChild(g):e=f(g,e))}return d},insertSiblingNodesBefore:function(a,b,c){var d=a,e=MochiKit.DOM;"string"==typeof a&&(d=e.getElement(a));for(var e=[e.coerceToDOM(MochiKit.Base.extend(null,arguments,1),d)],f=d.parentNode,g=MochiKit.Base.concat;e.length;){var h=e.shift();"undefined"!=typeof h&&null!==h&&("number"==typeof h.nodeType?f.insertBefore(h,d):e=g(h,e))}return f},insertSiblingNodesAfter:function(a,b,c){var d=a,e=MochiKit.DOM;
"string"==typeof a&&(d=e.getElement(a));var f=[e.coerceToDOM(MochiKit.Base.extend(null,arguments,1),d)];return d.nextSibling?e.insertSiblingNodesBefore(d.nextSibling,f):e.appendChildNodes(d.parentNode,f)},replaceChildNodes:function(a,b){var c=a,d=MochiKit.DOM;"string"==typeof a&&(c=d.getElement(a),arguments[0]=c);for(var e;e=c.firstChild;)c.removeChild(e);return 2>arguments.length?c:d.appendChildNodes.apply(this,arguments)},createDOM:function(a,b){var c,d=MochiKit.DOM,e=MochiKit.Base;if("string"==
typeof b||"number"==typeof b)return e=e.extend([a,null],arguments,1),arguments.callee.apply(this,e);if("string"==typeof a){c=d._xhtml;if(b&&!d.attributeArray.compliant){var f="";"name"in b&&(f+=' name="'+d.escapeHTML(b.name)+'"');"input"==a&&"type"in b&&(f+=' type="'+d.escapeHTML(b.type)+'"');f&&(a="<"+a+f+">",c=!1)}f=d._document;c=c&&f===document?f.createElementNS("http://www.w3.org/1999/xhtml",a):f.createElement(a)}else c=a;b&&d.updateNodeAttributes(c,b);if(2>=arguments.length)return c;e=e.extend([c],
arguments,2);return d.appendChildNodes.apply(this,e)},createDOMFunc:function(){var a=MochiKit.Base;return a.partial.apply(this,a.extend([MochiKit.DOM.createDOM],arguments))},removeElement:function(a){var b=MochiKit.DOM;"string"==typeof a&&(a=b.getElement(a));(a=b.coerceToDOM(a))&&a.parentNode&&a.parentNode.removeChild(a);return a},swapDOM:function(a,b){var c=MochiKit.DOM;a=c.getElement(a);var d=a.parentNode;b?("string"==typeof b&&(b=c.getElement(b)),b=c.coerceToDOM(b,d),d.replaceChild(b,a)):d.removeChild(a);
return b},getElement:function(a){var b=MochiKit.DOM;return 1==arguments.length?"string"==typeof a?b._document.getElementById(a):a:MochiKit.Base.map(b.getElement,arguments)},getElementsByClassName:function(a,b){var c=MochiKit.DOM;c.getElementsByClassName=c._document.getElementsByClassName?function(a,b){b=b||c._document;b=c.getElement(b);var f=b.getElementsByClassName(a);return MochiKit.Base.extend([],f)}:c._document.evaluate?function(a,b){b=b||c._document;b=c.getElement(b);for(var f=a.split(" "),g=
"",h=0,k=f.length;h<k;++h)g+="[contains(concat(' ', @class, ' '), ' "+f[h]+" ')]";f=[];try{f=c._document.evaluate(".//*"+g,b,"http://www.w3.org/1999/xhtml"===c._document.documentElement.namespaceURI?"http://www.w3.org/1999/xhtml":null,0,null)}catch(l){f=c._document.evaluate(".//*"+g,b,null,0,null)}return MochiKit.Iter.list(f)}:function(a,b){b=b||c._document;b=c.getElement(b);for(var f=a.split(" "),g=[],h=0,k=f.length;h<k;++h)g.push(RegExp("(^|\\s)"+f[h]+"(\\s|$)"));for(var f=b.all?b.all:b.getElementsByTagName("*"),
h=[],k=0,l=f.length;k<l;++k){for(var m=f[k],p=!1,q=0,n=g.length;q<n&&(p=g[q].test(m.className),p);++q);p&&h.push(m)}return h};return c.getElementsByClassName(a,b)},getElementsByTagAndClassName:function(a,b,c){var d=MochiKit.DOM;if("undefined"==typeof a||null===a)a="*";if("undefined"==typeof c||null===c)c=d._document;c=d.getElement(c);if(null==c)return[];if("*"==a)return d.getElementsByClassName(b,c);a=c.getElementsByTagName(a)||d._document.all;if("undefined"==typeof b||null===b)return MochiKit.Base.extend(null,
a);c=[];for(d=0;d<a.length;d++){var e=a[d],f=e.className;"string"!=typeof f&&(f=e.getAttribute("class"));if("string"==typeof f)for(var f=f.split(" "),g=0;g<f.length;g++)if(f[g]==b){c.push(e);break}}return c},_newCallStack:function(a,b){var c=function(){for(var c=arguments.callee.callStack,e=0;e<c.length&&!1!==c[e].apply(this,arguments);e++);if(b)try{this[a]=null}catch(f){}};c.callStack=[];return c},addToCallStack:function(a,b,c,d){var e=MochiKit.DOM,f=a[b],g=f;if("function"!=typeof f||"object"!=typeof f.callStack||
null===f.callStack)g=e._newCallStack(b,d),"function"==typeof f&&g.callStack.push(f),a[b]=g;g.callStack.push(c)},addLoadEvent:function(a){var b=MochiKit.DOM;b.addToCallStack(b._window,"onload",a,!0)},focusOnLoad:function(a){var b=MochiKit.DOM;b.addLoadEvent(function(){(a=b.getElement(a))&&a.focus()})},setElementClass:function(a,b){var c=MochiKit.DOM,d=c.getElement(a);c.attributeArray.compliant?d.setAttribute("class",b):d.setAttribute("className",b)},toggleElementClass:function(a,b,c){for(var d=MochiKit.DOM,
e=1;e<arguments.length;e++){var f=d.getElement(arguments[e]);d.addElementClass(f,a)||d.removeElementClass(f,a)}},addElementClass:function(a,b){var c=MochiKit.DOM,d=c.getElement(a),e=d.className;"string"!=typeof e&&(e=d.getAttribute("class"));if("string"!=typeof e||0===e.length)return c.setElementClass(d,b),!0;if(e==b)return!1;for(var f=e.split(" "),g=0;g<f.length;g++)if(f[g]==b)return!1;c.setElementClass(d,e+" "+b);return!0},removeElementClass:function(a,b){var c=MochiKit.DOM,d=c.getElement(a),e=
d.className;"string"!=typeof e&&(e=d.getAttribute("class"));if("string"!=typeof e||0===e.length)return!1;if(e==b)return c.setElementClass(d,""),!0;for(var e=e.split(" "),f=0;f<e.length;f++)if(e[f]==b)return e.splice(f,1),c.setElementClass(d,e.join(" ")),!0;return!1},swapElementClass:function(a,b,c){a=MochiKit.DOM.getElement(a);(b=MochiKit.DOM.removeElementClass(a,b))&&MochiKit.DOM.addElementClass(a,c);return b},hasElementClass:function(a,b,c){var d=MochiKit.DOM.getElement(a);if(null==d)return!1;var e=
d.className;"string"!=typeof e&&"function"==typeof d.getAttribute&&(e=d.getAttribute("class"));if("string"!=typeof e)return!1;d=e.split(" ");for(e=1;e<arguments.length;e++){for(var f=!1,g=0;g<d.length;g++)if(d[g]==arguments[e]){f=!0;break}if(!f)return!1}return!0},escapeHTML:function(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},toHTML:function(a){return MochiKit.DOM.emitHTML(a).join("")},emitHTML:function(a,b){if("undefined"==typeof b||null===
b)b=[];for(var c=[a],d=MochiKit.DOM,e=d.escapeHTML,d=d.attributeArray;c.length;)if(a=c.pop(),"string"==typeof a)b.push(a);else if(1==a.nodeType){b.push("<"+a.tagName.toLowerCase());for(var f=[],g=d(a),h=0;h<g.length;h++){var k=g[h];f.push([" ",k.name,'="',e(k.value),'"'])}f.sort();for(h=0;h<f.length;h++)for(g=f[h],k=0;k<g.length;k++)b.push(g[k]);if(a.hasChildNodes())for(b.push(">"),c.push("</"+a.tagName.toLowerCase()+">"),f=a.childNodes,h=f.length-1;0<=h;h--)c.push(f[h]);else b.push("/>")}else 3==
a.nodeType&&b.push(e(a.nodeValue));return b},scrapeText:function(a,b){var c=[];(function(a){var b=a.childNodes;if(b)for(var f=0;f<b.length;f++)arguments.callee.call(this,b[f]);b=a.nodeValue;"string"==typeof b&&c.push(b)})(MochiKit.DOM.getElement(a));return b?c:c.join("")},removeEmptyTextNodes:function(a){a=MochiKit.DOM.getElement(a);for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];3!=c.nodeType||/\S/.test(c.nodeValue)||c.parentNode.removeChild(c)}},getFirstElementByTagAndClassName:function(a,
b,c){var d=MochiKit.DOM;if("undefined"==typeof a||null===a)a="*";if("undefined"==typeof c||null===c)c=d._document;c=d.getElement(c);if(null==c)return null;a=c.getElementsByTagName(a)||d._document.all;if(0>=a.length)return null;if("undefined"==typeof b||null===b)return a[0];for(c=0;c<a.length;c++){var d=a[c],e=d.className;"string"!=typeof e&&(e=d.getAttribute("class"));if("string"==typeof e)for(var e=e.split(" "),f=0;f<e.length;f++)if(e[f]==b)return d}return null},getFirstParentByTagAndClassName:function(a,
b,c){var d=MochiKit.DOM;a=d.getElement(a);b="undefined"==typeof b||null===b?"*":b.toUpperCase();if("undefined"==typeof c||null===c)c=null;a&&(a=a.parentNode);for(;a&&a.tagName;){var e=a.tagName.toUpperCase();if(("*"===b||b==e)&&(null===c||d.hasElementClass(a,c)))return a;a=a.parentNode}return null},__new__:function(a){var b=MochiKit.Base;"undefined"!=typeof document?(this._document=document,MochiKit.DOM._xhtml=document.documentElement&&document.createElementNS&&"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"===
document.documentElement.namespaceURI):MochiKit.MockDOM&&(this._document=MochiKit.MockDOM.document);this._window=a;MochiKit.DOM.domConverters=new b.AdapterRegistry;a=this._document.createElement("span");var c;if(a&&a.attributes&&0<a.attributes.length){var d=b.filter;c=function(a){return d(c.ignoreAttrFilter,a.attributes)};c.ignoreAttr={};a=a.attributes;for(var e=c.ignoreAttr,f=0;f<a.length;f++){var g=a[f];e[g.name]=g.value}c.ignoreAttrFilter=function(a){return c.ignoreAttr[a.name]!=a.value};c.compliant=
!1;c.renames={"class":"className",checked:"defaultChecked",usemap:"useMap","for":"htmlFor",readonly:"readOnly",colspan:"colSpan",rowspan:"rowSpan",bgcolor:"bgColor",cellspacing:"cellSpacing",cellpadding:"cellPadding"}}else c=function(a){return a.attributes},c.compliant=!0,c.ignoreAttr={},c.renames={};c.__export__=!1;MochiKit.DOM.attributeArray=c;b._deprecated(this,"computedStyle","MochiKit.Style.getStyle","1.4",!0);b._deprecated(this,"elementDimensions","MochiKit.Style.getElementDimensions","1.4");
b._deprecated(this,"elementPosition","MochiKit.Style.getElementPosition","1.4");b._deprecated(this,"getViewportDimensions","MochiKit.Style.getViewportDimensions","1.4");b._deprecated(this,"hideElement","MochiKit.Style.hideElement","1.4");b._deprecated(this,"makeClipping","MochiKit.Style.makeClipping","1.4.1");b._deprecated(this,"makePositioned","MochiKit.Style.makePositioned","1.4.1");b._deprecated(this,"setElementDimensions","MochiKit.Style.setElementDimensions","1.4");b._deprecated(this,"setElementPosition",
"MochiKit.Style.setElementPosition","1.4");b._deprecated(this,"setDisplayForElement","MochiKit.Style.setDisplayForElement","1.4");b._deprecated(this,"setOpacity","MochiKit.Style.setOpacity","1.4");b._deprecated(this,"showElement","MochiKit.Style.showElement","1.4");b._deprecated(this,"undoClipping","MochiKit.Style.undoClipping","1.4.1");b._deprecated(this,"undoPositioned","MochiKit.Style.undoPositioned","1.4.1");b._deprecated(this,"Coordinates","MochiKit.Style.Coordinates","1.4");b._deprecated(this,
"Dimensions","MochiKit.Style.Dimensions","1.4");a=this.createDOMFunc;MochiKit.DOM.A=a("a");MochiKit.DOM.ARTICLE=a("article");MochiKit.DOM.ASIDE=a("aside");MochiKit.DOM.AUDIO=a("audio");MochiKit.DOM.BR=a("br");MochiKit.DOM.BUTTON=a("button");MochiKit.DOM.CANVAS=a("canvas");MochiKit.DOM.CAPTION=a("caption");MochiKit.DOM.CITE=a("cite");MochiKit.DOM.CODE=a("code");MochiKit.DOM.DD=a("dd");MochiKit.DOM.DEL=a("del");MochiKit.DOM.DFN=a("dfn");MochiKit.DOM.DIV=a("div");MochiKit.DOM.DL=a("dl");MochiKit.DOM.DT=
a("dt");MochiKit.DOM.EM=a("em");MochiKit.DOM.EMBED=a("embed");MochiKit.DOM.FIELDSET=a("fieldset");MochiKit.DOM.FIGURE=a("figure");MochiKit.DOM.FIGCAPTION=a("figcaption");MochiKit.DOM.FOOTER=a("footer");MochiKit.DOM.FORM=a("form");MochiKit.DOM.H1=a("h1");MochiKit.DOM.H2=a("h2");MochiKit.DOM.H3=a("h3");MochiKit.DOM.H4=a("h4");MochiKit.DOM.H5=a("h5");MochiKit.DOM.H6=a("h6");MochiKit.DOM.HEADER=a("header");MochiKit.DOM.HGROUP=a("hgroup");MochiKit.DOM.HR=a("hr");MochiKit.DOM.IFRAME=a("iframe");MochiKit.DOM.IMG=
a("img");MochiKit.DOM.INPUT=a("input");MochiKit.DOM.KBD=a("kbd");MochiKit.DOM.LABEL=a("label");MochiKit.DOM.LEGEND=a("legend");MochiKit.DOM.LI=a("li");MochiKit.DOM.LINK=a("link");MochiKit.DOM.MARK=a("mark");MochiKit.DOM.METER=a("meter");MochiKit.DOM.NAV=a("nav");MochiKit.DOM.OL=a("ol");MochiKit.DOM.OPTGROUP=a("optgroup");MochiKit.DOM.OPTION=a("option");MochiKit.DOM.P=a("p");MochiKit.DOM.PRE=a("pre");MochiKit.DOM.PROGRESS=a("progress");MochiKit.DOM.SAMP=a("samp");MochiKit.DOM.SCRIPT=a("script");MochiKit.DOM.SECTION=
a("section");MochiKit.DOM.SELECT=a("select");MochiKit.DOM.SOURCE=a("source");MochiKit.DOM.SPAN=a("span");MochiKit.DOM.STRONG=a("strong");MochiKit.DOM.STYLE=a("style");MochiKit.DOM.SUB=a("sub");MochiKit.DOM.SUP=a("sup");MochiKit.DOM.TABLE=a("table");MochiKit.DOM.TBODY=a("tbody");MochiKit.DOM.TD=a("td");MochiKit.DOM.TEXTAREA=a("textarea");MochiKit.DOM.TFOOT=a("tfoot");MochiKit.DOM.TH=a("th");MochiKit.DOM.THEAD=a("thead");MochiKit.DOM.TIME=a("time");MochiKit.DOM.TR=a("tr");MochiKit.DOM.TT=a("tt");MochiKit.DOM.UL=
a("ul");MochiKit.DOM.VAR=a("var");MochiKit.DOM.VIDEO=a("video");MochiKit.DOM.NBSP="\u00a0";MochiKit.DOM.$=this.getElement;b.nameFunctions(this)}});MochiKit.DOM.__new__("undefined"==typeof window?this:window);MochiKit.__export__&&(window.withWindow=MochiKit.DOM.withWindow,window.withDocument=MochiKit.DOM.withDocument);MochiKit.Base._exportSymbols(this,MochiKit.DOM);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Selector={});MochiKit.Base.module(MochiKit,"Selector","1.5",["Base","DOM","Iter"]);MochiKit.Selector.Selector=function(a){this.params={classNames:[],pseudoClassNames:[]};this.expression=a.toString().replace(/(^\s+|\s+$)/g,"");this.parseExpression();this.compileMatcher()};
MochiKit.Selector.Selector.prototype={__class__:MochiKit.Selector.Selector,parseExpression:function(){function a(a){throw"Parse error in selector: "+a;}""==this.expression&&a("empty expression");for(var b=MochiKit.Base.repr,c=this.params,d=this.expression,e,f,g;e=d.match(/^(.*)\[([a-z0-9_:-]+?)(?:([~\|!^$*]?=)(?:"([^"]*)"|([^\]\s]*)))?\]$/i);)c.attributes=c.attributes||[],c.attributes.push({name:e[2],operator:e[3],value:e[4]||e[5]||""}),d=e[1];if("*"==d)return this.params.wildcard=!0;for(;e=d.match(/^([^a-z0-9_-])?([a-z0-9_-]+(?:\([^)]*\))?)(.*)/i);){f=
e[1];g=e[2];e=e[3];switch(f){case "#":c.id=g;break;case ".":c.classNames.push(g);break;case ":":c.pseudoClassNames.push(g);break;case "":case void 0:c.tagName=g.toUpperCase();break;default:a(b(d))}d=e}0<d.length&&a(b(d))},buildMatchExpression:function(){function a(a){return"MochiKit.Base.filter(function (node) { return node.nodeType == 1; }, "+a+".childNodes)"}var b=MochiKit.Base.repr,c=this.params,d=[],e,f;c.wildcard&&d.push("true");(e=c.id)&&d.push("element.id == "+b(e));(e=c.tagName)&&d.push("element.tagName.toUpperCase() == "+
b(e));if(0<(e=c.classNames).length)for(f=0;f<e.length;f++)d.push("MochiKit.DOM.hasElementClass(element, "+b(e[f])+")");if(0<(e=c.pseudoClassNames).length)for(f=0;f<e.length;f++){var g=e[f].match(/^([^(]+)(?:\((.*)\))?$/),h=g[1],k=g[2];switch(h){case "root":d.push("element.nodeType == 9 || element === element.ownerDocument.documentElement");break;case "nth-child":case "nth-last-child":case "nth-of-type":case "nth-last-of-type":g=k.match(/^((?:(\d+)n\+)?(\d+)|odd|even)$/);if(!g)throw"Invalid argument to pseudo element nth-child: "+
k;"odd"==g[0]?(k=2,g=1):"even"==g[0]?(k=2,g=0):(k=g[2]&&parseInt(g,10)||null,g=parseInt(g[3],10));d.push("this.nthChild(element,"+k+","+g+","+!!h.match("^nth-last")+","+!!h.match("of-type$")+")");break;case "first-child":d.push("this.nthChild(element, null, 1)");break;case "last-child":d.push("this.nthChild(element, null, 1, true)");break;case "first-of-type":d.push("this.nthChild(element, null, 1, false, true)");break;case "last-of-type":d.push("this.nthChild(element, null, 1, true, true)");break;
case "only-child":d.push(a("element.parentNode")+".length == 1");break;case "only-of-type":d.push("MochiKit.Base.filter(function (node) { return node.tagName == element.tagName; }, "+a("element.parentNode")+").length == 1");break;case "empty":d.push("element.childNodes.length == 0");break;case "enabled":d.push("(this.isUIElement(element) && element.disabled === false)");break;case "disabled":d.push("(this.isUIElement(element) && element.disabled === true)");break;case "checked":d.push("(this.isUIElement(element) && element.checked === true)");
break;case "not":h=new MochiKit.Selector.Selector(k),d.push("!( "+h.buildMatchExpression()+")")}}(e=c.attributes)&&MochiKit.Base.map(function(a){var c="MochiKit.DOM.getNodeAttribute(element, "+b(a.name)+")";d.push(c+" != null");switch(a.operator){case "=":d.push(c+" == "+b(a.value));break;case "~=":d.push("MochiKit.Base.findValue("+(c+".split("+b(" ")+")")+", "+b(a.value)+") > -1");break;case "^=":d.push(c+".substring(0, "+a.value.length+") == "+b(a.value));break;case "$=":d.push(c+".substring("+
c+".length - "+a.value.length+") == "+b(a.value));break;case "*=":d.push(c+".match("+b(a.value)+")");break;case "|=":d.push(c+".split("+b("-")+")[0].toUpperCase() == "+b(a.value.toUpperCase()));break;case "!=":d.push(c+" != "+b(a.value));break;case "":case void 0:break;default:throw"Unknown operator "+a.operator+" in selector";}},e);return d.join(" && ")},compileMatcher:function(){var a="return (!element.tagName) ? false : "+this.buildMatchExpression()+";";this.match=new Function("element",a)},nthChild:function(a,
b,c,d,e){var f=MochiKit.Base.filter(function(a){return 1==a.nodeType},a.parentNode.childNodes);e&&(f=MochiKit.Base.filter(function(b){return b.tagName==a.tagName},f));d&&(f=MochiKit.Iter.reversed(f));return b?0==(MochiKit.Base.findIdentical(f,a)+1-c)/b%1:c==MochiKit.Base.findIdentical(f,a)+1},isUIElement:function(a){return-1<MochiKit.Base.findValue("input button select option textarea object".split(" "),a.tagName.toLowerCase())},findElements:function(a,b){function c(a,c){if(""==b)return MochiKit.DOM.isChildNode(a,
c);if(">"==b)return a.parentNode===c;if("+"==b)return a===d(c);if("~"==b){for(var e=c;e=d(e);)if(a===e)return!0;return!1}throw"Invalid axis: "+b;}function d(a){for(a=a.nextSibling;a&&1!=a.nodeType;)a=a.nextSibling;return a}var e;void 0==b&&(b="");if((e=MochiKit.DOM.getElement(this.params.id))&&this.match(e)&&(!a||c(e,a)))return[e];if(""==b)a=(a||MochiKit.DOM.currentDocument()).getElementsByTagName(this.params.tagName||"*");else if(">"==b){if(!a)throw"> combinator not allowed without preceeding expression";
a=MochiKit.Base.filter(function(a){return 1==a.nodeType},a.childNodes)}else if("+"==b){if(!a)throw"+ combinator not allowed without preceeding expression";a=d(a)&&[d(a)]}else if("~"==b){if(!a)throw"~ combinator not allowed without preceeding expression";for(e=[];d(a);)a=d(a),e.push(a);a=e}return a?MochiKit.Base.filter(MochiKit.Base.bind(function(a){return this.match(a)},this),a):[]},repr:function(){return"Selector("+this.expression+")"},toString:MochiKit.Base.forwardCall("repr")};
MochiKit.Base.update(MochiKit.Selector,{findChildElements:function(a,b){a=MochiKit.DOM.getElement(a);var c=function(a){for(var b=[],c=0;c<a.length;c++)0>MochiKit.Base.findIdentical(b,a[c])&&b.push(a[c]);return b};return MochiKit.Base.flattenArray(MochiKit.Base.map(function(b){try{var e=a.querySelectorAll(b);return Array.prototype.slice.call(e,0)}catch(f){}var g="";b=b.replace(/(^\s+|\s+$)/g,"").split(/\s+/);return c(MochiKit.Iter.reduce(function(b,c){var d=c.match(/^[>+~]$/);if(d)return g=d[0],b;
var e=new MochiKit.Selector.Selector(c),d=MochiKit.Iter.reduce(function(b,c){return MochiKit.Base.extend(b,e.findElements(c||a,g))},b,[]);g="";return d},b,[null]))},b))},findDocElements:function(){return MochiKit.Selector.findChildElements(MochiKit.DOM.currentDocument(),arguments)},__new__:function(){this.$$=this.findDocElements;MochiKit.Base.nameFunctions(this)}});MochiKit.Selector.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Selector);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Style={});MochiKit.Base.module(MochiKit,"Style","1.5",["Base","DOM"]);MochiKit.Style.Dimensions=function(a,b){if(!(this instanceof MochiKit.Style.Dimensions))return new MochiKit.Style.Dimensions(a,b);this.w=a;this.h=b};MochiKit.Style.Dimensions.prototype.__repr__=function(){var a=MochiKit.Base.repr;return"{w: "+a(this.w)+", h: "+a(this.h)+"}"};MochiKit.Style.Dimensions.prototype.toString=function(){return this.__repr__()};
MochiKit.Style.Coordinates=function(a,b){if(!(this instanceof MochiKit.Style.Coordinates))return new MochiKit.Style.Coordinates(a,b);this.x=a;this.y=b};MochiKit.Style.Coordinates.prototype.__repr__=function(){var a=MochiKit.Base.repr;return"{x: "+a(this.x)+", y: "+a(this.y)+"}"};MochiKit.Style.Coordinates.prototype.toString=function(){return this.__repr__()};
MochiKit.Base.update(MochiKit.Style,{getStyle:function(a,b){var c=MochiKit.DOM,d=c._document;a=c.getElement(a);b=MochiKit.Base.camelize(b);if(a&&a!=d){if("opacity"==b&&"undefined"!=typeof a.filters)return(c=(MochiKit.Style.getStyle(a,"filter")||"").match(/alpha\(opacity=(.*)\)/))&&c[1]?parseFloat(c[1])/100:1;if("float"==b||"cssFloat"==b||"styleFloat"==b)return a.style["float"]?a.style["float"]:a.style.cssFloat?a.style.cssFloat:a.style.styleFloat?a.style.styleFloat:"none";c=a.style?a.style[b]:null;
if(!c)if(d.defaultView&&d.defaultView.getComputedStyle)c=d.defaultView.getComputedStyle(a,null),b=b.replace(/([A-Z])/g,"-$1").toLowerCase(),c=c?c.getPropertyValue(b):null;else if(a.currentStyle&&(c=a.currentStyle[b],/^\d/.test(c)&&!/px$/.test(c)&&"fontWeight"!=b)){var d=a.style.left,e=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=c||0;c=a.style.pixelLeft+"px";a.style.left=d;a.runtimeStyle.left=e}"opacity"==b&&(c=parseFloat(c));/Opera/.test(navigator.userAgent)&&-1!=MochiKit.Base.findValue(["left",
"top","right","bottom"],b)&&"static"==MochiKit.Style.getStyle(a,"position")&&(c="auto");return"auto"==c?null:c}},setStyle:function(a,b){a=MochiKit.DOM.getElement(a);for(var c in b)switch(c){case "opacity":MochiKit.Style.setOpacity(a,b[c]);break;case "float":case "cssFloat":case "styleFloat":"undefined"!=typeof a.style["float"]?a.style["float"]=b[c]:"undefined"!=typeof a.style.cssFloat?a.style.cssFloat=b[c]:a.style.styleFloat=b[c];break;default:a.style[MochiKit.Base.camelize(c)]=b[c]}},setOpacity:function(a,
b){a=MochiKit.DOM.getElement(a);var c=MochiKit.Style;if(1==b){var d=/Gecko/.test(navigator.userAgent)&&!/Konqueror|AppleWebKit|KHTML/.test(navigator.userAgent);a.style.opacity=d?0.999999:1;/MSIE/.test(navigator.userAgent)&&(a.style.filter=c.getStyle(a,"filter").replace(/alpha\([^\)]*\)/gi,""))}else 1E-5>b&&(b=0),a.style.opacity=b,/MSIE/.test(navigator.userAgent)&&(a.style.filter=c.getStyle(a,"filter").replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+100*b+")")},getElementPosition:function(a,b){var c=
MochiKit.Style,d=MochiKit.DOM,e=function(a){return null!=a&&null==a.nodeType&&"number"==typeof a.x&&"number"==typeof a.y};"string"==typeof a&&(a=d.getElement(a));if(null!=a&&(e(a)||"none"!=c.getStyle(a,"display"))){var d=new c.Coordinates(0,0),f=null,g=null,h=MochiKit.DOM._document,g=h.documentElement,h=h.body;if(e(a))d.x+=a.x||0,d.y+=a.y||0;else if(a.getBoundingClientRect)f=a.getBoundingClientRect(),d.x+=f.left+(g.scrollLeft||h.scrollLeft)-(g.clientLeft||0),d.y+=f.top+(g.scrollTop||h.scrollTop)-
(g.clientTop||0);else if(a.offsetParent){d.x+=a.offsetLeft;d.y+=a.offsetTop;g=a.offsetParent;if(g!=a)for(;g;)d.x+=parseInt(g.style.borderLeftWidth,10)||0,d.y+=parseInt(g.style.borderTopWidth,10)||0,d.x+=g.offsetLeft,d.y+=g.offsetTop,g=g.offsetParent;e=navigator.userAgent.toLowerCase();if("undefined"!=typeof opera&&9>parseFloat(opera.version())||-1!=e.indexOf("AppleWebKit")&&"absolute"==c.getStyle(a,"position"))d.x-=h.offsetLeft,d.y-=h.offsetTop;for(g=a.parentNode?a.parentNode:null;g;){e=g.tagName.toUpperCase();
if("BODY"===e||"HTML"===e)break;c.getStyle(g,"display").search(/^inline|table-row.*$/i)&&(d.x-=g.scrollLeft,d.y-=g.scrollTop);g=g.parentNode?g.parentNode:null}}b&&(b=arguments.callee(b))&&(d.x-=b.x||0,d.y-=b.y||0);return d}},setElementPosition:function(a,b,c){a=MochiKit.DOM.getElement(a);"undefined"==typeof c&&(c="px");var d={},e=MochiKit.Base.isUndefinedOrNull;e(b.x)||(d.left=b.x+c);e(b.y)||(d.top=b.y+c);MochiKit.DOM.updateNodeAttributes(a,{style:d})},makePositioned:function(a){a=MochiKit.DOM.getElement(a);
var b=MochiKit.Style.getStyle(a,"position");"static"!=b&&b||(a.style.position="relative",/Opera/.test(navigator.userAgent)&&(a.style.top=0,a.style.left=0))},undoPositioned:function(a){a=MochiKit.DOM.getElement(a);"relative"==a.style.position&&(a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right="")},makeClipping:function(a){a=MochiKit.DOM.getElement(a);var b=a.style,b={overflow:b.overflow,"overflow-x":b.overflowX,"overflow-y":b.overflowY};"hidden"!=(MochiKit.Style.getStyle(a,"overflow")||
"visible")&&(a.style.overflow="hidden",a.style.overflowX="hidden",a.style.overflowY="hidden");return b},undoClipping:function(a,b){a=MochiKit.DOM.getElement(a);"string"==typeof b?a.style.overflow=b:null!=b&&(a.style.overflow=b.overflow,a.style.overflowX=b["overflow-x"],a.style.overflowY=b["overflow-y"])},getElementDimensions:function(a,b){var c=MochiKit.Style,d=MochiKit.DOM;if("number"==typeof a.w||"number"==typeof a.h)return new c.Dimensions(a.w||0,a.h||0);if(a=d.getElement(a)){d=c.getStyle(a,"display");
if("none"==d||""==d||"undefined"==typeof d){var e=a.style,f=e.visibility,g=e.position,h=e.display;e.visibility="hidden";e.position="absolute";e.display=c._getDefaultDisplay(a);var d=a.offsetWidth,k=a.offsetHeight;e.display=h;e.position=g;e.visibility=f}else d=a.offsetWidth||0,k=a.offsetHeight||0;b&&((f=(e="colSpan"in a&&"rowSpan"in a)&&a.parentNode&&"collapse"==c.getStyle(a.parentNode,"borderCollapse"))?/MSIE/.test(navigator.userAgent)?(g=a.previousSibling?0.5:1,h=a.nextSibling?0.5:1):h=g=0.5:h=g=
1,d-=Math.round((parseFloat(c.getStyle(a,"paddingLeft"))||0)+(parseFloat(c.getStyle(a,"paddingRight"))||0)+g*(parseFloat(c.getStyle(a,"borderLeftWidth"))||0)+h*(parseFloat(c.getStyle(a,"borderRightWidth"))||0)),e=e?/Gecko|Opera/.test(navigator.userAgent)&&!/Konqueror|AppleWebKit|KHTML/.test(navigator.userAgent)?0:/MSIE/.test(navigator.userAgent)?1:f?0.5:1:1,k-=Math.round((parseFloat(c.getStyle(a,"paddingTop"))||0)+(parseFloat(c.getStyle(a,"paddingBottom"))||0)+e*((parseFloat(c.getStyle(a,"borderTopWidth"))||
0)+(parseFloat(c.getStyle(a,"borderBottomWidth"))||0))));return new c.Dimensions(d,k)}},setElementDimensions:function(a,b,c){a=MochiKit.DOM.getElement(a);"undefined"==typeof c&&(c="px");var d={},e=MochiKit.Base.isUndefinedOrNull;e(b.w)||(d.width=b.w+c);e(b.h)||(d.height=b.h+c);MochiKit.DOM.updateNodeAttributes(a,{style:d})},_getDefaultDisplay:function(a){var b=MochiKit.Style;if(a=MochiKit.DOM.getElement(a))return a=a.tagName.toUpperCase(),b._defaultDisplay[a]||"block"},setDisplayForElement:function(a,
b,c){for(var d=MochiKit.Base.extend(null,arguments,1),e=MochiKit.DOM.getElement,f=0;f<d.length;f++)if(b=e(d[f]))b.style.display=a},getViewportDimensions:function(){var a=new MochiKit.Style.Dimensions,b=MochiKit.DOM._window,c=MochiKit.DOM._document.body;b.innerWidth?(a.w=b.innerWidth,a.h=b.innerHeight):c&&c.parentElement&&c.parentElement.clientWidth?(a.w=c.parentElement.clientWidth,a.h=c.parentElement.clientHeight):c&&c.clientWidth&&(a.w=c.clientWidth,a.h=c.clientHeight);return a},getViewportPosition:function(){var a=
new MochiKit.Style.Coordinates(0,0),b=MochiKit.DOM._document,c=b.documentElement,b=b.body;c&&(c.scrollTop||c.scrollLeft)?(a.x=c.scrollLeft,a.y=c.scrollTop):b&&(a.x=b.scrollLeft,a.y=b.scrollTop);return a},__new__:function(){var a=MochiKit.Base,b="A ABBR ACRONYM B BASEFONT BDO BIG BR CITE CODE DFN EM FONT I IMG KBD LABEL Q S SAMP SMALL SPAN STRIKE STRONG SUB SUP TEXTAREA TT U VAR".split(" ");this._defaultDisplay={TABLE:"table",THEAD:"table-header-group",TBODY:"table-row-group",TFOOT:"table-footer-group",
COLGROUP:"table-column-group",COL:"table-column",TR:"table-row",TD:"table-cell",TH:"table-cell",CAPTION:"table-caption",LI:"list-item",INPUT:"inline-block",SELECT:"inline-block"};if(/MSIE/.test(navigator.userAgent))for(var c in this._defaultDisplay)0==this._defaultDisplay[c].indexOf("table")&&(this._defaultDisplay[c]="block");for(c=0;c<b.length;c++)this._defaultDisplay[b[c]]="inline";a._deprecated(this,"elementPosition","MochiKit.Style.getElementPosition","1.3",!0);a._deprecated(this,"elementDimensions",
"MochiKit.Style.getElementDimensions","1.3",!0);MochiKit.Style.hideElement=a.partial(MochiKit.Style.setDisplayForElement,"none");MochiKit.Style.showElement=a.partial(MochiKit.Style.setDisplayForElement,"block");a.nameFunctions(this)}});MochiKit.Style.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Style);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.LoggingPane={});MochiKit.Base.module(MochiKit,"LoggingPane","1.5",["Base","Logging"]);MochiKit.LoggingPane.createLoggingPane=function(a){var b=MochiKit.LoggingPane;a=!!a;b._loggingPane&&b._loggingPane.inline!=a&&(b._loggingPane.closePane(),b._loggingPane=null);if(!b._loggingPane||b._loggingPane.closed)b._loggingPane=new b.LoggingPane(a,MochiKit.Logging.logger);return b._loggingPane};
MochiKit.LoggingPane.LoggingPane=function(a,b){if("undefined"==typeof b||null===b)b=MochiKit.Logging.logger;this.logger=b;var c=MochiKit.Base.updatetree,d=MochiKit.Base.bind,e=MochiKit.Base.clone,f=window;"undefined"!=typeof MochiKit.DOM&&(f=MochiKit.DOM.currentWindow());if(!a){var g="_MochiKit_LoggingPane_"+f.location.href.split("?")[0].replace(/[#:\/.><&%-]/g,"_"),g=f.open("",g,"dependent,resizable,height=200");if(!g){alert("Not able to open debugging window due to pop-up blocking.");return}g.document.write('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>[MochiKit.LoggingPane]</title></head><body></body></html>');
g.document.close();g.document.title+=" "+f.document.title;f=g}var h=f.document;this.doc=h;var k=h.getElementById("_MochiKit_LoggingPane"),g=!!k;if(k&&"undefined"!=typeof k.loggingPane)return k.loggingPane.logger=this.logger,k.loggingPane.buildAndApplyFilter(),k.loggingPane;if(g)for(var l;l=k.firstChild;)k.removeChild(l);else k=h.createElement("div"),k.id="_MochiKit_LoggingPane";k.loggingPane=this;var m=h.createElement("input"),p=h.createElement("input");l=h.createElement("button");var q=h.createElement("button"),
n=h.createElement("button"),r=h.createElement("button"),s=h.createElement("div"),u=h.createElement("div");this.colorTable=e(this.colorTable);var v=[],w=null,x=function(a){a=a.level;"number"==typeof a&&(a=MochiKit.Logging.LogLevel[a]);return a},y=d(function(a){var b=x(a);a=a.info.join(" ");var c=this.colorTable[b],d=h.createElement("span");d.className="MochiKit-LogMessage MochiKit-LogLevel-"+b;d.style.cssText="margin: 0px; white-space: -moz-pre-wrap; white-space: -o-pre-wrap; white-space: pre-wrap; white-space: pre-line; word-wrap: break-word; wrap-option: emergency; color: "+
c;d.appendChild(h.createTextNode(b+": "+a));u.appendChild(d);u.appendChild(h.createElement("br"));s.scrollTop=s.offsetHeight>s.scrollHeight?0:s.scrollHeight},this),D=function(a){v[v.length]=a;y(a)},E=function(){var a,b;try{a=RegExp(m.value),b=RegExp(p.value)}catch(c){return MochiKit.Logging.logDebug("Error in filter regex: "+c.message),null}return function(c){return a.test(x(c))&&b.test(c.info.join(" "))}},z=function(){for(;u.firstChild;)u.removeChild(u.firstChild)},e=d(function(){if(!this.closed){this.closed=
!0;MochiKit.LoggingPane._loggingPane==this&&(MochiKit.LoggingPane._loggingPane=null);this.logger.removeListener("_MochiKit_LoggingPane_Listener");try{try{k.loggingPane=null}catch(b){MochiKit.Logging.logFatal("Bookmarklet was closed incorrectly.")}a?k.parentNode.removeChild(k):this.win.close()}catch(c){}}},this),A=function(){z();for(var a=0;a<v.length;a++){var b=v[a];(null===w||w(b))&&y(b)}};this.buildAndApplyFilter=function(){w=E();A();this.logger.removeListener("_MochiKit_LoggingPane_Listener");
this.logger.addListener("_MochiKit_LoggingPane_Listener",w,D)};var B=d(function(){v=this.logger.getMessages();A()},this),C=d(function(a){a=a||window.event;13==(a.which||a.keyCode)&&this.buildAndApplyFilter()},this),t="display: block; z-index: 1000; left: 0px; bottom: 0px; position: fixed; width: 100%; background-color: white; font: "+this.logFont;k.style.cssText=a?t+"; height: 10em; border-top: 2px solid black":t+"; height: 100%;";g||h.body.appendChild(k);t={cssText:"width: 33%; display: inline; font: "+
this.logFont};c(m,{value:"FATAL|ERROR|WARNING|INFO|DEBUG",onkeypress:C,style:t});k.appendChild(m);c(p,{value:".*",onkeypress:C,style:t});k.appendChild(p);t="width: 8%; display:inline; font: "+this.logFont;l.appendChild(h.createTextNode("Filter"));l.onclick=d("buildAndApplyFilter",this);l.style.cssText=t;k.appendChild(l);q.appendChild(h.createTextNode("Load"));q.onclick=B;q.style.cssText=t;k.appendChild(q);n.appendChild(h.createTextNode("Clear"));n.onclick=function(){v=[];z()};n.style.cssText=t;k.appendChild(n);
r.appendChild(h.createTextNode("Close"));r.onclick=e;r.style.cssText=t;k.appendChild(r);s.style.cssText="overflow: auto; width: 100%";u.style.cssText="width: 100%; height: "+(a?"8em":"100%");s.appendChild(u);k.appendChild(s);this.buildAndApplyFilter();B();this.win=a?void 0:f;this.inline=a;this.closePane=e;this.closed=!1;return this};MochiKit.LoggingPane.LoggingPane.prototype={logFont:"8pt Verdana,sans-serif",colorTable:{ERROR:"red",FATAL:"darkred",WARNING:"blue",INFO:"black",DEBUG:"green"}};
MochiKit.LoggingPane.__new__=function(){MochiKit.Base.nameFunctions(this);MochiKit.LoggingPane._loggingPane=null};MochiKit.LoggingPane.__new__();MochiKit.Base._exportSymbols(this,MochiKit.LoggingPane);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Color={});MochiKit.Base.module(MochiKit,"Color","1.5",["Base","DOM","Style"]);MochiKit.Color.Color=function(a,b,c,d){if("undefined"==typeof d||null===d)d=1;this.rgb={r:a,g:b,b:c,a:d}};
MochiKit.Color.Color.prototype={__class__:MochiKit.Color.Color,colorWithAlpha:function(a){var b=this.rgb;return MochiKit.Color.Color.fromRGB(b.r,b.g,b.b,a)},colorWithHue:function(a){var b=this.asHSL();b.h=a;return MochiKit.Color.Color.fromHSL(b)},colorWithSaturation:function(a){var b=this.asHSL();b.s=a;return MochiKit.Color.Color.fromHSL(b)},colorWithLightness:function(a){var b=this.asHSL();b.l=a;return MochiKit.Color.Color.fromHSL(b)},darkerColorWithLevel:function(a){var b=this.asHSL();b.l=Math.max(b.l-
a,0);return MochiKit.Color.Color.fromHSL(b)},lighterColorWithLevel:function(a){var b=this.asHSL();b.l=Math.min(b.l+a,1);return MochiKit.Color.Color.fromHSL(b)},blendedColor:function(a,b){if("undefined"==typeof b||null===b)b=0.5;var c=1-b,d=this.rgb,e=a.rgb,f=b;return MochiKit.Color.Color.fromRGB(d.r*c+e.r*f,d.g*c+e.g*f,d.b*c+e.b*f,d.a*c+e.a*f)},compareRGB:function(a){var b=this.asRGB();a=a.asRGB();return MochiKit.Base.compare([b.r,b.g,b.b,b.a],[a.r,a.g,a.b,a.a])},isLight:function(){return 0.5<this.asHSL().l},
isDark:function(){return!this.isLight()},toHSLString:function(){var a=this.asHSL(),b=MochiKit.Color.clampColorComponent,c=this._hslString;c||(b=b(a.h,360).toFixed(0)+","+b(a.s,100).toPrecision(4)+"%,"+b(a.l,100).toPrecision(4)+"%",a=a.a,1<=a?c="hsl("+b+")":(0>=a&&(a=0),c="hsla("+b+","+a+")"),this._hslString=c);return c},toRGBString:function(){var a=this.rgb,b=MochiKit.Color.clampColorComponent,c=this._rgbString;c||(b=b(a.r,255).toFixed(0)+","+b(a.g,255).toFixed(0)+","+b(a.b,255).toFixed(0),this._rgbString=
c=1!=a.a?"rgba("+b+","+a.a+")":"rgb("+b+")");return c},asRGB:function(){return MochiKit.Base.clone(this.rgb)},toHexString:function(){var a=MochiKit.Color,b=this.rgb,c=MochiKit.Color.clampColorComponent,d=this._hexString;d||(this._hexString=d="#"+a.toColorPart(c(b.r,255))+a.toColorPart(c(b.g,255))+a.toColorPart(c(b.b,255)));return d},asHSV:function(){var a=this.hsv;if("undefined"==typeof a||null===a)this.hsv=a=MochiKit.Color.rgbToHSV(this.rgb);return MochiKit.Base.clone(a)},asHSL:function(){var a=
this.hsl;if("undefined"==typeof a||null===a)this.hsl=a=MochiKit.Color.rgbToHSL(this.rgb);return MochiKit.Base.clone(a)},toString:function(){return this.toRGBString()},repr:function(){var a=this.rgb;return this.__class__.NAME+"("+[a.r,a.g,a.b,a.a].join(", ")+")"}};
MochiKit.Base.update(MochiKit.Color.Color,{fromRGB:function(a,b,c,d){var e=MochiKit.Color.Color;if(1==arguments.length){var f=a;a=f.r;b=f.g;c=f.b;d="undefined"==typeof f.a?void 0:f.a}return new e(a,b,c,d)},fromHSL:function(a,b,c,d){var e=MochiKit.Color;return e.Color.fromRGB(e.hslToRGB.apply(e,arguments))},fromHSV:function(a,b,c,d){var e=MochiKit.Color;return e.Color.fromRGB(e.hsvToRGB.apply(e,arguments))},fromName:function(a){var b=MochiKit.Color.Color;'"'==a.charAt(0)&&(a=a.substr(1,a.length-2));
var c=b._namedColors[a.toLowerCase()];return"string"==typeof c?b.fromHexString(c):"transparent"==a?b.transparentColor():null},fromString:function(a){var b=MochiKit.Color.Color,c=a.substr(0,3);return"rgb"==c?b.fromRGBString(a):"hsl"==c?b.fromHSLString(a):"#"==a.charAt(0)?b.fromHexString(a):b.fromName(a)},fromHexString:function(a){"#"==a.charAt(0)&&(a=a.substring(1));var b=[],c,d;if(3==a.length)for(c=0;3>c;c++)d=a.substr(c,1),b.push(parseInt(d+d,16)/255);else for(c=0;6>c;c+=2)d=a.substr(c,2),b.push(parseInt(d,
16)/255);a=MochiKit.Color.Color;return a.fromRGB.apply(a,b)},_fromColorString:function(a,b,c,d){0===d.indexOf(a)&&(d=d.substring(d.indexOf("(",3)+1,d.length-1));a=d.split(/\s*,\s*/);d=[];for(var e=0;e<a.length;e++){var f=a[e],g=f.substring(f.length-3),f="%"==f.charAt(f.length-1)?0.01*parseFloat(f.substring(0,f.length-1)):"deg"==g?parseFloat(f)/360:"rad"==g?parseFloat(f)/(2*Math.PI):c[e]*parseFloat(f);d.push(f)}return this[b].apply(this,d)},fromComputedStyle:function(a,b){var c=MochiKit.DOM,d=MochiKit.Color.Color;
for(a=c.getElement(a);a;a=a.parentNode){var e=MochiKit.Style.getStyle.apply(c,arguments);if(e){e=d.fromString(e);if(!e)break;if(0<e.asRGB().a)return e}}return null},fromBackground:function(a){var b=MochiKit.Color.Color;return b.fromComputedStyle(a,"backgroundColor","background-color")||b.whiteColor()},fromText:function(a){var b=MochiKit.Color.Color;return b.fromComputedStyle(a,"color","color")||b.blackColor()},namedColors:function(){return MochiKit.Base.clone(MochiKit.Color.Color._namedColors)}});
MochiKit.Base.update(MochiKit.Color,{clampColorComponent:function(a,b){a*=b;return 0>a?0:a>b?b:a},_hslValue:function(a,b,c){6<c?c-=6:0>c&&(c+=6);return 1>c?a+(b-a)*c:3>c?b:4>c?a+(b-a)*(4-c):a},hsvToRGB:function(a,b,c,d){if(1==arguments.length){var e=a;a=e.h;b=e.s;c=e.v;d=e.a}var f,g,h;if(0===b)h=g=f=c;else{var e=Math.floor(6*a),k=6*a-e,l=c*(1-b),m=c*(1-b*k),k=c*(1-b*(1-k));switch(e){case 1:f=m;g=c;h=l;break;case 2:f=l;g=c;h=k;break;case 3:f=l;g=m;h=c;break;case 4:f=k;g=l;h=c;break;case 5:f=c;g=l;
h=m;break;case 6:case 0:f=c,g=k,h=l}}return{r:f,g:g,b:h,a:d}},hslToRGB:function(a,b,c,d){if(1==arguments.length){var e=a;a=e.h;b=e.s;c=e.l;d=e.a}var f,g;if(0===b)g=f=e=c;else{g=0.5>=c?c*(1+b):c+b-c*b;var h=2*c-g,k=MochiKit.Color._hslValue,l=6*a,e=k(h,g,l+2);f=k(h,g,l);g=k(h,g,l-2)}return{r:e,g:f,b:g,a:d}},rgbToHSV:function(a,b,c,d){if(1==arguments.length){var e=a;a=e.r;b=e.g;c=e.b;d=e.a}var e=Math.max(Math.max(a,b),c),f=Math.min(Math.min(a,b),c),g;f==e?f=g=0:(g=e-f,f=g/e,g=(a==e?(b-c)/g:b==e?2+(c-
a)/g:4+(a-b)/g)/6,0>g&&(g+=1),1<g&&(g-=1));return{h:g,s:f,v:e,a:d}},rgbToHSL:function(a,b,c,d){if(1==arguments.length){var e=a;a=e.r;b=e.g;c=e.b;d=e.a}var f=Math.max(a,Math.max(b,c)),g=Math.min(a,Math.min(b,c)),e=(f+g)/2,h=f-g;0===h?g=f=0:(g=0.5>=e?h/(f+g):h/(2-f-g),f=(a==f?(b-c)/h:b==f?2+(c-a)/h:4+(a-b)/h)/6,0>f&&(f+=1),1<f&&(f-=1));return{h:f,s:g,l:e,a:d}},toColorPart:function(a){a=Math.round(a);var b=a.toString(16);return 16>a?"0"+b:b},__new__:function(){var a=MochiKit.Base;this.Color.fromRGBString=
a.bind(this.Color._fromColorString,this.Color,"rgb","fromRGB",[1/255,1/255,1/255,1]);this.Color.fromHSLString=a.bind(this.Color._fromColorString,this.Color,"hsl","fromHSL",[1/360,0.01,0.01,1]);var b=1/3,b={black:[0,0,0],blue:[0,0,1],brown:[0.6,0.4,0.2],cyan:[0,1,1],darkGray:[b,b,b],gray:[0.5,0.5,0.5],green:[0,1,0],lightGray:[2*b,2*b,2*b],magenta:[1,0,1],orange:[1,0.5,0],purple:[0.5,0,0.5],red:[1,0,0],transparent:[0,0,0,0],white:[1,1,1],yellow:[1,1,0]},c;for(c in b){var d=c+"Color",e=this.Color.fromRGB.apply(this.Color,
b[c]);this.Color[d]=a.partial(a.operator.identity,e)}a.nameFunctions(this);a.registerComparator(this.Color.NAME,function(){for(var a=0;a<arguments.length;a++)if(!(arguments[a]instanceof MochiKit.Color.Color))return!1;return!0},function(a,b){return a.compareRGB(b)})}});MochiKit.Color.__new__();
MochiKit.Color.Color._namedColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",
darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",
gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",
lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",
mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",
seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};MochiKit.Base._exportSymbols(this,MochiKit.Color);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Signal={});MochiKit.Base.module(MochiKit,"Signal","1.5",["Base","DOM"]);MochiKit.Signal._observers=[];MochiKit.Signal.Event=function(a,b){this._event=b||window.event;this._src=a};MochiKit.Signal.Event.__export__=!1;
MochiKit.Signal.Event.prototype.__repr__=function(){var a=MochiKit.Base.repr,b="{event(): "+a(this.event())+", src(): "+a(this.src())+", type(): "+a(this.type())+", target(): "+a(this.target());if(this.type()&&0===this.type().indexOf("key")||0===this.type().indexOf("mouse")||-1!=this.type().indexOf("click")||"contextmenu"==this.type())b+=", modifier(): {alt: "+a(this.modifier().alt)+", ctrl: "+a(this.modifier().ctrl)+", meta: "+a(this.modifier().meta)+", shift: "+a(this.modifier().shift)+", any: "+
a(this.modifier().any)+"}";this.type()&&0===this.type().indexOf("key")&&(b+=", key(): {code: "+a(this.key().code)+", string: "+a(this.key().string)+"}");!this.type()||0!==this.type().indexOf("mouse")&&-1==this.type().indexOf("click")&&"contextmenu"!=this.type()||(b+=", mouse(): {page: "+a(this.mouse().page)+", client: "+a(this.mouse().client),"mousemove"!=this.type()&&"mousewheel"!=this.type()&&(b+=", button: {left: "+a(this.mouse().button.left)+", middle: "+a(this.mouse().button.middle)+", right: "+
a(this.mouse().button.right)+"}"),"mousewheel"==this.type()&&(b+=", wheel: "+a(this.mouse().wheel)),b+="}");if("mouseover"==this.type()||"mouseout"==this.type()||"mouseenter"==this.type()||"mouseleave"==this.type())b+=", relatedTarget(): "+a(this.relatedTarget());return b+"}"};MochiKit.Signal.Event.prototype.toString=function(){return this.__repr__()};MochiKit.Signal.Event.prototype.src=function(){return this._src};MochiKit.Signal.Event.prototype.event=function(){return this._event};
MochiKit.Signal.Event.prototype.type=function(){return"DOMMouseScroll"===this._event.type?"mousewheel":this._event.type||void 0};MochiKit.Signal.Event.prototype.target=function(){return this._event.target||this._event.srcElement};MochiKit.Signal.Event.prototype._relatedTarget=null;
MochiKit.Signal.Event.prototype.relatedTarget=function(){if(null!==this._relatedTarget)return this._relatedTarget;var a=null;if("mouseover"==this.type()||"mouseenter"==this.type())a=this._event.relatedTarget||this._event.fromElement;else if("mouseout"==this.type()||"mouseleave"==this.type())a=this._event.relatedTarget||this._event.toElement;try{if(null!==a&&null!==a.nodeType)return this._relatedTarget=a}catch(b){}};MochiKit.Signal.Event.prototype._modifier=null;
MochiKit.Signal.Event.prototype.modifier=function(){if(null!==this._modifier)return this._modifier;var a={};a.alt=this._event.altKey;a.ctrl=this._event.ctrlKey;a.meta=this._event.metaKey||!1;a.shift=this._event.shiftKey;a.any=a.alt||a.ctrl||a.shift||a.meta;return this._modifier=a};MochiKit.Signal.Event.prototype._key=null;
MochiKit.Signal.Event.prototype.key=function(){if(null!==this._key)return this._key;var a={};if(this.type()&&0===this.type().indexOf("key")){if("keydown"==this.type()||"keyup"==this.type())return a.code=this._event.keyCode,a.string=MochiKit.Signal._specialKeys[a.code]||"KEY_UNKNOWN",this._key=a;if("keypress"==this.type())return a.code=0,a.string="","undefined"==typeof this._event.charCode||0===this._event.charCode||MochiKit.Signal._specialMacKeys[this._event.charCode]?this._event.keyCode&&"undefined"==
typeof this._event.charCode&&(a.code=this._event.keyCode,a.string=String.fromCharCode(a.code)):(a.code=this._event.charCode,a.string=String.fromCharCode(a.code)),this._key=a}};MochiKit.Signal.Event.prototype._mouse=null;
MochiKit.Signal.Event.prototype.mouse=function(){if(null!==this._mouse)return this._mouse;var a={},b=this._event;if(this.type()&&(0===this.type().indexOf("mouse")||0===this.type().indexOf("drag")||-1!=this.type().indexOf("click")||"contextmenu"==this.type())){a.client={x:0,y:0};if(b.clientX||b.clientY)a.client.x=!b.clientX||0>b.clientX?0:b.clientX,a.client.y=!b.clientY||0>b.clientY?0:b.clientY;a.page={x:0,y:0};if(b.pageX||b.pageY)a.page.x=!b.pageX||0>b.pageX?0:b.pageX,a.page.y=!b.pageY||0>b.pageY?
0:b.pageY;else{var c=MochiKit.DOM._document.documentElement,d=MochiKit.DOM._document.body;a.page.x=b.clientX+(c.scrollLeft||d.scrollLeft)-(c.clientLeft||0);a.page.y=b.clientY+(c.scrollTop||d.scrollTop)-(c.clientTop||0)}"mousemove"!=this.type()&&"mousewheel"!=this.type()&&(a.button={},a.button.left=!1,a.button.right=!1,a.button.middle=!1,b.which?(a.button.left=1==b.which,a.button.middle=2==b.which,a.button.right=3==b.which):(a.button.left=!!(b.button&1),a.button.right=!!(b.button&2),a.button.middle=
!!(b.button&4)));"mousewheel"==this.type()&&(a.wheel={x:0,y:0},b.wheelDeltaX||b.wheelDeltaY?(a.wheel.x=b.wheelDeltaX/-40||0,a.wheel.y=b.wheelDeltaY/-40||0):a.wheel.y=b.wheelDelta?b.wheelDelta/-40:b.detail||0);return this._mouse=a}};MochiKit.Signal.Event.prototype.stop=function(){this.stopPropagation();this.preventDefault()};MochiKit.Signal.Event.prototype.stopPropagation=function(){this._event.stopPropagation?this._event.stopPropagation():this._event.cancelBubble=!0};
MochiKit.Signal.Event.prototype.preventDefault=function(){this._event.preventDefault?this._event.preventDefault():null===this._confirmUnload&&(this._event.returnValue=!1)};MochiKit.Signal.Event.prototype._confirmUnload=null;MochiKit.Signal.Event.prototype.confirmUnload=function(a){"beforeunload"==this.type()&&(this._confirmUnload=a,this._event.returnValue=a)};
MochiKit.Signal._specialMacKeys={3:"KEY_ENTER",63289:"KEY_NUM_PAD_CLEAR",63276:"KEY_PAGE_UP",63277:"KEY_PAGE_DOWN",63275:"KEY_END",63273:"KEY_HOME",63234:"KEY_ARROW_LEFT",63232:"KEY_ARROW_UP",63235:"KEY_ARROW_RIGHT",63233:"KEY_ARROW_DOWN",63302:"KEY_INSERT",63272:"KEY_DELETE"};(function(){for(var a=MochiKit.Signal._specialMacKeys,b=63236;63242>=b;b++)a[b]="KEY_F"+(b-63236+1)})();
MochiKit.Signal._specialKeys={8:"KEY_BACKSPACE",9:"KEY_TAB",12:"KEY_NUM_PAD_CLEAR",13:"KEY_ENTER",16:"KEY_SHIFT",17:"KEY_CTRL",18:"KEY_ALT",19:"KEY_PAUSE",20:"KEY_CAPS_LOCK",27:"KEY_ESCAPE",32:"KEY_SPACEBAR",33:"KEY_PAGE_UP",34:"KEY_PAGE_DOWN",35:"KEY_END",36:"KEY_HOME",37:"KEY_ARROW_LEFT",38:"KEY_ARROW_UP",39:"KEY_ARROW_RIGHT",40:"KEY_ARROW_DOWN",44:"KEY_PRINT_SCREEN",45:"KEY_INSERT",46:"KEY_DELETE",59:"KEY_SEMICOLON",91:"KEY_WINDOWS_LEFT",92:"KEY_WINDOWS_RIGHT",93:"KEY_SELECT",106:"KEY_NUM_PAD_ASTERISK",
107:"KEY_NUM_PAD_PLUS_SIGN",109:"KEY_NUM_PAD_HYPHEN-MINUS",110:"KEY_NUM_PAD_FULL_STOP",111:"KEY_NUM_PAD_SOLIDUS",144:"KEY_NUM_LOCK",145:"KEY_SCROLL_LOCK",186:"KEY_SEMICOLON",187:"KEY_EQUALS_SIGN",188:"KEY_COMMA",189:"KEY_HYPHEN-MINUS",190:"KEY_FULL_STOP",191:"KEY_SOLIDUS",192:"KEY_GRAVE_ACCENT",219:"KEY_LEFT_SQUARE_BRACKET",220:"KEY_REVERSE_SOLIDUS",221:"KEY_RIGHT_SQUARE_BRACKET",222:"KEY_APOSTROPHE"};
(function(){for(var a=MochiKit.Signal._specialKeys,b=48;57>=b;b++)a[b]="KEY_"+(b-48);for(b=65;90>=b;b++)a[b]="KEY_"+String.fromCharCode(b);for(b=96;105>=b;b++)a[b]="KEY_NUM_PAD_"+(b-96);for(b=112;123>=b;b++)a[b]="KEY_F"+(b-112+1)})();MochiKit.Signal.Ident=function(a){this.source=a.source;this.signal=a.signal;this.listener=a.listener;this.isDOM=a.isDOM;this.objOrFunc=a.objOrFunc;this.funcOrStr=a.funcOrStr;this.connected=a.connected;this.namespace=a.namespace};MochiKit.Signal.Ident.__export__=!1;
MochiKit.Signal.Ident.prototype={};MochiKit.Signal.Ident.prototype.__repr__=function(){var a=MochiKit.Base.repr;return"src:"+a(this.source)+", sig: "+a(this.signal)+", isDOM: "+a(this.isDOM)+", connected: "+a(this.connected)};
MochiKit.Base.update(MochiKit.Signal,{_unloadCache:function(){for(var a=MochiKit.Signal,b=a._observers,c=0;c<b.length;c++)"onload"!==b[c].signal&&"onunload"!==b[c].signal&&a._disconnect(b[c])},_listener:function(a,b,c,d,e){var f=MochiKit.Signal.Event;if(!e)return"undefined"==typeof c.im_self?MochiKit.Base.bindLate(c,d):c;d=d||a;return"string"==typeof c?"onload"===b||"onunload"===b?function(e){d[c].apply(d,[new f(a,e)]);e=new MochiKit.Signal.Ident({source:a,signal:b,objOrFunc:d,funcOrStr:c});MochiKit.Signal._disconnect(e)}:
function(b){d[c].apply(d,[new f(a,b)])}:"onload"===b||"onunload"===b?function(e){c.apply(d,[new f(a,e)]);e=new MochiKit.Signal.Ident({source:a,signal:b,objOrFunc:c});MochiKit.Signal._disconnect(e)}:function(b){c.apply(d,[new f(a,b)])}},_browserAlreadyHasMouseEnterAndLeave:function(){return/MSIE/.test(navigator.userAgent)},_browserLacksMouseWheelEvent:function(){return/Gecko\//.test(navigator.userAgent)},_mouseEnterListener:function(a,b,c,d){var e=MochiKit.Signal.Event;return function(f){f=new e(a,
f);try{f.relatedTarget().nodeName}catch(g){return}f.stop();if(!MochiKit.DOM.isChildNode(f.relatedTarget(),a))return f.type=function(){return b},"string"==typeof c?d[c].apply(d,[f]):c.apply(d,[f])}},_getDestPair:function(a,b){var c=null,d=null;if("undefined"!=typeof b)if(c=a,d=b,"string"==typeof b){if("function"!=typeof a[b])throw Error("'funcOrStr' must be a function on 'objOrFunc'");}else{if("function"!=typeof b)throw Error("'funcOrStr' must be a function or string");}else{if("function"!=typeof a)throw Error("'objOrFunc' must be a function if 'funcOrStr' is not given");
d=a}return[c,d]},connect:function(a,b,c,d,e){"string"==typeof a&&(a=MochiKit.DOM.getElement(a));var f=MochiKit.Signal;if("string"!=typeof b)throw Error("'sig' must be a string");var g=b.split(".");2<=g.length&&(b=g[0]);var h=f._getDestPair(c,d),k=h[0],l=h[1];if("undefined"==typeof k||null===k)k=a;h=!(!a.addEventListener&&!a.attachEvent);!h||"onmouseenter"!==b&&"onmouseleave"!==b||f._browserAlreadyHasMouseEnterAndLeave()?h&&"onmousewheel"==b&&f._browserLacksMouseWheelEvent()?(k=f._listener(a,b,l,k,
h),b="onDOMMouseScroll"):k=f._listener(a,b,l,k,h):(k=f._mouseEnterListener(a,b.substr(2),l,k),b="onmouseenter"===b?"onmouseover":"onmouseout");a.addEventListener?a.addEventListener(b.substr(2),k,!1):a.attachEvent&&a.attachEvent(b,k);g=new MochiKit.Signal.Ident({source:a,signal:b,listener:k,isDOM:h,objOrFunc:c,funcOrStr:d,connected:!0,namespace:g[1]||""});f._observers.push(g);h||"function"!=typeof a.__connect__||(f=MochiKit.Base.extend([g],arguments,1),a.__connect__.apply(a,f));return g},connectOnce:function(a,
b,c,d){var e=MochiKit.Signal,f=e.connect(a,b,c,d),g;g=e.connect(a,b,function(){e.disconnect(f);e.disconnect(g)});return f},_disconnect:function(a){if(a.connected){a.connected=!1;var b=a.source,c=a.signal,d=a.listener;if(a.isDOM)if(b.removeEventListener)b.removeEventListener(c.substr(2),d,!1);else if(b.detachEvent)b.detachEvent(c,d);else throw Error("'src' must be a DOM element");else"function"==typeof b.__disconnect__&&b.__disconnect__(a,c,a.objOrFunc,a.funcOrStr)}},disconnect:function(a){var b=MochiKit.Signal,
c=b._observers,d=MochiKit.Base;if(1<arguments.length){d=arguments[0];"string"==typeof d&&(d=MochiKit.DOM.getElement(d));for(var e=arguments[1],f=arguments[2],g=arguments[3],h=c.length-1;0<=h;h--){var k=c[h];if(k.source===d&&k.signal===e&&k.objOrFunc===f&&k.funcOrStr===g)return b._disconnect(k),0===b._lock?c.splice(h,1):b._dirty=!0,!0}}else if(d=d.findIdentical(c,a),0<=d)return b._disconnect(a),0===b._lock?c.splice(d,1):b._dirty=!0,!0;return!1},disconnectAllTo:function(a,b){var c=MochiKit.Signal,d=
c._observers,e=c._disconnect,f=c._lock,g=c._dirty;"undefined"===typeof b&&(b=null);for(var h=d.length-1;0<=h;h--){var k=d[h];k.objOrFunc!==a||null!==b&&k.funcOrStr!==b||(e(k),0===f?d.splice(h,1):g=!0)}c._dirty=g},disconnectAll:function(a,b){"string"==typeof a&&(a=MochiKit.DOM.getElement(a));var c=MochiKit.Base,d=c.flattenArguments(c.extend(null,arguments,1)),c=MochiKit.Signal,e=c._disconnect,f=c._observers,g,h=c._lock,k=c._dirty;if(0===d.length)for(g=f.length-1;0<=g;g--)d=f[g],d.source===a&&(e(d),
0===h?f.splice(g,1):k=!0);else{var l={};for(g=0;g<d.length;g++)l[d[g]]=!0;for(g=f.length-1;0<=g;g--)d=f[g],d.source===a&&d.signal in l&&(e(d),0===h?f.splice(g,1):k=!0)}c._dirty=k},disconnectNS:function(a){var b=MochiKit.Signal,c=a.split(".");if(2!=c.length)throw Error("No namespace found in 'sigAndOrNS'");a=c[0];for(var c=c[1],d=0,e=b._observers,f=e.length-1;0<=f;f--){var g=e[f];g.namespace==c&&(""!=a&&g.signal==a||""==a)&&(b._disconnect(g),0===b._lock?e.splice(f,1):b._dirty=!0,d+=1)}return d},signal:function(a,
b,c){var d=MochiKit.Signal,e=d._observers;"string"==typeof a&&(a=MochiKit.DOM.getElement(a));var f=MochiKit.Base.extend(null,arguments,2),g=[];d._lock++;for(var h=0;h<e.length;h++){var k=e[h];if(k.source===a&&k.signal===b&&k.connected)try{if(k.isDOM&&null!=k.funcOrStr){var l=k.objOrFunc;l[k.funcOrStr].apply(l,f)}else k.isDOM?k.objOrFunc.apply(a,f):k.listener.apply(a,f)}catch(m){g.push(m)}}d._lock--;d._gc();if(1==g.length)throw g[0];if(1<g.length)throw d=Error("Multiple errors thrown in handling 'sig', see errors property"),
d.errors=g,d;},_gc:function(){var a=MochiKit.Signal,b=a._observers;if(0===a._lock&&a._dirty){for(var c=b.length-1;0<=c;c--)b[c].connected||b.splice(c,1);a._dirty=!1;return!0}return!1}});MochiKit.Signal.disconnectAllFromTo=function(a,b){for(var c=MochiKit.Signal,d=c._observers,e=c._disconnect,f=c._lock,g=c._dirty,h=d.length-1;0<=h;h--){var k=d[h];k.objOrFunc===b&&k.source==a&&(e(k),0===f?d.splice(h,1):g=!0)}c._dirty=g};MochiKit.Signal.close=function(a){MochiKit.Signal.disconnectAll(a);MochiKit.Signal.disconnectAllTo(a)};
MochiKit.Signal._pubsub_topics={};MochiKit.Signal.publish=function(a,b){MochiKit.Signal.signal.apply(MochiKit.Signal,MochiKit.Base.extend([MochiKit.Signal._pubsub_topics,a],arguments,1))};MochiKit.Signal.subscribe=function(a,b,c){return MochiKit.Signal.connect(MochiKit.Signal._pubsub_topics,a,b,c)};MochiKit.Signal.unsubscribe=function(a){MochiKit.Signal.disconnect(a)};
MochiKit.Signal.__new__=function(a){var b=MochiKit.Base;this._document=document;this._window=a;MochiKit.Signal._lock=0;this._dirty=!1;try{this.connect(window,"onunload",this._unloadCache)}catch(c){}b.nameFunctions(this)};MochiKit.Signal.__new__(this);MochiKit.__export__&&(window.connect=MochiKit.Signal.connect,window.disconnect=MochiKit.Signal.disconnect,window.disconnectAll=MochiKit.Signal.disconnectAll,window.signal=MochiKit.Signal.signal);MochiKit.Base._exportSymbols(this,MochiKit.Signal);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Position={});MochiKit.Base.module(MochiKit,"Position","1.5",["Base","DOM","Style"]);
MochiKit.Base.update(MochiKit.Position,{__export__:!1,includeScrollOffsets:!1,prepare:function(){this.windowOffset=new MochiKit.Style.Coordinates(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0)},cumulativeOffset:function(a){var b=0,c=0;do b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;while(a);return new MochiKit.Style.Coordinates(c,b)},realOffset:function(a){var b=0,c=0;
do b+=a.scrollTop||0,c+=a.scrollLeft||0,a=a.parentNode;while(a);return new MochiKit.Style.Coordinates(c,b)},within:function(a,b,c){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(a,b,c);this.xcomp=b;this.ycomp=c;this.offset=this.cumulativeOffset(a);"fixed"==a.style.position&&(this.offset.x+=this.windowOffset.x,this.offset.y+=this.windowOffset.y);return c>=this.offset.y&&c<this.offset.y+a.offsetHeight&&b>=this.offset.x&&b<this.offset.x+a.offsetWidth},withinIncludingScrolloffsets:function(a,
b,c){var d=this.realOffset(a);this.xcomp=b+d.x-this.windowOffset.x;this.ycomp=c+d.y-this.windowOffset.y;this.offset=this.cumulativeOffset(a);return this.ycomp>=this.offset.y&&this.ycomp<this.offset.y+a.offsetHeight&&this.xcomp>=this.offset.x&&this.xcomp<this.offset.x+a.offsetWidth},overlap:function(a,b){if(!a)return 0;if("vertical"==a)return(this.offset.y+b.offsetHeight-this.ycomp)/b.offsetHeight;if("horizontal"==a)return(this.offset.x+b.offsetWidth-this.xcomp)/b.offsetWidth},absolutize:function(a){a=
MochiKit.DOM.getElement(a);if("absolute"!=a.style.position){MochiKit.Position.prepare();var b=MochiKit.Position.positionedOffset(a),c=a.clientWidth,d=a.clientHeight,e={position:a.style.position,left:b.x-parseFloat(a.style.left||0),top:b.y-parseFloat(a.style.top||0),width:a.style.width,height:a.style.height};a.style.position="absolute";a.style.top=b.y+"px";a.style.left=b.x+"px";a.style.width=c+"px";a.style.height=d+"px";return e}},positionedOffset:function(a){var b=0,c=0;do if(b+=a.offsetTop||0,c+=
a.offsetLeft||0,a=a.offsetParent){var d=MochiKit.Style.getStyle(a,"position");if("relative"==d||"absolute"==d)break}while(a);return new MochiKit.Style.Coordinates(c,b)},relativize:function(a,b){a=MochiKit.DOM.getElement(a);if("relative"!=a.style.position){MochiKit.Position.prepare();var c=parseFloat(a.style.top||0)-(b.top||0),d=parseFloat(a.style.left||0)-(b.left||0);a.style.position=b.position;a.style.top=c+"px";a.style.left=d+"px";a.style.width=b.width;a.style.height=b.height}},clone:function(a,
b){a=MochiKit.DOM.getElement(a);b=MochiKit.DOM.getElement(b);b.style.position="absolute";var c=this.cumulativeOffset(a);b.style.top=c.y+"px";b.style.left=c.x+"px";b.style.width=a.offsetWidth+"px";b.style.height=a.offsetHeight+"px"},page:function(a){var b=0,c=0,d=a;do if(b+=d.offsetTop||0,c+=d.offsetLeft||0,d.offsetParent==document.body&&"absolute"==MochiKit.Style.getStyle(d,"position"))break;while(d=d.offsetParent);d=a;do b-=d.scrollTop||0,c-=d.scrollLeft||0;while(d=d.parentNode);return new MochiKit.Style.Coordinates(c,
b)}});MochiKit.Position.__new__=function(a){MochiKit.Base.nameFunctions(this)};MochiKit.Position.__new__(this);MochiKit.Base._exportSymbols(this,MochiKit.Position);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Visual={});MochiKit.Base.module(MochiKit,"Visual","1.5",["Base","DOM","Style","Color","Position"]);
MochiKit.Visual._RoundCorners=function(a,b){a=MochiKit.DOM.getElement(a);this._setOptions(b);this.options.__unstable__wrapElement&&(a=this._doWrap(a));var c=this.options.color,d=MochiKit.Color.Color;"fromElement"===this.options.color?c=d.fromBackground(a):c instanceof d||(c=d.fromString(c));this.isTransparent=0>=c.asRGB().a;var e=this.options.bgColor;"fromParent"===this.options.bgColor?e=d.fromBackground(a.offsetParent):e instanceof d||(e=d.fromString(e));this._roundCornersImpl(a,c,e)};
MochiKit.Visual._RoundCorners.prototype={_doWrap:function(a){var b=MochiKit.DOM.currentDocument();if("undefined"===typeof b.defaultView||null===b.defaultView)return a;b=b.defaultView.getComputedStyle(a,null);if("undefined"===typeof b||null===b)return a;b=MochiKit.DOM.DIV({style:{display:"block",marginTop:b.getPropertyValue("padding-top"),marginRight:b.getPropertyValue("padding-right"),marginBottom:b.getPropertyValue("padding-bottom"),marginLeft:b.getPropertyValue("padding-left"),padding:"0px"}});
b.innerHTML=a.innerHTML;a.innerHTML="";a.appendChild(b);return a},_roundCornersImpl:function(a,b,c){this.options.border&&this._renderBorder(a,c);this._isTopRounded()&&this._roundTopCorners(a,b,c);this._isBottomRounded()&&this._roundBottomCorners(a,b,c)},_renderBorder:function(a,b){var c="1px solid "+this._borderColor(b);a.innerHTML="<div "+("style='border-left: "+c+";"+("border-right: "+c)+"'")+">"+a.innerHTML+"</div>"},_roundTopCorners:function(a,b,c){for(var d=this._createCorner(c),e=0;e<this.options.numSlices;e++)d.appendChild(this._createCornerSlice(b,
c,e,"top"));a.style.paddingTop=0;a.insertBefore(d,a.firstChild)},_roundBottomCorners:function(a,b,c){for(var d=this._createCorner(c),e=this.options.numSlices-1;0<=e;e--)d.appendChild(this._createCornerSlice(b,c,e,"bottom"));a.style.paddingBottom=0;a.appendChild(d)},_createCorner:function(a){return MochiKit.DOM.DIV({style:{backgroundColor:a.toString()}})},_createCornerSlice:function(a,b,c,d){var e=MochiKit.DOM.SPAN(),f=e.style;f.backgroundColor=a.toString();f.display="block";f.height="1px";f.overflow=
"hidden";f.fontSize="1px";a=this._borderColor(a,b);this.options.border&&0===c?(f.borderTopStyle="solid",f.borderTopWidth="1px",f.borderLeftWidth="0px",f.borderRightWidth="0px",f.borderBottomWidth="0px",f.height="0px",f.borderColor=a.toString()):a&&(f.borderColor=a.toString(),f.borderStyle="solid",f.borderWidth="0px 1px");this.options.compact||c!=this.options.numSlices-1||(f.height="2px");this._setMargin(e,c,d);this._setBorder(e,c,d);return e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",
bgColor:"fromParent",blend:!0,border:!1,compact:!1,__unstable__wrapElement:!1};MochiKit.Base.update(this.options,a);this.options.numSlices=this.options.compact?2:4},_whichSideTop:function(){var a=this.options.corners;if(this._hasString(a,"all","top"))return"";var b=-1!=a.indexOf("tl"),a=-1!=a.indexOf("tr");return b&&a?"":b?"left":a?"right":""},_whichSideBottom:function(){var a=this.options.corners;if(this._hasString(a,"all","bottom"))return"";var b=-1!=a.indexOf("bl"),a=-1!=a.indexOf("br");return b&&
a?"":b?"left":a?"right":""},_borderColor:function(a,b){return"transparent"==a?b:this.options.border?this.options.border:this.options.blend?b.blendedColor(a):""},_setMargin:function(a,b,c){b=this._marginSize(b)+"px";c="top"==c?this._whichSideTop():this._whichSideBottom();a=a.style;"left"==c?(a.marginLeft=b,a.marginRight="0px"):"right"==c?(a.marginRight=b,a.marginLeft="0px"):(a.marginLeft=b,a.marginRight=b)},_setBorder:function(a,b,c){b=this._borderSize(b)+"px";c="top"==c?this._whichSideTop():this._whichSideBottom();
a=a.style;"left"==c?(a.borderLeftWidth=b,a.borderRightWidth="0px"):"right"==c?(a.borderRightWidth=b,a.borderLeftWidth="0px"):(a.borderLeftWidth=b,a.borderRightWidth=b)},_marginSize:function(a){if(this.isTransparent)return 0;var b=this.options;return b.compact&&b.blend?[1,0][a]:b.compact?[2,1][a]:b.blend?[3,2,1,0][a]:[5,3,2,1][a]},_borderSize:function(a){var b=this.options;if(b.compact&&(b.blend||this.isTransparent))return 1;if(b.compact)b=[1,0];else if(b.blend)b=[2,1,1,1];else if(b.border)b=[0,2,
0,0];else if(this.isTransparent)b=[5,3,2,1];else return 0;return b[a]},_hasString:function(a){for(var b=1;b<arguments.length;b++)if(-1!=a.indexOf(arguments[b]))return!0;return!1},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return 1==a.childNodes.length&&3==a.childNodes[0].nodeType}};
MochiKit.Visual.roundElement=function(a,b){new MochiKit.Visual._RoundCorners(a,b)};MochiKit.Visual.roundClass=function(a,b,c){a=MochiKit.DOM.getElementsByTagAndClassName(a,b);for(b=0;b<a.length;b++)MochiKit.Visual.roundElement(a[b],c)};
MochiKit.Visual.tagifyText=function(a,b){b=b||"position:relative";/MSIE/.test(navigator.userAgent)&&(b+=";zoom:1");a=MochiKit.DOM.getElement(a);var c=MochiKit.Base.map;c(function(d){3==d.nodeType&&(c(function(c){a.insertBefore(MochiKit.DOM.SPAN({style:b}," "==c?String.fromCharCode(160):c),d)},d.nodeValue.split("")),MochiKit.DOM.removeElement(d))},a.childNodes)};MochiKit.Visual._forceRerendering=function(a){try{a=MochiKit.DOM.getElement(a);var b=document.createTextNode(" ");a.appendChild(b);a.removeChild(b)}catch(c){}};
MochiKit.Visual.multiple=function(a,b,c){c=MochiKit.Base.update({speed:0.1,delay:0},c);var d=c.delay,e=0;MochiKit.Base.map(function(a){c.delay=e*c.speed+d;new b(a,c);e+=1},a)};MochiKit.Visual.PAIRS={slide:["slideDown","slideUp"],blind:["blindDown","blindUp"],appear:["appear","fade"],size:["grow","shrink"]};
MochiKit.Visual.toggle=function(a,b,c){a=MochiKit.DOM.getElement(a);b=(b||"appear").toLowerCase();c=MochiKit.Base.update({queue:{position:"end",scope:a.id||"global",limit:1}},c);var d=MochiKit.Visual;d["none"!=MochiKit.Style.getStyle(a,"display")?d.PAIRS[b][1]:d.PAIRS[b][0]](a,c)};MochiKit.Visual.Transitions={__export__:!1};MochiKit.Visual.Transitions.linear=function(a){return a};MochiKit.Visual.Transitions.sinoidal=function(a){return 0.5-Math.cos(a*Math.PI)/2};
MochiKit.Visual.Transitions.reverse=function(a){return 1-a};MochiKit.Visual.Transitions.flicker=function(a){return 0.25-Math.cos(a*Math.PI)/4+Math.random()/2};MochiKit.Visual.Transitions.wobble=function(a){return 0.5-Math.cos(9*a*Math.PI)/2};MochiKit.Visual.Transitions.pulse=function(a,b){a=b?a*2*b:10*a;var c=a-Math.floor(a);return 0==Math.floor(a)%2?c:1-c};MochiKit.Visual.Transitions.parabolic=function(a){return a*a};
MochiKit.Visual.Transitions.spring=function(a){return 1-Math.cos(2.5*a*Math.PI)*Math.exp(6*-a)};MochiKit.Visual.Transitions.none=function(a){return 0};MochiKit.Visual.Transitions.full=function(a){return 1};MochiKit.Visual.ScopedQueue=function(){var a=arguments.callee;if(!(this instanceof a))return new a;this.__init__()};MochiKit.Visual.ScopedQueue.__export__=!1;
MochiKit.Base.update(MochiKit.Visual.ScopedQueue.prototype,{__init__:function(){this.effects=[];this.interval=null},add:function(a){var b=(new Date).getTime(),c=MochiKit.Base.map;switch("string"==typeof a.options.queue?a.options.queue:a.options.queue.position){case "front":c(function(b){"idle"==b.state&&(b.startOn+=a.finishOn,b.finishOn+=a.finishOn)},this.effects);break;case "end":var d;c(function(a){a=a.finishOn;a>=(d||a)&&(d=a)},this.effects);b=d||b;break;case "break":c(function(a){a.finalize()},
this.effects);break;case "replace":c(function(a){a.cancel()},this.effects)}a.startOn+=b;a.finishOn+=b;(!a.options.queue.limit||this.effects.length<a.options.queue.limit)&&this.effects.push(a);this.interval||(this.interval=this.startLoop(MochiKit.Base.bind(this.loop,this),40))},startLoop:function(a,b){return setInterval(a,b)},remove:function(a){this.effects=MochiKit.Base.filter(function(b){return b!=a},this.effects);this.effects.length||(this.stopLoop(this.interval),this.interval=null)},stopLoop:function(a){clearInterval(a)},
loop:function(){var a=(new Date).getTime();MochiKit.Base.map(function(b){b.loop(a)},this.effects)}});MochiKit.Visual.Queues={__export__:!1,instances:{},get:function(a){if("string"!=typeof a)return a;this.instances[a]||(this.instances[a]=new MochiKit.Visual.ScopedQueue);return this.instances[a]}};MochiKit.Visual.Queue=MochiKit.Visual.Queues.get("global");MochiKit.Visual.Queue.__export__=!1;
MochiKit.Visual.DefaultOptions={__export__:!1,transition:MochiKit.Visual.Transitions.sinoidal,duration:1,fps:25,sync:!1,from:0,to:1,delay:0,queue:"parallel"};MochiKit.Visual.Base=function(){};
MochiKit.Visual.Base.prototype={__class__:MochiKit.Visual.Base,start:function(a){var b=MochiKit.Visual;this.options=MochiKit.Base.setdefault(a,b.DefaultOptions);this.currentFrame=0;this.state="idle";this.startOn=1E3*this.options.delay;this.finishOn=this.startOn+1E3*this.options.duration;this.event("beforeStart");this.options.sync||b.Queues.get("string"==typeof this.options.queue?"global":this.options.queue.scope).add(this)},loop:function(a){if(a>=this.startOn){if(a>=this.finishOn)return this.finalize();
a=(a-this.startOn)/(this.finishOn-this.startOn);var b=Math.round(a*this.options.fps*this.options.duration);b>this.currentFrame&&(this.render(a),this.currentFrame=b)}},render:function(a){"idle"==this.state&&(this.state="running",this.event("beforeSetup"),this.setup(),this.event("afterSetup"));if("running"==this.state){var b=this.options.transition;"string"==typeof b&&(b=MochiKit.Visual.Transitions[b]);"function"==typeof b&&(a=b(a));a*=this.options.to-this.options.from;a+=this.options.from;this.event("beforeUpdate");
this.update(a);this.event("afterUpdate")}},cancel:function(){this.options.sync||MochiKit.Visual.Queues.get("string"==typeof this.options.queue?"global":this.options.queue.scope).remove(this);this.state="finished"},finalize:function(){this.render(1);this.cancel();this.event("beforeFinish");this.finish();this.event("afterFinish")},setup:function(){},finish:function(){},update:function(a){},event:function(a){if(this.options[a+"Internal"])this.options[a+"Internal"](this);if(this.options[a])this.options[a](this)},
repr:function(){return"["+this.__class__.NAME+", options:"+MochiKit.Base.repr(this.options)+"]"}};MochiKit.Visual.Parallel=function(a,b){var c=arguments.callee;if(!(this instanceof c))return new c(a,b);this.__init__(a,b)};MochiKit.Visual.Parallel.prototype=new MochiKit.Visual.Base;
MochiKit.Base.update(MochiKit.Visual.Parallel.prototype,{__class__:MochiKit.Visual.Parallel,__init__:function(a,b){this.effects=a||[];this.start(b)},update:function(a){MochiKit.Base.map(function(b){b.render(a)},this.effects)},finish:function(){MochiKit.Base.map(function(a){a.finalize()},this.effects)}});MochiKit.Visual.Sequence=function(a,b){var c=arguments.callee;if(!(this instanceof c))return new c(a,b);this.__init__(a,b)};MochiKit.Visual.Sequence.prototype=new MochiKit.Visual.Base;
MochiKit.Base.update(MochiKit.Visual.Sequence.prototype,{__class__:MochiKit.Visual.Sequence,__init__:function(a,b){var c={transition:MochiKit.Visual.Transitions.linear,duration:0};this.effects=a||[];MochiKit.Base.map(function(a){c.duration+=a.options.duration},this.effects);MochiKit.Base.setdefault(b,c);this.start(b)},update:function(a){a*=this.options.duration;for(var b=0;b<this.effects.length;b++){var c=this.effects[b];if(a<=c.options.duration){c.render(a/c.options.duration);break}else a-=c.options.duration}},
finish:function(){MochiKit.Base.map(function(a){a.finalize()},this.effects)}});MochiKit.Visual.Opacity=function(a,b){var c=arguments.callee;if(!(this instanceof c))return new c(a,b);this.__init__(a,b)};MochiKit.Visual.Opacity.prototype=new MochiKit.Visual.Base;
MochiKit.Base.update(MochiKit.Visual.Opacity.prototype,{__class__:MochiKit.Visual.Opacity,__init__:function(a,b){var c=MochiKit.Base,d=MochiKit.Style;this.element=MochiKit.DOM.getElement(a);this.element.currentStyle&&!this.element.currentStyle.hasLayout&&d.setStyle(this.element,{zoom:1});b=c.update({from:d.getStyle(this.element,"opacity")||0,to:1},b);this.start(b)},update:function(a){MochiKit.Style.setStyle(this.element,{opacity:a})}});
MochiKit.Visual.Move=function(a,b){var c=arguments.callee;if(!(this instanceof c))return new c(a,b);this.__init__(a,b)};MochiKit.Visual.Move.prototype=new MochiKit.Visual.Base;
MochiKit.Base.update(MochiKit.Visual.Move.prototype,{__class__:MochiKit.Visual.Move,__init__:function(a,b){this.element=MochiKit.DOM.getElement(a);b=MochiKit.Base.update({x:0,y:0,mode:"relative"},b);this.start(b)},setup:function(){MochiKit.Style.makePositioned(this.element);var a=this.element.style,b=a.visibility,c=a.display;"none"==c&&(a.visibility="hidden",a.display="");this.originalLeft=parseFloat(MochiKit.Style.getStyle(this.element,"left")||"0");this.originalTop=parseFloat(MochiKit.Style.getStyle(this.element,
"top")||"0");"absolute"==this.options.mode&&(this.options.x-=this.originalLeft,this.options.y-=this.originalTop);"none"==c&&(a.visibility=b,a.display=c)},update:function(a){MochiKit.Style.setStyle(this.element,{left:Math.round(this.options.x*a+this.originalLeft)+"px",top:Math.round(this.options.y*a+this.originalTop)+"px"})}});MochiKit.Visual.Scale=function(a,b,c){var d=arguments.callee;if(!(this instanceof d))return new d(a,b,c);this.__init__(a,b,c)};MochiKit.Visual.Scale.prototype=new MochiKit.Visual.Base;
MochiKit.Base.update(MochiKit.Visual.Scale.prototype,{__class__:MochiKit.Visual.Scale,__init__:function(a,b,c){this.element=MochiKit.DOM.getElement(a);c=MochiKit.Base.update({scaleX:!0,scaleY:!0,scaleContent:!0,scaleFromCenter:!1,scaleMode:"box",scaleFrom:100,scaleTo:b},c);this.start(c)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||!1;this.elementPositioning=MochiKit.Style.getStyle(this.element,"position");var a=MochiKit.Base.map,b=MochiKit.Base.bind;this.originalStyle=
{};a(b(function(a){this.originalStyle[a]=this.element.style[a]},this),["top","left","width","height","fontSize"]);this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var c=MochiKit.Style.getStyle(this.element,"font-size")||"100%";a(b(function(a){0<c.indexOf(a)&&(this.fontSize=parseFloat(c),this.fontSizeType=a)},this),["em","px","%"]);this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;/^content/.test(this.options.scaleMode)?this.dims=[this.element.scrollHeight,
this.element.scrollWidth]:this.dims="box"==this.options.scaleMode?[this.element.offsetHeight,this.element.offsetWidth]:[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]},update:function(a){a=this.options.scaleFrom/100+this.factor*a;this.options.scaleContent&&this.fontSize&&MochiKit.Style.setStyle(this.element,{fontSize:this.fontSize*a+this.fontSizeType});this.setDimensions(this.dims[0]*a,this.dims[1]*a)},finish:function(){this.restoreAfterFinish&&MochiKit.Style.setStyle(this.element,
this.originalStyle)},setDimensions:function(a,b){var c={},d=Math.round;/MSIE/.test(navigator.userAgent)&&(d=Math.ceil);this.options.scaleX&&(c.width=d(b)+"px");this.options.scaleY&&(c.height=d(a)+"px");if(this.options.scaleFromCenter){var d=(a-this.dims[0])/2,e=(b-this.dims[1])/2;"absolute"==this.elementPositioning?(this.options.scaleY&&(c.top=this.originalTop-d+"px"),this.options.scaleX&&(c.left=this.originalLeft-e+"px")):(this.options.scaleY&&(c.top=-d+"px"),this.options.scaleX&&(c.left=-e+"px"))}MochiKit.Style.setStyle(this.element,
c)}});MochiKit.Visual.Highlight=function(a,b){var c=arguments.callee;if(!(this instanceof c))return new c(a,b);this.__init__(a,b)};MochiKit.Visual.Highlight.prototype=new MochiKit.Visual.Base;
MochiKit.Base.update(MochiKit.Visual.Highlight.prototype,{__class__:MochiKit.Visual.Highlight,__init__:function(a,b){this.element=MochiKit.DOM.getElement(a);b=MochiKit.Base.update({startcolor:"#ffff99"},b);this.start(b)},setup:function(){var a=MochiKit.Base,b=MochiKit.Style;"none"==b.getStyle(this.element,"display")?this.cancel():(this.oldStyle={backgroundImage:b.getStyle(this.element,"background-image")},b.setStyle(this.element,{backgroundImage:"none"}),this.options.endcolor||(this.options.endcolor=
MochiKit.Color.Color.fromBackground(this.element).toHexString()),a.isUndefinedOrNull(this.options.restorecolor)&&(this.options.restorecolor=b.getStyle(this.element,"background-color")),this._base=a.map(a.bind(function(a){return parseInt(this.options.startcolor.slice(2*a+1,2*a+3),16)},this),[0,1,2]),this._delta=a.map(a.bind(function(a){return parseInt(this.options.endcolor.slice(2*a+1,2*a+3),16)-this._base[a]},this),[0,1,2]))},update:function(a){var b="#";MochiKit.Base.map(MochiKit.Base.bind(function(c){b+=
MochiKit.Color.toColorPart(Math.round(this._base[c]+this._delta[c]*a))},this),[0,1,2]);MochiKit.Style.setStyle(this.element,{backgroundColor:b})},finish:function(){MochiKit.Style.setStyle(this.element,MochiKit.Base.update(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});MochiKit.Visual.ScrollTo=function(a,b){var c=arguments.callee;if(!(this instanceof c))return new c(a,b);this.__init__(a,b)};MochiKit.Visual.ScrollTo.prototype=new MochiKit.Visual.Base;
MochiKit.Base.update(MochiKit.Visual.ScrollTo.prototype,{__class__:MochiKit.Visual.ScrollTo,__init__:function(a,b){this.element=MochiKit.DOM.getElement(a);this.start(b)},setup:function(){var a=MochiKit.Position;a.prepare();var b=a.cumulativeOffset(this.element);this.options.offset&&(b.y+=this.options.offset);var c;window.innerHeight?c=window.innerHeight-window.height:document.documentElement&&document.documentElement.clientHeight?c=document.documentElement.clientHeight-document.body.scrollHeight:
document.body&&(c=document.body.clientHeight-document.body.scrollHeight);this.scrollStart=a.windowOffset.y;this.delta=(b.y>c?c:b.y)-this.scrollStart},update:function(a){var b=MochiKit.Position;b.prepare();window.scrollTo(b.windowOffset.x,this.scrollStart+a*this.delta)}});MochiKit.Visual._CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;MochiKit.Visual.Morph=function(a,b){var c=arguments.callee;if(!(this instanceof c))return new c(a,b);this.__init__(a,b)};
MochiKit.Visual.Morph.prototype=new MochiKit.Visual.Base;
MochiKit.Base.update(MochiKit.Visual.Morph.prototype,{__class__:MochiKit.Visual.Morph,__init__:function(a,b){this.element=MochiKit.DOM.getElement(a);this.start(b)},setup:function(){var a=MochiKit.Base,b=this.options.style;this.styleStart={};this.styleEnd={};this.units={};var c,d,e;for(e in b)if(c=b[e],e=a.camelize(e),MochiKit.Visual._CSS_LENGTH.test(c))d=c.match(/^([\+\-]?[0-9\.]+)(.*)$/),c=parseFloat(d[1]),d=3==d.length?d[2]:null,this.styleEnd[e]=c,this.units[e]=d,c=MochiKit.Style.getStyle(this.element,
e),d=c.match(/^([\+\-]?[0-9\.]+)(.*)$/),c=parseFloat(d[1]),this.styleStart[e]=c;else if(/[Cc]olor$/.test(e)){if(d=MochiKit.Color.Color,c=d.fromString(c))this.units[e]="color",this.styleEnd[e]=c.toHexString(),c=MochiKit.Style.getStyle(this.element,e),this.styleStart[e]=d.fromString(c).toHexString(),this.styleStart[e]=a.map(a.bind(function(a){return parseInt(this.styleStart[e].slice(2*a+1,2*a+3),16)},this),[0,1,2]),this.styleEnd[e]=a.map(a.bind(function(a){return parseInt(this.styleEnd[e].slice(2*a+
1,2*a+3),16)},this),[0,1,2])}else this.element.style[e]=c},update:function(a){var b,c;for(c in this.styleStart)if("color"==this.units[c]){var d="#",e=this.styleStart[c],f=this.styleEnd[c];MochiKit.Base.map(MochiKit.Base.bind(function(b){d+=MochiKit.Color.toColorPart(Math.round(e[b]+(f[b]-e[b])*a))},this),[0,1,2]);this.element.style[c]=d}else b=this.styleStart[c]+Math.round(1E3*(this.styleEnd[c]-this.styleStart[c])*a)/1E3+this.units[c],this.element.style[c]=b}});
MochiKit.Visual.fade=function(a,b){var c=MochiKit.Style,d=c.getStyle(a,"opacity");b=MochiKit.Base.update({from:c.getStyle(a,"opacity")||1,to:0,afterFinishInternal:function(a){0===a.options.to&&(c.hideElement(a.element),c.setStyle(a.element,{opacity:d}))}},b);return new MochiKit.Visual.Opacity(a,b)};
MochiKit.Visual.appear=function(a,b){var c=MochiKit.Style,d=MochiKit.Visual;b=MochiKit.Base.update({from:"none"==c.getStyle(a,"display")?0:c.getStyle(a,"opacity")||0,to:1,afterFinishInternal:function(a){d._forceRerendering(a.element)},beforeSetupInternal:function(a){c.setStyle(a.element,{opacity:a.options.from});c.showElement(a.element)}},b);return new d.Opacity(a,b)};
MochiKit.Visual.puff=function(a,b){var c=MochiKit.Style,d=MochiKit.Visual;a=MochiKit.DOM.getElement(a);var e=MochiKit.Style.getElementDimensions(a,!0),f={position:c.getStyle(a,"position"),top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height,opacity:c.getStyle(a,"opacity")};b=MochiKit.Base.update({beforeSetupInternal:function(a){MochiKit.Position.absolutize(a.effects[0].element)},afterFinishInternal:function(a){c.hideElement(a.effects[0].element);c.setStyle(a.effects[0].element,
f)},scaleContent:!0,scaleFromCenter:!0},b);return new d.Parallel([new d.Scale(a,200,{sync:!0,scaleFromCenter:b.scaleFromCenter,scaleMode:{originalHeight:e.h,originalWidth:e.w},scaleContent:b.scaleContent,restoreAfterFinish:!0}),new d.Opacity(a,{sync:!0,to:0})],b)};
MochiKit.Visual.blindUp=function(a,b){var c=MochiKit.Style;a=MochiKit.DOM.getElement(a);var d=c.getElementDimensions(a,!0),e=c.makeClipping(a);b=MochiKit.Base.update({scaleContent:!1,scaleX:!1,scaleMode:{originalHeight:d.h,originalWidth:d.w},restoreAfterFinish:!0,afterFinishInternal:function(a){c.hideElement(a.element);c.undoClipping(a.element,e)}},b);return new MochiKit.Visual.Scale(a,0,b)};
MochiKit.Visual.blindDown=function(a,b){var c=MochiKit.Style;a=MochiKit.DOM.getElement(a);var d=c.getElementDimensions(a,!0),e;b=MochiKit.Base.update({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:d.h,originalWidth:d.w},restoreAfterFinish:!0,afterSetupInternal:function(a){e=c.makeClipping(a.element);c.setStyle(a.element,{height:"0px"});c.showElement(a.element)},afterFinishInternal:function(a){c.undoClipping(a.element,e)}},b);return new MochiKit.Visual.Scale(a,100,b)};
MochiKit.Visual.switchOff=function(a,b){var c=MochiKit.Style;a=MochiKit.DOM.getElement(a);var d=c.getElementDimensions(a,!0),e=c.getStyle(a,"opacity"),f;b=MochiKit.Base.update({duration:0.7,restoreAfterFinish:!0,beforeSetupInternal:function(b){c.makePositioned(a);f=c.makeClipping(a)},afterFinishInternal:function(b){c.hideElement(a);c.undoClipping(a,f);c.undoPositioned(a);c.setStyle(a,{opacity:e})}},b);var g=MochiKit.Visual;return new g.Sequence([new g.appear(a,{sync:!0,duration:0.57*b.duration,from:0,
transition:g.Transitions.flicker}),new g.Scale(a,1,{sync:!0,duration:0.43*b.duration,scaleFromCenter:!0,scaleX:!1,scaleMode:{originalHeight:d.h,originalWidth:d.w},scaleContent:!1,restoreAfterFinish:!0})],b)};
MochiKit.Visual.dropOut=function(a,b){var c=MochiKit.Style;a=MochiKit.DOM.getElement(a);var d={top:c.getStyle(a,"top"),left:c.getStyle(a,"left"),opacity:c.getStyle(a,"opacity")};b=MochiKit.Base.update({duration:0.5,distance:100,beforeSetupInternal:function(a){c.makePositioned(a.effects[0].element)},afterFinishInternal:function(a){c.hideElement(a.effects[0].element);c.undoPositioned(a.effects[0].element);c.setStyle(a.effects[0].element,d)}},b);var e=MochiKit.Visual;return new e.Parallel([new e.Move(a,
{x:0,y:b.distance,sync:!0}),new e.Opacity(a,{sync:!0,to:0})],b)};
MochiKit.Visual.shake=function(a,b){var c=MochiKit.Visual,d=MochiKit.Style;a=MochiKit.DOM.getElement(a);var e={top:d.getStyle(a,"top"),left:d.getStyle(a,"left")};b=MochiKit.Base.update({duration:0.5,afterFinishInternal:function(b){d.undoPositioned(a);d.setStyle(a,e)}},b);return new c.Sequence([new c.Move(a,{sync:!0,duration:0.1*b.duration,x:20,y:0}),new c.Move(a,{sync:!0,duration:0.2*b.duration,x:-40,y:0}),new c.Move(a,{sync:!0,duration:0.2*b.duration,x:40,y:0}),new c.Move(a,{sync:!0,duration:0.2*
b.duration,x:-40,y:0}),new c.Move(a,{sync:!0,duration:0.2*b.duration,x:40,y:0}),new c.Move(a,{sync:!0,duration:0.1*b.duration,x:-20,y:0})],b)};
MochiKit.Visual.slideDown=function(a,b){var c=MochiKit.DOM,d=MochiKit.Base,e=MochiKit.Style;a=c.getElement(a);if(!a.firstChild)throw Error("MochiKit.Visual.slideDown must be used on a element with a child");c.removeEmptyTextNodes(a);var f=e.getStyle(a.firstChild,"bottom")||0,c=e.getElementDimensions(a,!0),g;b=d.update({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:c.h,originalWidth:c.w},restoreAfterFinish:!0,afterSetupInternal:function(a){e.makePositioned(a.element);e.makePositioned(a.element.firstChild);
/Opera/.test(navigator.userAgent)&&e.setStyle(a.element,{top:""});g=e.makeClipping(a.element);e.setStyle(a.element,{height:"0px"});e.showElement(a.element)},afterUpdateInternal:function(a){var b=e.getElementDimensions(a.element,!0);e.setStyle(a.element.firstChild,{bottom:a.dims[0]-b.h+"px"})},afterFinishInternal:function(a){e.undoClipping(a.element,g);/MSIE/.test(navigator.userAgent)?(e.undoPositioned(a.element),e.undoPositioned(a.element.firstChild)):(e.undoPositioned(a.element.firstChild),e.undoPositioned(a.element));
e.setStyle(a.element.firstChild,{bottom:f})}},b);return new MochiKit.Visual.Scale(a,100,b)};
MochiKit.Visual.slideUp=function(a,b){var c=MochiKit.DOM,d=MochiKit.Base,e=MochiKit.Style;a=c.getElement(a);if(!a.firstChild)throw Error("MochiKit.Visual.slideUp must be used on a element with a child");c.removeEmptyTextNodes(a);var f=e.getStyle(a.firstChild,"bottom"),c=e.getElementDimensions(a,!0),g;b=d.update({scaleContent:!1,scaleX:!1,scaleMode:{originalHeight:c.h,originalWidth:c.w},scaleFrom:100,restoreAfterFinish:!0,beforeStartInternal:function(a){e.makePositioned(a.element);e.makePositioned(a.element.firstChild);
/Opera/.test(navigator.userAgent)&&e.setStyle(a.element,{top:""});g=e.makeClipping(a.element);e.showElement(a.element)},afterUpdateInternal:function(a){var b=e.getElementDimensions(a.element,!0);e.setStyle(a.element.firstChild,{bottom:a.dims[0]-b.h+"px"})},afterFinishInternal:function(a){e.hideElement(a.element);e.undoClipping(a.element,g);e.undoPositioned(a.element.firstChild);e.undoPositioned(a.element);e.setStyle(a.element.firstChild,{bottom:f})}},b);return new MochiKit.Visual.Scale(a,0,b)};
MochiKit.Visual.squish=function(a,b){var c=MochiKit.Base,d=MochiKit.Style,e=d.getElementDimensions(a,!0),f;b=c.update({restoreAfterFinish:!0,scaleMode:{originalHeight:e.h,originalWidth:e.w},beforeSetupInternal:function(a){f=d.makeClipping(a.element)},afterFinishInternal:function(a){d.hideElement(a.element);d.undoClipping(a.element,f)}},b);return new MochiKit.Visual.Scale(a,/Opera/.test(navigator.userAgent)?1:0,b)};
MochiKit.Visual.grow=function(a,b){var c=MochiKit.Visual,d=MochiKit.Style;a=MochiKit.DOM.getElement(a);b=MochiKit.Base.update({direction:"center",moveTransition:c.Transitions.sinoidal,scaleTransition:c.Transitions.sinoidal,opacityTransition:c.Transitions.full,scaleContent:!0,scaleFromCenter:!1},b);var e={top:a.style.top,left:a.style.left,height:a.style.height,width:a.style.width,opacity:d.getStyle(a,"opacity")},f=d.getElementDimensions(a,!0),g,h,k,l;switch(b.direction){case "top-left":g=h=k=l=0;break;
case "top-right":g=f.w;h=l=0;k=-f.w;break;case "bottom-left":g=k=0;h=f.h;l=-f.h;break;case "bottom-right":g=f.w;h=f.h;k=-f.w;l=-f.h;break;case "center":g=f.w/2,h=f.h/2,k=-f.w/2,l=-f.h/2}var m=MochiKit.Base.update({beforeSetupInternal:function(a){d.setStyle(a.effects[0].element,{height:"0px"});d.showElement(a.effects[0].element)},afterFinishInternal:function(a){d.undoClipping(a.effects[0].element);d.undoPositioned(a.effects[0].element);d.setStyle(a.effects[0].element,e)}},b);return new c.Move(a,{x:g,
y:h,duration:0.01,beforeSetupInternal:function(a){d.hideElement(a.element);d.makeClipping(a.element);d.makePositioned(a.element)},afterFinishInternal:function(a){new c.Parallel([new c.Opacity(a.element,{sync:!0,to:1,from:0,transition:b.opacityTransition}),new c.Move(a.element,{x:k,y:l,sync:!0,transition:b.moveTransition}),new c.Scale(a.element,100,{scaleMode:{originalHeight:f.h,originalWidth:f.w},sync:!0,scaleFrom:/Opera/.test(navigator.userAgent)?1:0,transition:b.scaleTransition,scaleContent:b.scaleContent,
scaleFromCenter:b.scaleFromCenter,restoreAfterFinish:!0})],m)}})};
MochiKit.Visual.shrink=function(a,b){var c=MochiKit.Visual,d=MochiKit.Style;a=MochiKit.DOM.getElement(a);b=MochiKit.Base.update({direction:"center",moveTransition:c.Transitions.sinoidal,scaleTransition:c.Transitions.sinoidal,opacityTransition:c.Transitions.none,scaleContent:!0,scaleFromCenter:!1},b);var e={top:a.style.top,left:a.style.left,height:a.style.height,width:a.style.width,opacity:d.getStyle(a,"opacity")},f=d.getElementDimensions(a,!0),g,h;switch(b.direction){case "top-left":g=h=0;break;case "top-right":g=
f.w;h=0;break;case "bottom-left":g=0;h=f.h;break;case "bottom-right":g=f.w;h=f.h;break;case "center":g=f.w/2,h=f.h/2}var k,l=MochiKit.Base.update({beforeStartInternal:function(a){d.makePositioned(a.effects[0].element);k=d.makeClipping(a.effects[0].element)},afterFinishInternal:function(a){d.hideElement(a.effects[0].element);d.undoClipping(a.effects[0].element,k);d.undoPositioned(a.effects[0].element);d.setStyle(a.effects[0].element,e)}},b);return new c.Parallel([new c.Opacity(a,{sync:!0,to:0,from:1,
transition:b.opacityTransition}),new c.Scale(a,/Opera/.test(navigator.userAgent)?1:0,{scaleMode:{originalHeight:f.h,originalWidth:f.w},sync:!0,transition:b.scaleTransition,scaleContent:b.scaleContent,scaleFromCenter:b.scaleFromCenter,restoreAfterFinish:!0}),new c.Move(a,{x:g,y:h,sync:!0,transition:b.moveTransition})],l)};
MochiKit.Visual.pulsate=function(a,b){var c=MochiKit.Visual,d=MochiKit.Base,e=MochiKit.Style.getStyle(a,"opacity");b=d.update({duration:3,from:0,afterFinishInternal:function(a){MochiKit.Style.setStyle(a.element,{opacity:e})}},b);var f=b.transition||c.Transitions.sinoidal;b.transition=function(a){return f(1-c.Transitions.pulse(a,b.pulses))};return new c.Opacity(a,b)};
MochiKit.Visual.fold=function(a,b){var c=MochiKit.Visual,d=MochiKit.Style;a=MochiKit.DOM.getElement(a);var e=d.getElementDimensions(a,!0),f={top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height},g=d.makeClipping(a);b=MochiKit.Base.update({scaleContent:!1,scaleX:!1,scaleMode:{originalHeight:e.h,originalWidth:e.w},afterFinishInternal:function(b){new c.Scale(a,1,{scaleContent:!1,scaleY:!1,scaleMode:{originalHeight:e.h,originalWidth:e.w},afterFinishInternal:function(a){d.hideElement(a.element);
d.undoClipping(a.element,g);d.setStyle(a.element,f)}})}},b);return new c.Scale(a,5,b)};MochiKit.Base.nameFunctions(MochiKit.Visual);MochiKit.Base._exportSymbols(this,MochiKit.Visual);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.DragAndDrop={});MochiKit.Base.module(MochiKit,"DragAndDrop","1.5","Base Iter DOM Signal Visual Position".split(" "));
MochiKit.DragAndDrop.Droppables={drops:[],remove:function(a){this.drops=MochiKit.Base.filter(function(b){return b.element!=MochiKit.DOM.getElement(a)},this.drops)},register:function(a){this.drops.push(a)},unregister:function(a){this.drops=MochiKit.Base.filter(function(b){return b!=a},this.drops)},prepare:function(a){MochiKit.Base.map(function(b){b.isAccepted(a)&&(b.options.activeclass&&MochiKit.DOM.addElementClass(b.element,b.options.activeclass),b.options.onactive(b.element,a))},this.drops)},findDeepestChild:function(a){for(var b=
a[0],c=1;c<a.length;++c)MochiKit.DOM.isChildNode(a[c].element,b.element)&&(b=a[c]);return b},show:function(a,b){if(this.drops.length){var c=[];this.last_active&&this.last_active.deactivate();MochiKit.Iter.forEach(this.drops,function(d){d.isAffected(a,b)&&c.push(d)});if(0<c.length){var d=this.findDeepestChild(c);MochiKit.Position.within(d.element,a.page.x,a.page.y);d.options.onhover(b,d.element,MochiKit.Position.overlap(d.options.overlap,d.element));d.activate()}}},fire:function(a,b){if(this.last_active&&
(MochiKit.Position.prepare(),this.last_active.isAffected(a.mouse(),b)))this.last_active.options.ondrop(b,this.last_active.element,a)},reset:function(a){MochiKit.Base.map(function(b){b.options.activeclass&&MochiKit.DOM.removeElementClass(b.element,b.options.activeclass);b.options.ondesactive(b.element,a)},this.drops);this.last_active&&this.last_active.deactivate()}};MochiKit.DragAndDrop.Droppable=function(a,b){var c=arguments.callee;if(!(this instanceof c))return new c(a,b);this.__init__(a,b)};
MochiKit.DragAndDrop.Droppable.prototype={__class__:MochiKit.DragAndDrop.Droppable,__init__:function(a,b){var c=MochiKit.DOM,d=MochiKit.Base;this.element=c.getElement(a);this.options=d.update({greedy:!0,hoverclass:null,activeclass:null,hoverfunc:d.noop,accept:null,onactive:d.noop,ondesactive:d.noop,onhover:d.noop,ondrop:d.noop,containment:[],tree:!1},b);this.options._containers=[];d.map(MochiKit.Base.bind(function(a){this.options._containers.push(c.getElement(a))},this),this.options.containment);
MochiKit.Style.makePositioned(this.element);MochiKit.DragAndDrop.Droppables.register(this)},isContained:function(a){if(this.options._containers.length){var b;b=this.options.tree?a.treeNode:a.parentNode;return MochiKit.Iter.some(this.options._containers,function(a){return b==a})}return!0},isAccepted:function(a){return!this.options.accept||MochiKit.Iter.some(this.options.accept,function(b){return MochiKit.DOM.hasElementClass(a,b)})},isAffected:function(a,b){return this.element!=b&&this.isContained(b)&&
this.isAccepted(b)&&MochiKit.Position.within(this.element,a.page.x,a.page.y)},deactivate:function(){this.options.hoverclass&&MochiKit.DOM.removeElementClass(this.element,this.options.hoverclass);this.options.hoverfunc(this.element,!1);MochiKit.DragAndDrop.Droppables.last_active=null},activate:function(){this.options.hoverclass&&MochiKit.DOM.addElementClass(this.element,this.options.hoverclass);this.options.hoverfunc(this.element,!0);MochiKit.DragAndDrop.Droppables.last_active=this},destroy:function(){MochiKit.DragAndDrop.Droppables.unregister(this)},
repr:function(){return"["+this.__class__.NAME+", options:"+MochiKit.Base.repr(this.options)+"]"}};
MochiKit.DragAndDrop.Draggables={drags:[],register:function(a){if(0===this.drags.length){var b=MochiKit.Signal.connect;this.eventMouseUp=b(document,"onmouseup",this,this.endDrag);this.eventMouseMove=b(document,"onmousemove",this,this.updateDrag);this.eventKeypress=b(document,"onkeypress",this,this.keyPress)}this.drags.push(a)},unregister:function(a){this.drags=MochiKit.Base.filter(function(b){return b!=a},this.drags);if(0===this.drags.length){var b=MochiKit.Signal.disconnect;b(this.eventMouseUp);
b(this.eventMouseMove);b(this.eventKeypress)}},activate:function(a){window.focus();this.activeDraggable=a},deactivate:function(){this.activeDraggable=null},updateDrag:function(a){if(this.activeDraggable){var b=a.mouse();this._lastPointer&&this._lastPointer.page.x==b.page.x&&this._lastPointer.page.y==b.page.y||(this._lastPointer=b,this.activeDraggable.updateDrag(a,b))}},endDrag:function(a){this.activeDraggable&&(this._lastPointer=null,this.activeDraggable.endDrag(a),this.activeDraggable=null)},keyPress:function(a){this.activeDraggable&&
this.activeDraggable.keyPress(a)},notify:function(a,b,c){MochiKit.Signal.signal(this,a,b,c)}};MochiKit.DragAndDrop.Draggable=function(a,b){var c=arguments.callee;if(!(this instanceof c))return new c(a,b);this.__init__(a,b)};
MochiKit.DragAndDrop.Draggable.prototype={__class__:MochiKit.DragAndDrop.Draggable,__init__:function(a,b){var c=MochiKit.Visual,d=MochiKit.Base;b=d.update({handle:!1,starteffect:function(a){this._savedOpacity=MochiKit.Style.getStyle(a,"opacity")||1;new c.Opacity(a,{duration:0.2,from:this._savedOpacity,to:0.7})},reverteffect:function(a,b,d){var h=0.02*Math.sqrt(Math.abs(b^2)+Math.abs(d^2));return new c.Move(a,{x:-d,y:-b,duration:h})},endeffect:function(a){new c.Opacity(a,{duration:0.2,from:0.7,to:this._savedOpacity})},
onchange:d.noop,zindex:1E3,revert:!1,scroll:!1,scrollSensitivity:20,scrollSpeed:15,snap:!1},b);d=MochiKit.DOM;this.element=d.getElement(a);b.handle&&"string"==typeof b.handle&&(this.handle=d.getFirstElementByTagAndClassName(null,b.handle,this.element));this.handle||(this.handle=d.getElement(b.handle));this.handle||(this.handle=this.element);!b.scroll||(b.scroll.scrollTo||b.scroll.outerHTML)||(b.scroll=d.getElement(b.scroll),this._isScrollChild=MochiKit.DOM.isChildNode(this.element,b.scroll));MochiKit.Style.makePositioned(this.element);
this.delta=this.currentDelta();this.options=b;this.dragging=!1;this.eventMouseDown=MochiKit.Signal.connect(this.handle,"onmousedown",this,this.initDrag);MochiKit.DragAndDrop.Draggables.register(this)},destroy:function(){MochiKit.Signal.disconnect(this.eventMouseDown);MochiKit.DragAndDrop.Draggables.unregister(this)},currentDelta:function(){var a=MochiKit.Style.getStyle;return[parseInt(a(this.element,"left")||"0",10),parseInt(a(this.element,"top")||"0",10)]},initDrag:function(a){if(a.mouse().button.left){var b=
(a.target().tagName||"").toUpperCase();if("INPUT"!==b&&"SELECT"!==b&&"OPTION"!==b&&"BUTTON"!==b&&"TEXTAREA"!==b){this._revert&&(this._revert.cancel(),this._revert=null);var b=a.mouse(),c=MochiKit.Position.cumulativeOffset(this.element);this.offset=[b.page.x-c.x,b.page.y-c.y];MochiKit.DragAndDrop.Draggables.activate(this);a.stop()}}},startDrag:function(a){this.dragging=!0;this.options.selectclass&&MochiKit.DOM.addElementClass(this.element,this.options.selectclass);this.options.zindex&&(this.originalZ=
MochiKit.Style.getStyle(this.element,"z-index"),this.element.style.zIndex=this.options.zindex);this.options.ghosting&&(this._clone=this.element.cloneNode(!0),this.ghostPosition=MochiKit.Position.absolutize(this.element),this.element.parentNode.insertBefore(this._clone,this.element));if(this.options.scroll)if(this.options.scroll==window){var b=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=b.left;this.originalScrollTop=b.top}else this.originalScrollLeft=this.options.scroll.scrollLeft,
this.originalScrollTop=this.options.scroll.scrollTop;MochiKit.DragAndDrop.Droppables.prepare(this.element);MochiKit.DragAndDrop.Draggables.notify("start",this,a);this.options.starteffect&&this.options.starteffect(this.element)},updateDrag:function(a,b){this.dragging||this.startDrag(a);MochiKit.Position.prepare();MochiKit.DragAndDrop.Droppables.show(b,this.element);MochiKit.DragAndDrop.Draggables.notify("drag",this,a);this.draw(b);this.options.onchange(this);if(this.options.scroll){this.stopScrolling();
var c,d;this.options.scroll==window?(d=this._getWindowScroll(this.options.scroll),c=new MochiKit.Style.Coordinates(d.left,d.top),d=new MochiKit.Style.Coordinates(d.left+d.width,d.top+d.height)):(c=MochiKit.Position.page(this.options.scroll),c.x+=this.options.scroll.scrollLeft,c.y+=this.options.scroll.scrollTop,c.x+=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,c.y+=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,d=new MochiKit.Style.Coordinates(c.x+
this.options.scroll.offsetWidth,c.y+this.options.scroll.offsetHeight));var e=[0,0];b.page.x>d.x-this.options.scrollSensitivity?e[0]=b.page.x-(d.x-this.options.scrollSensitivity):b.page.x<c.x+this.options.scrollSensitivity&&(e[0]=b.page.x-(c.x+this.options.scrollSensitivity));b.page.y>d.y-this.options.scrollSensitivity?e[1]=b.page.y-(d.y-this.options.scrollSensitivity):b.page.y<c.y+this.options.scrollSensitivity&&(e[1]=b.page.y-(c.y+this.options.scrollSensitivity));this.startScrolling(e)}/AppleWebKit/.test(navigator.appVersion)&&
window.scrollBy(0,0);a.stop()},finishDrag:function(a,b){var c=MochiKit.DragAndDrop;this.dragging=!1;this.options.selectclass&&MochiKit.DOM.removeElementClass(this.element,this.options.selectclass);this.options.ghosting&&(MochiKit.Position.relativize(this.element,this.ghostPosition),MochiKit.DOM.removeElement(this._clone),this._clone=null);b&&c.Droppables.fire(a,this.element);c.Draggables.notify("end",this,a);var d=this.options.revert;d&&"function"==typeof d&&(d=d(this.element));var e=this.currentDelta();
d&&this.options.reverteffect?this._revert=this.options.reverteffect(this.element,e[1]-this.delta[1],e[0]-this.delta[0]):this.delta=e;this.options.zindex&&(this.element.style.zIndex=this.originalZ);this.options.endeffect&&this.options.endeffect(this.element);c.Draggables.deactivate();c.Droppables.reset(this.element)},keyPress:function(a){"KEY_ESCAPE"==a.key().string&&(this.finishDrag(a,!1),a.stop())},endDrag:function(a){this.dragging&&(this.stopScrolling(),this.finishDrag(a,!0),a.stop())},draw:function(a){var b=
MochiKit.Position.cumulativeOffset(this.element),c=this.currentDelta();b.x-=c[0];b.y-=c[1];this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)&&(b.x-=this.options.scroll.scrollLeft-this.originalScrollLeft,b.y-=this.options.scroll.scrollTop-this.originalScrollTop);a=[a.page.x-b.x-this.offset[0],a.page.y-b.y-this.offset[1]];if(this.options.snap)if("function"==typeof this.options.snap)a=this.options.snap(a[0],a[1]);else if(this.options.snap instanceof Array){var d=-1;a=MochiKit.Base.map(MochiKit.Base.bind(function(a){d+=
1;return Math.round(a/this.options.snap[d])*this.options.snap[d]},this),a)}else a=MochiKit.Base.map(MochiKit.Base.bind(function(a){return Math.round(a/this.options.snap)*this.options.snap},this),a);b=this.element.style;this.options.constraint&&"horizontal"!=this.options.constraint||(b.left=a[0]+"px");this.options.constraint&&"vertical"!=this.options.constraint||(b.top=a[1]+"px");"hidden"==b.visibility&&(b.visibility="")},stopScrolling:function(){this.scrollInterval&&(clearInterval(this.scrollInterval),
this.scrollInterval=null,MochiKit.DragAndDrop.Draggables._lastScrollPointer=null)},startScrolling:function(a){if(a[0]||a[1])this.scrollSpeed=[a[0]*this.options.scrollSpeed,a[1]*this.options.scrollSpeed],this.lastScrolled=new Date,this.scrollInterval=setInterval(MochiKit.Base.bind(this.scroll,this),10)},scroll:function(){var a=new Date,b=a-this.lastScrolled;this.lastScrolled=a;if(this.options.scroll==window){if(a=this._getWindowScroll(this.options.scroll),this.scrollSpeed[0]||this.scrollSpeed[1]){var c=
b/1E3;this.options.scroll.scrollTo(a.left+c*this.scrollSpeed[0],a.top+c*this.scrollSpeed[1])}}else this.options.scroll.scrollLeft+=this.scrollSpeed[0]*b/1E3,this.options.scroll.scrollTop+=this.scrollSpeed[1]*b/1E3;a=MochiKit.DragAndDrop;MochiKit.Position.prepare();a.Droppables.show(a.Draggables._lastPointer,this.element);a.Draggables.notify("drag",this);this._isScrollChild&&(a.Draggables._lastScrollPointer=a.Draggables._lastScrollPointer||a.Draggables._lastPointer,a.Draggables._lastScrollPointer.x+=
this.scrollSpeed[0]*b/1E3,a.Draggables._lastScrollPointer.y+=this.scrollSpeed[1]*b/1E3,0>a.Draggables._lastScrollPointer.x&&(a.Draggables._lastScrollPointer.x=0),0>a.Draggables._lastScrollPointer.y&&(a.Draggables._lastScrollPointer.y=0),this.draw(a.Draggables._lastScrollPointer));this.options.onchange(this)},_getWindowScroll:function(a){var b,c,d;MochiKit.DOM.withWindow(a,function(){b=MochiKit.Style.getViewportPosition(a.document)});a.innerWidth?(c=a.innerWidth,d=a.innerHeight):a.document.documentElement&&
a.document.documentElement.clientWidth?(c=a.document.documentElement.clientWidth,d=a.document.documentElement.clientHeight):(c=a.document.body.offsetWidth,d=a.document.body.offsetHeight);return{top:b.y,left:b.x,width:c,height:d}},repr:function(){return"["+this.__class__.NAME+", options:"+MochiKit.Base.repr(this.options)+"]"}};MochiKit.DragAndDrop.__new__=function(){MochiKit.Base.nameFunctions(this)};MochiKit.DragAndDrop.__new__();MochiKit.Base._exportSymbols(this,MochiKit.DragAndDrop);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Sortable={});MochiKit.Base.module(MochiKit,"Sortable","1.5",["Base","Iter","DOM","Position","DragAndDrop"]);
MochiKit.Base.update(MochiKit.Sortable,{__export__:!1,sortables:{},_findRootElement:function(a){for(;"BODY"!=a.tagName.toUpperCase();){if(a.id&&MochiKit.Sortable.sortables[a.id])return a;a=a.parentNode}},_createElementId:function(a){if(null==a.id||""==a.id){for(var b=MochiKit.DOM,c,d=1;null!=b.getElement(c="sortable"+d);)d+=1;b.setNodeAttribute(a,"id",c)}},options:function(a){if(a=MochiKit.Sortable._findRootElement(MochiKit.DOM.getElement(a)))return MochiKit.Sortable.sortables[a.id]},destroy:function(a){a=
MochiKit.Sortable.options(a);var b=MochiKit.Base,c=MochiKit.DragAndDrop;a&&(MochiKit.Signal.disconnect(a.startHandle),MochiKit.Signal.disconnect(a.endHandle),b.map(function(a){c.Droppables.remove(a)},a.droppables),b.map(function(a){a.destroy()},a.draggables),delete MochiKit.Sortable.sortables[a.element.id])},create:function(a,b){a=MochiKit.DOM.getElement(a);var c=MochiKit.Sortable;c._createElementId(a);b=MochiKit.Base.update({element:a,tag:"li",dropOnEmpty:!1,tree:!1,treeTag:"ul",overlap:"vertical",
constraint:"vertical",containment:[a],handle:!1,only:!1,hoverclass:null,ghosting:!1,scroll:!1,scrollSensitivity:20,scrollSpeed:15,format:/^[^_]*_(.*)$/,onChange:MochiKit.Base.noop,onUpdate:MochiKit.Base.noop,accept:null},b);c.destroy(a);var d={revert:!0,ghosting:b.ghosting,scroll:b.scroll,scrollSensitivity:b.scrollSensitivity,scrollSpeed:b.scrollSpeed,constraint:b.constraint,handle:b.handle};b.starteffect&&(d.starteffect=b.starteffect);b.reverteffect?d.reverteffect=b.reverteffect:b.ghosting&&(d.reverteffect=
function(a){a.style.top=0;a.style.left=0});b.endeffect&&(d.endeffect=b.endeffect);b.zindex&&(d.zindex=b.zindex);var e={overlap:b.overlap,containment:b.containment,hoverclass:b.hoverclass,onhover:c.onHover,tree:b.tree,accept:b.accept},f={onhover:c.onEmptyHover,overlap:b.overlap,containment:b.containment,hoverclass:b.hoverclass,accept:b.accept};MochiKit.DOM.removeEmptyTextNodes(a);b.draggables=[];b.droppables=[];if(b.dropOnEmpty||b.tree)new MochiKit.DragAndDrop.Droppable(a,f),b.droppables.push(a);MochiKit.Base.map(function(c){var f=
b.handle?MochiKit.DOM.getFirstElementByTagAndClassName(null,b.handle,c):c;b.draggables.push(new MochiKit.DragAndDrop.Draggable(c,MochiKit.Base.update(d,{handle:f})));new MochiKit.DragAndDrop.Droppable(c,e);b.tree&&(c.treeNode=a);b.droppables.push(c)},c.findElements(a,b)||[]);b.tree&&MochiKit.Base.map(function(c){new MochiKit.DragAndDrop.Droppable(c,f);c.treeNode=a;b.droppables.push(c)},c.findTreeElements(a,b)||[]);c.sortables[a.id]=b;b.lastValue=c.serialize(a);b.startHandle=MochiKit.Signal.connect(MochiKit.DragAndDrop.Draggables,
"start",MochiKit.Base.partial(c.onStart,a));b.endHandle=MochiKit.Signal.connect(MochiKit.DragAndDrop.Draggables,"end",MochiKit.Base.partial(c.onEnd,a))},onStart:function(a,b){var c=MochiKit.Sortable,d=c.options(a);d.lastValue=c.serialize(d.element)},onEnd:function(a,b){var c=MochiKit.Sortable;c.unmark();var d=c.options(a);if(d.lastValue!=c.serialize(d.element))d.onUpdate(d.element)},findElements:function(a,b){return MochiKit.Sortable.findChildren(a,b.only,b.tree,b.tag)},findTreeElements:function(a,
b){return MochiKit.Sortable.findChildren(a,b.only,b.tree?!0:!1,b.treeTag)},findChildren:function(a,b,c,d){if(!a.hasChildNodes())return null;d=d.toUpperCase();b&&(b=MochiKit.Base.flattenArray([b]));var e=[];MochiKit.Base.map(function(a){!a.tagName||(a.tagName.toUpperCase()!=d||b&&!MochiKit.Iter.some(b,function(b){return MochiKit.DOM.hasElementClass(a,b)}))||e.push(a);if(c){var g=MochiKit.Sortable.findChildren(a,b,c,d);g&&0<g.length&&(e=e.concat(g))}},a.childNodes);return e},onHover:function(a,b,c){if(!MochiKit.DOM.isChildNode(b,
a)){var d=MochiKit.Sortable;if(!(0.33<c&&0.66>c&&d.options(b).tree))if(0.5<c){if(d.mark(b,"before"),b.previousSibling!=a){c=a.parentNode;a.style.visibility="hidden";b.parentNode.insertBefore(a,b);if(b.parentNode!=c)d.options(c).onChange(a);d.options(b.parentNode).onChange(a)}}else{d.mark(b,"after");var e=b.nextSibling||null;if(e!=a){c=a.parentNode;a.style.visibility="hidden";b.parentNode.insertBefore(a,e);if(b.parentNode!=c)d.options(c).onChange(a);d.options(b.parentNode).onChange(a)}}}},_offsetSize:function(a,
b){return"vertical"==b||"height"==b?a.offsetHeight:a.offsetWidth},onEmptyHover:function(a,b,c){var d=a.parentNode,e=MochiKit.Sortable,f=e.options(b);if(!MochiKit.DOM.isChildNode(b,a)){var g=e.findElements(b,{tag:f.tag,only:f.only}),h=null;if(g){var k=e._offsetSize(b,f.overlap)*(1-c);for(c=0;c<g.length;c+=1)if(0<=k-e._offsetSize(g[c],f.overlap))k-=e._offsetSize(g[c],f.overlap);else{h=0<=k-e._offsetSize(g[c],f.overlap)/2?c+1<g.length?g[c+1]:null:g[c];break}}b.insertBefore(a,h);e.options(d).onChange(a);
f.onChange(a)}},unmark:function(){var a=MochiKit.Sortable._marker;a&&MochiKit.Style.hideElement(a)},mark:function(a,b){var c=MochiKit.DOM,d=MochiKit.Sortable,e=d.options(a.parentNode);if(!e||e.ghosting)d._marker||(d._marker=c.getElement("dropmarker")||document.createElement("DIV"),MochiKit.Style.hideElement(d._marker),c.addElementClass(d._marker,"dropmarker"),d._marker.style.position="absolute",document.getElementsByTagName("body").item(0).appendChild(d._marker)),c=MochiKit.Position.cumulativeOffset(a),
d._marker.style.left=c.x+"px",d._marker.style.top=c.y+"px","after"==b&&("horizontal"==e.overlap?d._marker.style.left=c.x+a.clientWidth+"px":d._marker.style.top=c.y+a.clientHeight+"px"),MochiKit.Style.showElement(d._marker)},_tree:function(a,b,c){for(var d=MochiKit.Sortable,e=d.findElements(a,b)||[],f=0;f<e.length;++f){var g=e[f].id.match(b.format);g&&(g={id:encodeURIComponent(g?g[1]:null),element:a,parent:c,children:[],position:c.children.length,container:d._findChildrenElement(e[f],b.treeTag.toUpperCase())},
g.container&&d._tree(g.container,b,g),c.children.push(g))}return c},_findChildrenElement:function(a,b){if(a&&a.hasChildNodes){b=b.toUpperCase();for(var c=0;c<a.childNodes.length;++c)if(a.childNodes[c].tagName.toUpperCase()==b)return a.childNodes[c]}return null},tree:function(a,b){a=MochiKit.DOM.getElement(a);var c=MochiKit.Sortable.options(a);b=MochiKit.Base.update({tag:c.tag,treeTag:c.treeTag,only:c.only,name:a.id,format:c.format},b||{});return MochiKit.Sortable._tree(a,b,{id:null,parent:null,children:[],
container:a,position:0})},setSequence:function(a,b,c){var d=MochiKit.Sortable,e=MochiKit.Base;a=MochiKit.DOM.getElement(a);c=e.update(d.options(a),c||{});var f={};e.map(function(a){var b=a.id.match(c.format);b&&(f[b[1]]=[a,a.parentNode]);a.parentNode.removeChild(a)},d.findElements(a,c));e.map(function(a){var b=f[a];b&&(b[1].appendChild(b[0]),delete f[a])},b)},_constructIndex:function(a){var b="";do a.id&&(b="["+a.position+"]"+b);while(null!=(a=a.parent));return b},sequence:function(a,b){a=MochiKit.DOM.getElement(a);
var c=MochiKit.Sortable;b=MochiKit.Base.update(c.options(a),b||{});return MochiKit.Base.map(function(a){return a.id.match(b.format)?a.id.match(b.format)[1]:""},MochiKit.DOM.getElement(c.findElements(a,b)||[]))},serialize:function(a,b){a=MochiKit.DOM.getElement(a);var c=MochiKit.Sortable;b=MochiKit.Base.update(c.options(a),b||{});var d=encodeURIComponent(b.name||a.id);return b.tree?MochiKit.Base.flattenArray(MochiKit.Base.map(function(a){return[d+c._constructIndex(a)+"[id]="+encodeURIComponent(a.id)].concat(a.children.map(arguments.callee))},
c.tree(a,b).children)).join("&"):MochiKit.Base.map(function(a){return d+"[]="+encodeURIComponent(a)},c.sequence(a,b)).join("&")}});MochiKit.Sortable.Sortable=MochiKit.Sortable;MochiKit.Sortable.__new__=function(){MochiKit.Base.nameFunctions(this)};MochiKit.Sortable.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Sortable);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Base_ext={});MochiKit.Base.module(MochiKit,"Base_ext","1.5",["Base"]);MochiKit.Base._arg_placeholder=function(a){this.index=a};
var _1=new MochiKit.Base._arg_placeholder(0),_2=new MochiKit.Base._arg_placeholder(1),_3=new MochiKit.Base._arg_placeholder(2),_4=new MochiKit.Base._arg_placeholder(3),_5=new MochiKit.Base._arg_placeholder(4),_6=new MochiKit.Base._arg_placeholder(5),_7=new MochiKit.Base._arg_placeholder(6),_8=new MochiKit.Base._arg_placeholder(7),_9=new MochiKit.Base._arg_placeholder(8),_10=new MochiKit.Base._arg_placeholder(9);
MochiKit.Base._rebind_preargs=function(a,b,c){c=c||{};for(var d=0;d<a.length;++d){var e=a[d];e instanceof MochiKit.Base._arg_placeholder?e.index<b.length&&(a[d]=b[e.index],c[e.index]=e.index):"function"==typeof e&&"function"==typeof e.im_func&&MochiKit.Base._rebind_preargs(e.im_preargs,b,c)}return c};
MochiKit.Base.bind2=function(a,b,c){"string"==typeof a&&(a=b[a]);var d=a.im_func,e=a.im_preargs,f=a.im_self,g=MochiKit.Base;"function"==typeof a&&"undefined"==typeof a.apply&&(a=g._wrapDumbFunction(a));"function"!=typeof d&&(d=a);"undefined"!=typeof b&&(f=b);var e="undefined"==typeof e?[]:e.slice(),h=Array.prototype.slice.call(arguments,b instanceof g._arg_placeholder?1:2),k=MochiKit.Base._rebind_preargs(e,h),l;for(l in k)h.splice(k[l],1);g.extend(e,h);h=function(){var a=arguments.callee,b=a.im_self;
b||(b=this);var c=[];if(0<a.im_preargs.length){for(var d=0,e=0;e<a.im_preargs.length;++e){var f=a.im_preargs[e];f instanceof g._arg_placeholder?(d=Math.max(d,f.index+1),f=arguments[f.index]):"function"==typeof f&&"function"==typeof f.im_func&&(f=f.apply(b,arguments));c.push(f)}for(;d<arguments.length;++d)c.push(arguments[d])}else c=arguments;b instanceof g._arg_placeholder&&(b=arguments[b.index]);return a.im_func.apply(b,c)};h.im_self=f;h.im_func=d;h.im_preargs=e;"string"==typeof d.NAME&&(h.NAME=
"bind2("+d.NAME+",...)");return h};MochiKit.Base.partial2=function(a,b){var c=MochiKit.Base;return c.bind2.apply(this,c.extend([a,void 0],arguments,1))};MochiKit.Base.method2=function(a,b,c){var d=MochiKit.Base;return d.bind2.apply(this,d.extend([b,a],arguments,2))};MochiKit.Base.bindLate2=function(a,b,c){var d=MochiKit.Base,e=arguments;"string"===typeof a&&(e=d.extend([d.forwardCall(a)],arguments,1));return d.bind2.apply(this,e)};
MochiKit.Base.isBoundFunction=function(a){return"function"==typeof a&&"function"==typeof a.im_func};MochiKit.Base.protect=function(a){return function(){return a.apply(this,arguments)}};MochiKit.Base.apply=function(a,b){var c=MochiKit.Base.extend([],arguments,1);return a.apply(this,c)};
MochiKit.Base.partition=function(a,b,c,d,e){b=b||MochiKit.Base.operator.cle;c=c||0;d=d||a.length-1;e=e||c+Math.floor((d-c)/2);var f=function(b,c){var d=a[b];a[b]=a[c];a[c]=d},g=a[e];f(e,d);for(e=c;c<=d;++c)b(a[c],g)&&(f(c,e),++e);f(e,d);return e};MochiKit.Base.negateComparator=function(a){return function(){return-1*a.apply(this,arguments)}};MochiKit.Base_ext.__new__=function(){};MochiKit.Base_ext.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Base);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Bisect={});MochiKit.Base.module(MochiKit,"Bisect","1.5",["Base"]);MochiKit.Bisect.bisectRight=function(a,b,c,d){c=c||0;for(d=d||a.length;c<d;){var e=Math.floor((c+d)/2);0>MochiKit.Base.compare(b,a[e])?d=e:c=e+1}return c};MochiKit.Bisect.insortRight=function(a,b,c,d){c=MochiKit.Bisect.bisectRight(a,b,c,d);a.splice(c,0,b);return a};
MochiKit.Bisect.bisectLeft=function(a,b,c,d){c=c||0;for(d=d||a.length;c<d;){var e=Math.floor((c+d)/2);0>MochiKit.Base.compare(a[e],b)?c=e+1:d=e}return c};MochiKit.Bisect.insortLeft=function(a,b,c,d){c=MochiKit.Bisect.bisectLeft(a,b,c,d);a.splice(c,0,b);return a};MochiKit.Bisect.bisect=MochiKit.Bisect.bisectRight;MochiKit.Bisect.insort=MochiKit.Bisect.insortRight;MochiKit.Bisect.__new__=function(){};MochiKit.Bisect.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Bisect);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.HeapQ={});MochiKit.Base.module(MochiKit,"HeapQ","1.5",["Base","Iter"]);MochiKit.HeapQ.heapify=function(a,b){b=b||MochiKit.Base.operator.clt;for(var c=Math.floor(a.length/2)-1;0<=c;--c)MochiKit.HeapQ._siftup(a,c,b);return a};MochiKit.HeapQ._siftdown=function(a,b,c,d){d=d||MochiKit.Base.operator.clt;for(var e=a[c];c>b;){var f=c-1>>1,g=a[f];if(d(e,g))a[c]=g,c=f;else break}a[c]=e};
MochiKit.HeapQ._siftup=function(a,b,c){c=c||MochiKit.Base.operator.clt;for(var d=a.length,e=b,f=a[b],g=2*b+1;g<d;){var h=g+1;h<d&&!c(a[g],a[h])&&(g=h);a[b]=a[g];b=g;g=2*b+1}a[b]=f;MochiKit.HeapQ._siftdown(a,e,b,c)};MochiKit.HeapQ.heapPush=function(a,b,c){c=c||MochiKit.Base.operator.clt;a.push(b);MochiKit.HeapQ._siftdown(a,0,a.length-1,c)};MochiKit.HeapQ.heapPop=function(a,b){b=b||MochiKit.Base.operator.clt;var c=a.pop(),d;0<a.length?(d=a[0],a[0]=c,MochiKit.HeapQ._siftup(a,0,b)):d=c;return d};
MochiKit.HeapQ.heapReplace=function(a,b,c){c=c||MochiKit.Base.operator.clt;var d=a[0];a[0]=b;MochiKit.HeapQ._siftup(a,0,c);return d};MochiKit.HeapQ.heapPushPop=function(a,b,c){c=c||MochiKit.Base.operator.clt;if(0<a.length&&c(a[0],b)){var d=a[0];a[0]=b;b=d;MochiKit.HeapQ._siftup(a,0,c)}return b};
MochiKit.HeapQ.imergeSorted=function(a,b){var c=MochiKit,d=c.Iter;b=b||c.Base.operator.clt;var e=function(a,c){return b(a[0],c[0])},f=[];d.forEach(d.izip(d.count(),d.imap(d.iter,a)),function(a){var b=a[0];a=a[1];try{var c=a.next;f.push([c(),b,c])}catch(e){if(e!=d.StopIteration)throw e;}});c.HeapQ.heapify(f,e);return{repr:function(){return"imergeSorted(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){for(;;){if(0==f.length)throw d.StopIteration;var a=f[0],b=a[0],k=a[2];try{a[0]=k(),
c.HeapQ.heapReplace(f,a,e)}catch(l){if(l!=d.StopIteration)throw l;c.HeapQ.heapPop(f,e)}return b}}}};MochiKit.HeapQ.heapIter=function(a,b){b=b||MochiKit.Base.operator.clt;return{next:function(){if(0==a.length)throw MochiKit.Iter.StopIteration;return MochiKit.HeapQ.heapPop(a,b)}}};
MochiKit.HeapQ.nLargest=function(a,b,c){var d=MochiKit,e=d.Iter;c=c||d.Base.operator.clt;b=e.iter(b);var f=e.list(e.islice(b,a));if(0==f.length)return f;d.HeapQ.heapify(f,c);e.forEach(b,function(a){d.HeapQ.heapPushPop(f,a,c)});f.sort(function(a,b){return-1*d.Base.compare(a,b)});return f};MochiKit.HeapQ.nSmallest=function(a,b,c){var d=MochiKit,e=d.Iter;c=c||d.Base.operator.clt;b=e.list(b);d.HeapQ.heapify(b,c);return d.Base.map(d.Base.partial(d.HeapQ.heapPop,b,c),e.range(Math.min(a,b.length)))};
MochiKit.HeapQ.isHeap=function(a,b){b=b||MochiKit.Base.operator.cle;for(var c=1;c<a.length;++c)if(!b(a[c-1>>1],a[c]))return!1;return!0};MochiKit.HeapQ.heapSort=function(a,b){var c=MochiKit,d=c.Iter.list(a);c.HeapQ.heapify(d,b);return c.Base.map(c.Base.partial(c.HeapQ.heapPop,d,b),c.Iter.range(d.length))};MochiKit.HeapQ.__new__=function(){};MochiKit.HeapQ.__new__();MochiKit.Base._exportSymbols(this,MochiKit.HeapQ);"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Iter_ext={});MochiKit.Base.module(MochiKit,"Iter_ext","1.5",["Base","Iter"]);MochiKit.Iter.treePreOrder=function(a,b){var c=[a];return{repr:function(){return"treePreOrder(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(0==c.length)throw MochiKit.Iter.StopIteration;var a=c.pop();MochiKit.Iter.iextend(c,b(a));return a}}};
MochiKit.Iter.treeLevelOrder=function(a,b){var c=[a];return{repr:function(){return"treeLevelOrder(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(0==c.length)throw MochiKit.Iter.StopIteration;var a=c.shift();MochiKit.Iter.iextend(c,b(a));return a}}};
MochiKit.Iter.treePostOrder=function(a,b){var c=[[a,!1]];return{repr:function(){return"treePostOrder(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){for(;;){if(0==c.length)throw MochiKit.Iter.StopIteration;var a=c.pop();if(a[1])return a[0];a[1]=!0;c.push(a);MochiKit.Iter.iextend(c,MochiKit.Iter.imap(function(a){return[a,!1]},b(a[0])))}}}};
MochiKit.Iter.pairView=function(a,b){b=b||!1;var c=MochiKit.Iter.iter(a);try{var d=c.next()}catch(e){if(e!=MochiKit.Iter.StopIteration)throw e;return MochiKit.Iter.EmptyIter}b&&(c=MochiKit.Iter.chain(c,[d]));return{repr:function(){return"pairView(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){var a=c.next(),b=[d,a];d=a;return b}}};
MochiKit.Iter.windowView=function(a,b,c){b=b||2;c=c||1;var d=MochiKit.Iter.iter(a),e=[];return{repr:function(){return"windowView(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(e.length<b)for(;e.length<b;)e.push(d.next());else for(var a=0;a<c;++a)e.shift(),e.push(d.next());return e.slice()}}};MochiKit.Iter.filterMap=function(a,b,c){c=c||function(a){return"undefined"!==typeof a&&null!==a};return MochiKit.Iter.ifilter(c,MochiKit.Iter.imap(a,b))};
MochiKit.Iter.iflattenArray=function(a){var b=[a];return{repr:function(){return"iflattenArray(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){for(;;){if(0==b.length)throw MochiKit.Iter.StopIteration;var a=b.shift();if(a instanceof Array)Array.prototype.splice.apply(b,[0,0].concat(a));else return a}}}};
MochiKit.Iter.chainFromIter=function(a,b){b=b||MochiKit.Iter.iter;var c=MochiKit.Iter.iter(a),d=null;return{repr:function(){return"chainFromIter(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){for(null==d&&(d=MochiKit.Iter.iter(b(c.next())));;)try{return d.next()}catch(a){if(a!=MochiKit.Iter.StopIteration)throw a;d=MochiKit.Iter.iter(b(c.next()))}}}};
MochiKit.Iter.uniqueView=function(a,b){b=b||MochiKit.Base.operator.ceq;var c=MochiKit.Iter.iter(a),d=!0,e;return{repr:function(){return"uniqueView(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(d)return d=!1,e=c.next();for(var a=c.next();b(e,a);)a=c.next();return e=a}}};
MochiKit.Iter.iproduct=function(a,b){var c=MochiKit.Iter.iter(a),d=null,e,f;return{repr:function(){return"iproduct(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){for(;;){null==d&&(e=c.next(),d=MochiKit.Iter.iter(b));try{return f=d.next(),[e,f]}catch(a){if(a!=MochiKit.Iter.StopIteration)throw a;d=null}}}}};MochiKit.Iter.enumerate=function(a,b){return MochiKit.Iter.izip(MochiKit.Iter.count(b),a)};MochiKit.Iter.breakIt=function(){throw MochiKit.Iter.StopIteration;};
MochiKit.Iter.EmptyIter={repr:function(){return"EmptyIter"},toString:MochiKit.Base.forwardCall("repr"),next:MochiKit.Iter.breakIt};MochiKit.Iter.generateN=function(a,b){return MochiKit.Iter.imap(function(){return a()},MochiKit.Iter.range(b))};
MochiKit.Iter.izipLongest=function(a,b){b=b||null;a=MochiKit.Base.map(MochiKit.Iter.iter,a);var c=a.length;return{repr:function(){return"izipLongest(...)"},toString:MochiKit.Base.forwardCall("repr"),next:function(){for(var d=Array(a.length),e=0;e<a.length;++e)try{d[e]=a[e].next()}catch(f){if(f!=MochiKit.Iter.StopIteration)throw f;a[e]=MochiKit.Iter.repeat(b);d[e]=b;--c}if(0==c)throw MochiKit.Iter.StopIteration;return d}}};MochiKit.Iter.any=function(){return MochiKit.Iter.some.apply(this,arguments)};
MochiKit.Iter.all=function(){return MochiKit.Iter.every.apply(this,arguments)};MochiKit.Iter.starmap=function(){return MochiKit.Iter.applymap.apply(this,arguments)};MochiKit.Iter.advance=function(a,b){for(;0<b--;)a.next();return a};MochiKit.Iter.isSorted=function(a,b){return MochiKit.Iter.every(MochiKit.Iter.windowView(a),b||MochiKit.Base.operator.cle)};MochiKit.Iter.interleave=function(a,b){return MochiKit.Iter.chainFromIter(MochiKit.Iter.izip.apply(this,arguments))};
MochiKit.Iter.remapView=function(a,b){return MochiKit.Iter.imap(MochiKit.Base.partial(MochiKit.Base.operator.getitem,b),a)};MochiKit.Iter.compressIter=function(a,b){return MochiKit.Iter.imap(function(a){return a[0]},MochiKit.Iter.ifilter(function(a){return a[1]?!0:!1},MochiKit.Iter.izip(a,b)))};
MochiKit.Iter.combinations=function(a,b){var c=MochiKit,d=MochiKit.Iter,e=d.list(a),f=e.length;if(b>f)return MochiKit.Iter.EmptyIter;var g=d.list(d.range(b)),h=!0;return{repr:function(){return"combinations(...)"},toString:c.Base.forwardCall("repr"),next:function(){if(h)return h=!1,d.list(d.remapView(g,e));for(;;){for(var a=!0,c=b-1;0<=c;--c)if(g[c]!=c+f-b){a=!1;break}if(a)throw MochiKit.Iter.StopIteration;g[c]+=1;for(a=c+1;a<b;++a)g[a]=g[a-1]+1;return d.list(d.remapView(g,e))}}}};
MochiKit.Iter.combinationsWithReplacement=function(a,b){var c=MochiKit,d=MochiKit.Iter,e=d.list(a),f=e.length;if(0==f||0==b)return d.EmptyIter;var g=d.list(d.repeat(0,b)),h=!0;return{repr:function(){return"combinationsWithReplacement(...)"},toString:c.Base.forwardCall("repr"),next:function(){if(h)return h=!1,d.list(d.remapView(g,e));for(;;){for(var a=!0,c=b-1;0<=c;--c)if(g[c]!=f-1){a=!1;break}if(a)throw d.StopIteration;g=g.slice(0,c).concat(d.list(d.repeat(g[c]+1,b-c)));return d.list(d.remapView(g,
e))}}}};MochiKit.Iter.repeatSeq=function(a,b){if(0==b)return MochiKit.Iter.EmptyIter;var c=MochiKit.Iter.iter(a);return{next:function(){try{return c.next()}catch(d){if(d!=MochiKit.Iter.StopIteration||0>=--b)throw d;c=MochiKit.Iter.iter(a);return c.next()}}}};
MochiKit.Iter.permutations=function(a,b){var c=MochiKit,d=MochiKit.Iter,e=d.list(a),f=e.length;b=b||f;if(b>f)return d.EmptyIter;var g=d.list(d.range(f)),h=d.list(d.range(f,f-b,-1)),k=!0;return{repr:function(){return"permutations(...)"},toString:c.Base.forwardCall("repr"),next:function(){if(k)return k=!1,d.list(d.remapView(d.islice(g,0,b),e));if(0==f)throw d.StopIteration;for(var a=!0,c=b-1;0<=c;--c)if(h[c]-=1,0==h[c])g=g.slice(0,c).concat(g.slice(c+1),g[c]),h[c]=f-c;else{var a=g.length-h[c],p=g[c];
g[c]=g[a];g[a]=p;a=!1;break}if(a)throw d.StopIteration;return d.list(d.remapView(d.islice(g,0,b),e))}}};MochiKit.Iter._Range=function(a,b,c){this.start=a;this.stop=b;this.step=c};MochiKit.Iter._Range.prototype.__iterator__=function(){return new MochiKit.Iter.range(this.start,this.stop,this.step)};
MochiKit.Iter.xrange=function(){var a=0,b=0,c=1;if(1==arguments.length)b=arguments[0];else if(2==arguments.length)a=arguments[0],b=arguments[1];else if(3==arguments.length)a=arguments[0],b=arguments[1],c=arguments[2];else throw new TypeError("xrange() takes 1, 2, or 3 arguments!");if(0===c)throw new TypeError("xrange() step must not be 0");return new MochiKit.Iter._Range(a,b,c)};MochiKit.Iter.isJavaLikeIterator=function(a){return a&&"function"==typeof a.hasNext&&"function"==typeof a.next};
MochiKit.Iter.javaLikeIterator=function(a){return{repr:function(){return"javaLikeIterator"},toString:MochiKit.Base.forwardCall("repr"),next:function(){if(!a.hasNext())throw MochiKit.Iter.StopIteration;return a.next()}}};MochiKit.Iter.registerJavaLikeIteratorSupport=function(){MochiKit.Iter.registerIteratorFactory("javaLikeIterator",MochiKit.Iter.isJavaLikeIterator,MochiKit.Iter.javaLikeIterator)};
MochiKit.Iter.countValue=function(a,b,c){c=c||MochiKit.Base.operator.ceq;var d=0;MochiKit.Iter.forEach(a,function(a){c(a,b)&&++d});return d};MochiKit.Iter.limit=function(a,b){return MochiKit.Iter.takewhile(function(){return 0<b--},a)};MochiKit.Iter.accumulate=function(a,b){var c=MochiKit.Iter.iter(a);b=b||MochiKit.Base.operator.add;var d,e=!0;return{next:function(){return e?(e=!1,d=c.next()):d=b(d,c.next())}}};
MochiKit.Iter.pluck=function(a,b){return MochiKit.Iter.imap(MochiKit.Base.itemgetter(b),a)};MochiKit.Iter.chunked=function(a,b){return MochiKit.Iter.windowView(a,b,b)};MochiKit.Iter.zipWith=function(a,b,c){return MochiKit.Iter.imap(function(b){return a.apply(this,b)},MochiKit.Iter.izip.apply(null,MochiKit.Base.extend(null,arguments,1)))};MochiKit.Iter.forEachIdx=function(a,b){var c=MochiKit.Iter;c.exhaust(c.zipWith(b,c.count(),a))};MochiKit.Iter_ext.__new__=function(){};MochiKit.Iter_ext.__new__();
MochiKit.Base._exportSymbols(this,MochiKit.Iter);MochiKit.Base.module(MochiKit,"_MersenneTwister19937","1.5",["Base"]);
MochiKit._MersenneTwister19937=function(){function a(a){return 0>a?(a^d)+d:a}function b(b,c){return a(b+c&4294967295)}function c(c,d){for(var e=0,f=0;32>f;++f)c>>>f&1&&(e=b(e,a(d<<f)));return e}var d=2147483648,e=Array(624),f=625;this.init_genrand=function(d){e[0]=a(d&4294967295);for(f=1;624>f;f++)e[f]=b(c(1812433253,a(e[f-1]^e[f-1]>>>30)),f),e[f]=a(e[f]&4294967295)};this.init_by_array=function(d,f){var k,l,m;this.init_genrand(19650218);k=1;l=0;for(m=624>f?624:f;m;m--)e[k]=b(b(a(e[k]^c(a(e[k-1]^e[k-
1]>>>30),1664525)),d[l]),l),e[k]=a(e[k]&4294967295),k++,l++,624<=k&&(e[0]=e[623],k=1),l>=f&&(l=0);for(m=623;m;m--){l=e;var p=k,q;q=a(e[k]^c(a(e[k-1]^e[k-1]>>>30),1566083941));var n=k;q=q<n?a(4294967296-(n-q)&4294967295):q-n;l[p]=q;e[k]=a(e[k]&4294967295);k++;624<=k&&(e[0]=e[623],k=1)}e[0]=2147483648};this.genrand_int32=function(){var b,c=[0,2567483615];if(624<=f){var k;625==f&&this.init_genrand(5489);for(k=0;227>k;k++)b=a(e[k]&d|e[k+1]&2147483647),e[k]=a(e[k+397]^b>>>1^c[b&1]);for(;623>k;k++)b=a(e[k]&
d|e[k+1]&2147483647),e[k]=a(e[k+-227]^b>>>1^c[b&1]);b=a(e[623]&d|e[0]&2147483647);e[623]=a(e[396]^b>>>1^c[b&1]);f=0}b=e[f++];b=a(b^b>>>11);b=a(b^b<<7&2636928640);b=a(b^b<<15&4022730752);return b=a(b^b>>>18)};this.genrand_int31=function(){return this.genrand_int32()>>>1};this.genrand_real1=function(){return this.genrand_int32()*(1/4294967295)};this.genrand_real2=function(){return this.genrand_int32()*(1/4294967296)};this.genrand_real3=function(){return(this.genrand_int32()+0.5)*(1/4294967296)};this.genrand_res53=
function(){var a=this.genrand_int32()>>>5,b=this.genrand_int32()>>>6;return 1.1102230246251565E-16*(67108864*a+b)};this._getState=function(){return{mt:e.slice(),mti:f}};this._setState=function(a){e=a.mt;f=a.mti}};"undefined"!=typeof goog&&"function"==typeof goog.provide&&(MochiKit.Random={});MochiKit.Base.module(MochiKit,"Random","1.5",["Base","_MersenneTwister19937"]);MochiKit.Random.seed=function(a){a="number"==typeof a?a:(new Date).getTime();MochiKit.Random._generator.seed(a)};MochiKit.Random.getState=function(){return MochiKit.Random._generator.getState()};MochiKit.Random.setState=function(a){MochiKit.Random._generator.setState(a)};MochiKit.Random.random=function(){return MochiKit.Random._generator.random()};
MochiKit.Random.randRange=function(a,b,c){var d=MochiKit.Random;1==arguments.length&&(b=a,a=0);c=c||1;var e=b-a;if(1==c&&0<e)return Math.floor(a+Math.floor(d.random()*e));if(0<c)var f=Math.floor((e+c-1)/c);else 0>c&&(f=Math.floor((e+c+1)/c));return a+c*Math.floor(d.random()*f)};MochiKit.Random.uniform=function(a,b){return a+(b-a)*MochiKit.Random.random()};MochiKit.Random.shuffle=function(a){for(var b=a.length-1;0<b;--b){var c=Math.floor(MochiKit.Random.random()*(b+1)),d=a[b];a[b]=a[c];a[c]=d}return a};
MochiKit.Random.deal=function(a,b){b=b||MochiKit.Base.operator.identity;for(var c=Array(a),d=0;d<a;++d){var e=Math.floor(MochiKit.Random.random()*(d+1));c[d]=c[e];c[e]=b(d)}return c};MochiKit.Random.choice=function(a){return a[Math.floor(MochiKit.Random.random()*a.length)]};MochiKit.Random.shuffled=function(a){var b=a.length,c=Array(b);c[0]=a[0];for(var d=1;d<b-1;++d){var e=Math.floor(MochiKit.Random.random()*(d+1));c[d]=c[e];c[e]=a[d]}return c};
MochiKit.Random.sample=function(a,b){for(var c=a.length,d=Array(b),e={},f=0;f<b;++f){for(var g=MochiKit.Random.randRange(c);g in e;)g=MochiKit.Random.randRange(c);e[g]=!0;d[f]=a[g]}return d};MochiKit.Random._IRndGenerator=function(){};MochiKit.Random._IRndGenerator.prototype.seed=function(a){};MochiKit.Random._IRndGenerator.prototype.getState=function(){};MochiKit.Random._IRndGenerator.prototype.setState=function(a){};MochiKit.Random._IRndGenerator.prototype.random=function(){};
MochiKit.Random.MersenneTwister=function(a){this._mt=new MochiKit._MersenneTwister19937;this.seed(a)};MochiKit.Random.MersenneTwister.prototype.seed=function(a){a="number"==typeof a?a:(new Date).getTime();this._mt.init_genrand(a)};MochiKit.Random.MersenneTwister.prototype.getState=function(){return this._mt._getState()};MochiKit.Random.MersenneTwister.prototype.setState=function(a){this._mt._setState(a)};MochiKit.Random.MersenneTwister.prototype.random=function(){return this._mt.genrand_real2()};
MochiKit.Random.SystemRandom=function(){};MochiKit.Random.SystemRandom.prototype.seed=function(a){};MochiKit.Random.SystemRandom.prototype.getState=function(){};MochiKit.Random.SystemRandom.prototype.setState=function(a){};MochiKit.Random.SystemRandom.prototype.random=function(){return Math.random()};MochiKit.Random._generator=null;MochiKit.Random._setGenerator=function(a){MochiKit.Random._generator=a};MochiKit.Random.__new__=function(){MochiKit.Random._setGenerator(new MochiKit.Random.MersenneTwister)};
MochiKit.Random.__new__();MochiKit.Base._exportSymbols(this,MochiKit.Random);
